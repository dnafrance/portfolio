'use strict';(function(){angular.module("udacity.core",["services","controllers","directives","oldFilters","oldMeta"]);angular.module("services","services.gateways services.utility services.reviews services.blogFeed services.forum services.user services.auth services.content services.dummyData services.milestones services.search services.payment".split(" "));angular.module("controllers","controllers.courseCatalog controllers.lesson controllers.reviews controllers.editor controllers.myCourses controllers.search controllers.utility controllers.courseOverview".split(" "));
angular.module("directives","directives.user directives.utility directives.reviews directives.forum directives.myCourses directives.search directives.payment".split(" "));angular.module("oldFilters",[]);angular.module("oldMeta",["meta.configuration"]);angular.module("services.gateways",["services.customers","services.groups","services.summaries","services.permissions"]);angular.module("services.lesson",[]);angular.module("directives.lesson",[]);angular.module("controllers.lesson",[]);angular.module("controllers.settings",
[]);angular.module("directives.location",[]);angular.module("controllers.courseCatalog",[]);angular.module("controllers.courseOverview",[]);angular.module("controllers.myCourses",[]);angular.module("directives.myCourses",[]);angular.module("controllers.search",[]);angular.module("directives.search",[]);angular.module("services.search",[]);angular.module("services.utility",[]);angular.module("directives.utility",[]);angular.module("controllers.utility",[]);angular.module("directives.reviews",[]);angular.module("services.reviews",
[]);angular.module("controllers.reviews",[]);angular.module("services.blogFeed",[]);angular.module("directives.forum",[]);angular.module("services.forum",[]);angular.module("directives.payment",[]);angular.module("services.payment",[]);angular.module("services.editor",[]);angular.module("directives.editor",[]);angular.module("controllers.editor",[]);angular.module("meta.configuration",[]);angular.module("services.content",[]);angular.module("services.milestones",[]);angular.module("services.user",
[]);angular.module("directives.user",[]);angular.module("services.auth",[]);angular.module("services.customers",[]);angular.module("services.groups",[]);angular.module("services.summaries",[]);angular.module("services.permissions",[]);angular.module("services.milestones",[]);angular.module("services.dummyData",[]);angular.module("youtube",[]);angular.module("oldUdacity",["udacity.core"]);angular.module("udacity.viewer",["udacity.core","youtube","services.lesson","directives.lesson","controllers.lesson"]);
angular.module("udacity.overview",["udacity.core","youtube"]);angular.module("udacity.courseCatalog",["udacity.core"]);angular.module("udacity.editor",["udacity.core","services.editor","directives.editor","controllers.editor","services.lesson"]);angular.module("udacity.settings",["udacity.core","controllers.settings","directives.location"]);angular.module("udacity.payment",["udacity.core"]);angular.module("udacity.core").config(["$locationProvider",function(a){a.html5Mode(!1);a.hashPrefix("!")}])})();angular.module("core","foundation gateways user utility filters widgets ngRoute ngSanitize ngAnimate payment embedded ngTouch".split(" "));angular.module("udacity",["core","staticPages"]);angular.module("foundation",["user"]);angular.module("tasks",[]);angular.module("gateways",["utility","embedded"]);angular.module("widgets",["user","filters"]);angular.module("staticPages",["core"]);angular.module("user",["utility","gateways","embedded","foundation"]);angular.module("permissions",["ui.autocomplete"]);
angular.module("payment",[]);angular.module("embedded",[]);angular.module("utility",["gateways","tasks"]);angular.module("filters",[]);angular.module("viewer",["core"]);angular.module("account",["core"]);angular.module("overview",["core"]);angular.module("dashboard",["core"]);angular.module("courseCatalog",["core"]);angular.module("groupDataExtraction",["core"]);angular.module("affiliatePortal",["core"]);
angular.module("core").config(["$locationProvider","$compileProvider",function(a,d){a.html5Mode(!1);a.hashPrefix("!");d.aHrefSanitizationWhitelist(/^\s*(https?|mailto|blob):/)}]).run(["dateTime","secondsSinceEpoch",function(a,d){a.initialize(1E3*d)}]).run(["optimizely",function(a){a.activate()}]);angular.module("page.account",["ngRoute","core","account"]);
angular.module("page.account").config(["$locationProvider","$routeProvider","cacheVersion","siteExperience",function(a,d,b,c){a=function(a){return c.managedAccount?{redirectTo:"/classroom-settings"}:a};d.when("/password",a({templateUrl:"/templates/angular/account/password.html?"+b,controller:"passwordTab"})).when("/development_environment",a({templateUrl:"/templates/angular/account/development_environment.html?"+b,controller:"developmentEnvironmentInfoTab"})).when("/my-courses",a({templateUrl:"/templates/angular/account/my_courses.html?"+
b,controller:"myCoursesTab"})).when("/my-certificates",a({templateUrl:"/templates/angular/account/my_certificates.html?"+b,controller:"myCertificatesTab"})).when("/billing-and-subscriptions",a({templateUrl:"/templates/angular/account/billing_and_subscriptions.html?"+b,controller:"billingAndSubscriptionsTab"})).when("/linked-accounts",{templateUrl:"/templates/angular/account/linked_accounts.html?"+b,controller:"linkedAccountsTab"}).when("/classroom-settings",{templateUrl:"/templates/angular/account/viewer_settings.html?"+
b,controller:"viewerSettings"}).when("/memberships",a({templateUrl:"/templates/angular/account/membership.html?"+b,controller:"membershipPage"})).otherwise(a({templateUrl:"/templates/angular/account/contact_info.html?"+b,controller:"contactInfoTab"}))}]);angular.module("account").controller("accountPage",["$scope","$location",function(a,d){a.isActive=function(a){return d.path()?d.path()===a:"/contact-info"===a}}]);angular.module("account").controller("billingAndSubscriptionsTab",["$scope","currentUser","modal","stripeCreditCard","customers",function(a,d,b,c,e){a.loading=!0;a.editingCreditCard=!1;a.enabledCreditCardButton=!0;a.creditCardErrorMessage="";a.removePaymentCard=function(c){a.loading=!0;return null===a.customer.subscriptions||0===a.customer.subscriptions.length?b.activate("removeCard").then(function(){return e.removeCreditCard("me",c).then(function(){a.customerCard=null;a.serverSuccess=!0},function(){a.serverError=
!0})})["finally"](a.loading=!1):b.activate("cannotRemoveCard").then(function(){a.editingCreditCard=!0})["finally"](a.loading=!1)};d=function(){a.loading=!0;return e.get("me").then(function(b){a.loading=!1;b&&(_.each(b.subscriptions,function(a){var b=a.plan.amount;if(a.discount){var c=a.discount.coupon;c.percent_off&&(b-=b*c.percent_off/100);c.amount_off&&(b-=c.amount_off)}a.nextChargeAmount=b}),a.customer=b,a._addSimplifiedSubscriptionMetadata(a.customer.subscriptions),a.customerCard=c.getDefaultCard(b),
a.creditCard={})})};a.$on("refreshPageData",d);a._addSimplifiedSubscriptionMetadata=function(a){return _.each(a,function(a){a.setForCancellation=a.cancel_at_period_end;a.isLive="trialing"!==a.status||a.plan.metadata.trial_period_days&&0<a.plan.metadata.trial_period_days})};a.updateCreditCard=function(){var b=c.checkValidity(a.creditCard);a.creditCardErrors=b.errorText;b.valid&&(a.enabledCreditCardButton=!1,c.createPaymentToken("Update Credit Card",a.creditCard).then(function(a){return a.id}).then(function(a){return e.put("me",
{stripe_token:a})}).then(function(b){a.creditCardErrorMessage="";a.customer=b;a.customerCard=c.getDefaultCard(b);a.editingCreditCard=!1;a.enabledCreditCardButton=!0},function(b){a.creditCardErrorMessage=c.prettifyErrorResponse(b);a.enabledCreditCardButton=!0}))};d()}]);angular.module("account").factory("cancellationFlow",["modal","$q","api","$location","customers","recordActivity","dateTime","currentUser","$rootScope","$window",function(a,d,b,c,e,f,g,h,i,k){var l=h.fetchFullUser();return{cancelSubscription:function(b){var c=b.id,e=1E3*(b.trial_end||b.start),d=1E3*b.current_period_end,f=b.plan.id,q="trialing"!==b.status,t=q?g.calculateDaysBetweenDates(new Date(e),g.getCurrent()):null;return l.then(function(){var e;e=q?b.plan.metadata&&0<b.plan.metadata.trial_period_days?
"pastTrialPeriod":14>=t?"withinRefundPeriod":"pastRefundPeriod":b.plan.metadata&&0<b.plan.metadata.trial_period_days?"freeTrial":"preenrolled";return a.activate("cancelStart",{subscriptionState:e,subscriptionPeriodEndDate:new Date(d)}).then(function(){return a.activate("passwordCheckConfirmation",{subscriptionId:c,userHasPassword:h.get("_has_password"),subscriptionState:e})}).then(function(){i.$broadcast("refreshPageData");return a.activate("postCancelSurvey",{subscriptionState:e,subscriptionPeriodEndDate:new Date(d),
subscriptionPlanId:f,daysActive:t})})},function(){k.location.reload()})}}}]);angular.module("account").controller("contactInfoTab",["$scope","country","currentUser","users","validator","$window",function(a,d,b,c,e,f){a.saveDisabled=!1;a.showForm=!1;a.serverSuccess="";a.serverError="";a.countries=[""].concat(d.countries);a.contactInfoErrors={};b.fetchFullUser().then(function(b){a.user=b;a.user.mailing_address||(a.user.mailing_address={address_line_1:"",address_line_2:"",city:"",region:"",postal_code:"",country:""});a.showForm=!0});a.saveContactInfo=function(){if(!a.saveDisabled){a.saveDisabled=
!0;a.serverSuccess="";a.serverError="";var b;b=e.check({setsFirstName:{pretty:"first name",value:a.user.first_name,validators:[{type:"required"}]},setsLastName:{pretty:"last name",value:a.user.last_name,validators:[{type:"required"}]},setsEmail:{pretty:"email address",value:a.user.email.address,validators:[{type:"required",chained:[{type:"email"}]}]}});a.contactInfoErrors=b.errorText;b.valid?c.put(a.user).then(function(){a.serverSuccess="Contact Information Saved";a.saveDisabled=!1;f.location.reload()},
function(b){a.serverError=b.error;a.saveDisabled=!1}):a.saveDisabled=!1}}}]);angular.module("account").controller("developmentEnvironmentInfoTab",["$scope","currentUser","developmentEnvironments","$log",function(a,d){a.accountKey=d.get("key")}]);angular.module("account").controller("linkedAccountsTab",["$scope","$timeout","currentUser","users","google","facebook","normalizedSocialService","session","siteExperience",function(a,d,b,c,e,f,g,h,i){a.loading=!0;a.managed=i.managedAccount;a.accounts={google:null,facebook:null};var k=function(){a.serverSuccess="";a.serverError=""},l=function(b,c,e){c=g.normalizeAccount(b,c);c.id===a.user["_"+b+"_id"]||e?c.loggedIn=!0:c={loggedIn:!1};return a.accounts[b]=c},j=function(b){a.loading=!1;a.serverError=
b.error};a.getLinkedAccountTypes=function(){return _.keys(a.accounts)};a.disconnect=function(b){a.loading=!0;var e={key:a.user.key};e[b+"_id"]=null;c.put(e).then(function(c){k();a.loading=!1;a.user=c;"github"!==b&&(a.accounts[b]=null)},j)};a.disconnectSocial=function(b){a.loading=!0;var e={key:a.user.key},d=a.user.social_accounts.length&&"github"==b?"social_accounts":"external_accounts",f=null;_.each(a.user[d],function(a,c){if(a.account_type===b||a.affiliate_program_key===b)f=c});null==f?a.loading=
!1:(a.user[d].splice(f,1),e[d]=a.user[d],c.put(e).then(function(c){k();a.loading=!1;a.user=c;a[b]=null},j))};a.connect=function(b){a.loading=!0;var e=g.normalizeAccountService(b),f=function(g,h){var i=function(a){401===a.code&&f(g-1,3*h)};0===g&&(i=j);d(function(){e.getAccount().then(function(e){var d={key:a.user.key};d[b+"_id"]=e.id;c.put(d).then(function(c){e=l(b,e,!0);k();a.loading=!1;a.user=c},j)},i)},h)},i=function(){f(3,500)};e.login().then(function(a){a=g.createSessionData(b,a);h.put(a).then(i,
i)},j)};k();b.fetchFullUser().then(function(){a.loading=!1;a.user=b.getUser();_.each(a.user.social_accounts,function(b){a[b.affiliate_program_key]=b});_.each(a.user.external_accounts,function(b){a[b.affiliate_program_key]=b});_.each(a.getLinkedAccountTypes(),function(a){g.normalizeAccountService(a).getAccount().then(function(b){l(a,b)})})},j)}]);angular.module("account").controller("myCertificatesTab",["$q","$scope","$sce","currentUser","users","nodes",function(a,d,b,c,e,f){d.loading=!0;d.verifiedCertificates=[];d.nodeMap={};d.serverError="";var g=c.getUser();d.getBadges=function(){return _.filter(g._badges,function(a){return"Course Mastery"===a.name&&0<a.highest_level})};a.all([e.getCertificates("me").then(function(a){d.verifiedCertificates=a;a=_.map(a,function(a){return a.node_ref.key});return f.batchGet(a,{projection:"catalog"}).then(function(a){_.extend(d.nodeMap,
a)})}),c.fetchFullUser().then(function(a){g=a;a=d.getBadges();a=_.map(a,function(a){return a.target_ref.key});return f.batchGet(a,{projection:"catalog"}).then(function(a){_.extend(d.nodeMap,a)})})]).then(function(){d.loading=!1},function(a){d.loading=!1;console.error(a.error);d.serverError=b.trustAsHtml('Looks like there was a problem retrieving your data.  If you keep getting this message after refreshing the page please contact us at <a href="mailto:tech-support@udacity.com">tech-support@udacity.com</a>')})}]);angular.module("account").controller("myCoursesTab",["$q","$scope","currentUser","modal","nodeUtility","nodes","myCourses",function(a,d,b,c,e,f,g){d.loading=!0;d.isPreEnrolled=e.isPreEnrolled;d.isCurrentEnrolled=e.isCurrentEnrolled;d.isFreeEnrolled=e.isFreeEnrolled;d.hasEnrolled=e.hasEnrolled;d.confirm=c.confirm;d.cancel=c.cancel;d.remove=function(a){d.loading=!0;c.activate("removeCourse").then(function(){b.enroll(a,"unenrolled")},function(){d.loading=!1})};var h=function(){a.all([g.getNodeMap(),
g.getSortedEnrollments(!0),g.getSortedEnrollments(!1)]).then(function(a){d.nodeMap=a[0];d.forPayEnrollments=a[1];d.nonPayEnrollments=a[2];d.loading=!1})};d.$on("modifiedEnrollment",function(){h()});h()}]);angular.module("account").controller("passwordTab",["$scope","currentUser","users","validator",function(a,d,b,c){function e(){a.currentPassword="";a.newPassword="";a.confirmedNewPassword="";a.saveDisabled=!1}a.serverSuccess="";a.serverError="";e();a.passwordErrors={};a.showForm=!1;d.fetchFullUser().then(function(b){a.user=b;a.showForm=!0});a.resetPassword=function(){if(!a.saveDisabled){a.saveDisabled=!0;a.serverSuccess="";a.serverError="";var f;f={setsNewPass:{pretty:"your new password",value:a.newPassword,
validators:[{type:"required",chained:[{type:"strLen",args:[7,void 0]}]}]},setsConfirmedNewPass:{pretty:"new password confirmation",value:a.confirmedNewPassword,validators:[{type:"required",failMsg:"A password confirmation is required.",disabled:""===a.newPassword,chained:[{type:"equal",args:[a.newPassword,"password"]}]}]}};a.user._has_password&&(f.setsCurrPass={pretty:"password",value:a.currentPassword,validators:[{type:"required",failMsg:"Your current password is required.",disabled:""===a.newPassword&&
""===a.confirmedNewPassword}]});f=c.check(f);a.passwordErrors=f.errorText;f.valid?(f={key:d.getUser().key,password:{old:a.currentPassword,"new":a.newPassword}},b.put(f).then(function(){a.serverSuccess="Password successfully updated!";e()},function(b){a.serverError=b.error;a.saveDisabled=!1})):a.saveDisabled=!1}}}]);angular.module("account").controller("subscriptionCancellation",["$scope","modal","$q","api","$location","customers","$window","recordActivity","dateTime","currentUser","$rootScope","cancellationFlow",function(a,d,b,c,e,f,g,h,i,k,l,j){a.cancelSubscription=j.cancelSubscription;a.navigateToPasswordTab=function(){e.path("/password");d.cancel()};a.passwordForm={};a.confirmSubscriptionCancellation=function(e,h,i){a.state="checking";c.post("/session/reauthentication",{password:h}).then(function(){g.dataLayer&&
g.dataLayer.push({subscriptionState:i,subscriptionId:e,event:"SubscriptionCancelled"});return f.removeSubscription("me",e)},function(){return b.reject("invalidPassword")}).then(function(){a.state=null;a.passwordForm={};d.confirm()},function(a){return b.reject(a||"cancelFailed")}).then(null,function(b){a.state=b})};a.survey={};a.surveyChoices=[{name:"The course requires more time than I expected",code:"tooMuchTime"},{name:"Due to unforeseen reasons I am unable to continue as planned",code:"unforeseenReasons"},
{name:"I learned what I wanted to learn and don't need to earn the certificate",code:"learnedEnough"},{name:"The course's quality did not meet my expectations",code:"courseQuality"},{name:"I didn't have the required background for the course",code:"lackingBackgroundKnowledge"},{name:"The course was not rigorous enough for me",code:"tooAdvanced"},{name:"Other (please explain below)",code:"other"}];a.submitSurvey=function(b,c,e,f,g){b||(b="noReasonGiven");b=[{name:"reason",content:b},{name:"subscriptionState",
content:f},{name:"productKey",content:e},{name:"daysActive",content:g||0}];c&&b.push({name:"details",content:c});h.surveyResponse("PaidClassCancellationSurvey",b);a.survey={};d.confirm()}}]);angular.module("utility").service("showChat",["currentUser","$q",function(a,d){var b=null;return{getGroupChatPromise:function(){b||(b=d.defer(),a.fetchFullUser().then(function(){a.isStaff()?b.resolve(!0):a.fetchEnrolledAndGraduatedNanodegreeKeys().then(function(a){b.resolve(0<_.size(a))})}));return b.promise}}}]);angular.module("widgets").directive("tutoringWhiteboard",["$http",function(a){return{restrict:"A",link:function(d,b){d.showWhiteboard=!1;d.showWhiteboardHolder=!1;d.toggleWhiteboard=function(){d.showWhiteboard=!d.showWhiteboard};var c=b.find(".tutoring-whiteboard-frame-holder");window.olark("api.chat.onCommandFromOperator",function(b){"whiteboard"===b.command.name&&(window.olark("api.chat.sendNotificationToOperator",{body:"Creating whiteboard..."}),c.children().length&&c.empty(),a.get("/api/session/whiteboard?title=Whiteboard").then(function(a){d.showWhiteboardHolder=
!0;c.append($("<iframe />",{src:a.data.url,"class":"tutoring-whiteboard-frame"}));d.showWhiteboard=!0;window.olark("api.chat.sendNotificationToOperator",{body:"Opened whiteboard.\nStudent's link (for troubleshooting): "+a.data.url+"\nYour link: "+(location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/api/session/whiteboard?unique_id="+a.data.unique_id+"&redirect=true")})}))})}}}]);angular.module("filters").filter("allowUnsafe",["$sce",function(a){return function(d){return a.trustAsHtml(d)}}]);angular.module("filters").filter("dateRelative",["$filter",function(a){return function(d){if(!d||isNaN(d))return"not available";var b=((new Date).getTime()-d)/1E3;return 60>b?"just now":3600>b?""+Math.floor(b/60)+"m ago":86400>b?""+Math.floor(b/3600)+"h ago":691200>b?""+Math.floor(b/86400)+"d ago":28944E3>b?a("date")(d,"MMM d"):a("date")(d,"MMM d, yyyy")}}]).filter("dateRelativeNoYear",["$filter",function(a){return function(d){d=a("dateRelative")(d);return/, \d{4}$/g.test(d)?d.substring(0,d.length-
6):d}}]).filter("stringDate",["$filter",function(){var a=function(a){if(!a)return a;var b=a.lastIndexOf(".");if(-1===b)return a;var c=b+7;if(c>a.length)return a;for(var e=b+1;e<c;++e)if("0">a[e]||"9"<a[e])return a;return a.substring(0,b)+a.substring(c,a.length)};return function(d){return Date.parse(a(d))}}]);angular.module("filters").filter("imageCropSize",["$filter",function(){return function(a,d){if(a)return a.match(/\/\/[^.\/]+\.ggpht\.com\//)||a.match(/\/_ah\/img\//)?a=a.replace(/\=s\d+(-c)?/,"=s"+d+"-c"):a.match(/\/\/robohash\.org\//)&&(a=a+"?size="+d+"x"+d),a}}]).filter("imageSize",["$filter",function(){return function(a,d,b){if(a){b=0===b?void 0:b;d=0===d?void 0:d;if("number"!==typeof d&&"number"!==typeof b)return a;var c=Math.max(b,d)||b||d;if(a.match(/\/\/[^.\/]+\.ggpht\.com\//)||a.match(/\/_ah\/img\//)){var e=
/#[\w=_\-&]*w=(\d+)&h=(\d+)/.exec(a);e&&(c=1*e[1],e=1*e[2],d=Math.min(b/e,d/c)||b/e||d/c,d=[c*d,e*d],a=a.replace(/\=s\d+(-c)?/,"=s"+Math.round(Math.max(d[0],d[1]))))}else a.match(/\/\/robohash\.org\//)&&c&&(a=a+"?size="+c+"x"+c);return a}}}]);angular.module("filters").filter("prettyDollars",[function(){return function(a){var d=parseInt(a,10);if(isNaN(d))return a;a="";0>d&&(a="-",d=Math.abs(d));var b=d%100;0<b&&10>b&&(b="0"+b);return a+"$"+Math.floor(d/100)+(b?"."+b:"")}}]);angular.module("filters").filter("slugify",[function(){return function(a){if(_.isUndefined(a)||_.isNull(a))return a;a=a.replace(/^\s+/,"").replace(/\s+$/,"");a=a.replace(/[^\w\s-]/g,"");a=a.toLowerCase();return a=a.replace(/[-_\s]+/g,"-")}}]);angular.module("filters").filter("titleCase",function(){return function(a){return(void 0===a||null===a?"":a).toString().toLowerCase().replace(/\b([a-z])/g,function(a){return a.toUpperCase()})}});angular.module("foundation").factory("myCourses",["$rootScope","$timeout","currentUser","nodes","nodeUtility",function(a,d,b,c,e){var f,g={getNodeMap:function(a){f=!a&&f||c.batchGet(_.pluck(g.getDisplayedEnrollments(),"node_key"),{projection:"navigation"});return f.then(function(a){return a})},getDisplayedEnrollments:function(){return b.getEnrollmentsWithState("enrolled").concat(b.getEnrollmentsWithState("interested"))},getSortedEnrollments:function(a){return g.getNodeMap().then(function(b){var c=
_.filter(g.getDisplayedEnrollments(),function(c){var d=b[c.node_key],f=_.has(b,c.node_key);return a?e.isPreEnrolled(c,d)||e.isCurrentEnrolled(c,d)&&f:e.isFreeEnrolled(c,d)&&f});return _.sortBy(c,function(a){return b[a.node_key].title})},function(){console.warn("Problem getting sorted enrollments.");return[]})}};return g}]);angular.module("foundation").controller("myCoursesDropDown",["$q","$scope","$timeout","currentUser","myCourses","nodeUtility",function(a,d,b,c,e,f){d.loading=!0;d.isPreEnrolled=f.isPreEnrolled;d.isCurrentEnrolled=f.isCurrentEnrolled;d.isFreeEnrolled=f.isFreeEnrolled;d.hasEnrolled=f.hasEnrolled;var g=function(){a.all([e.getNodeMap(),e.getSortedEnrollments(!0),e.getSortedEnrollments(!1)]).then(function(a){d.nodeMap=a[0];_.each(d.nodeMap,function(a){angular.isString(a.key)&&"nd"===a.key.slice(a.key.length-
2)&&(a.isRelatedCourse=!0,d.enrolledInSupportingCourses=!0)});d.forPayEnrollments=a[1];d.nonPayEnrollments=a[2];d.loading=!1})};d.$on("modifiedEnrollment",function(){g()});var h=b(g,1E4);d.manualInitialize=function(){d.loading&&(b.cancel(h),g())}}]);angular.module("foundation").factory("nodeUtility",[function(){var a=function(a,c,e){return a&&c&&c.catalog_entry.paid_class?0<_.intersection(_.pluck(c.catalog_entry.paid_class[e],"key"),_.pluck(a.group_refs,"key")).length:!1},d={isGraduated:function(b,c){return a(b,c,"graduate_group_refs")},isPreEnrolled:function(b,c){return("interested"===b.state||"enrolled"===b.state)&&a(b,c,"future_student_group_refs")},isCurrentEnrolled:function(b,c){return"enrolled"===b.state&&a(b,c,"current_student_group_refs")},
isFreeEnrolled:function(a,c){return!d.isCurrentEnrolled(a,c)&&"enrolled"===a.state},hasEnrolled:function(b,c){return a(b,c,"past_student_group_refs")||d.isGraduated(b,c)},hasPermissionTo:function(a,c){return a&&!!_.find(a.guard.allowed_behaviors,function(a){return a===c})}};return d}]);angular.module("foundation").controller("siteFrame",["$scope","$window",function(a,d){a.responsivenessIsEnabled=!1;a.$on("setResponsiveness",function(b,c){!a.responsivenessIsEnabled&&c&&0===$('meta[name="viewport"]').length?$("head").append('<meta name="viewport" content="width=device-width, initial-scale=1.0" />'):$('meta[name="viewport"]').remove();a.responsivenessIsEnabled=c});a.cacheBustingIsEnabled="yes"===d.localStorage.getItem("bustAllTheCaches")?"yes":"no";a.toggleCacheBusting=function(){a.cacheBustingIsEnabled=
"yes"===a.cacheBustingIsEnabled?"no":"yes";d.localStorage.setItem("bustAllTheCaches",a.cacheBustingIsEnabled);d.location.reload()}}]);angular.module("foundation").directive("tocPageTocGenerator",[function(){return{restrict:"A",link:function(a,d,b){a.tocEntries=[];var c=[],e="";try{e=JSON.parse(b.tocSelector.replace(/\'/g,'"'))}catch(f){e=[b.tocSelector]}if(_.isArray(e)){_.each(e,function(a,b){d.find(a).each(function(a){$(this).attr("id","section-"+b+"-"+a)})});d.find(e.join(", ")).each(function(){c.push({id:$(this).attr("id"),name:$(this).text(),level:parseInt(/section-(\d*)-\d*/.exec($(this).attr("id"))[1],10)})});var g=function(a){for(var b=
[],c=0;c<a.length;c++){a[c].children=[];for(var e=c+1;e<a.length&&!(a[e].level<=a[c].level);e++)a[c].children.push(a[e]);0<a[c].children.length&&(a[c].children=g(a[c].children));b.push(a[c]);c+=a[c].children.length}return b};a.tocEntries=g(c)}else console.error("TOC selector was not string or array. No TOC for you!")}}}]);angular.module("foundation").directive("tocPageTocList",[function(){return{restrict:"A",scope:{structuredList:"="},replace:!0,template:'<ul class="nav nav-pills nav-stacked"><li data-ng-repeat-start="entry in structuredList"><a href="#{{entry.id}}">{{entry.name}}</a></li><li data-ng-if="entry.children.length>0" data-ng-repeat-end ><ul class="nav nav-pills nav-stacked"><li data-ng-repeat-start="secondEntry in entry.children"><a href="#{{secondEntry.id}}">{{secondEntry.name}}</a></li><li data-ng-if="secondEntry.children.length>0" data-ng-repeat-end><ul class="nav nav-pills nav-stacked"><li data-ng-repeat-start="thirdEntry in secondEntry.children"><a href="#{{thirdEntry.id}}">{{thirdEntry.name}}</a></li><li data-ng-if="thirdEntry.children.length>0" data-ng-repeat-end>Second!</li></ul></li></ul></li></ul>'}}]);angular.module("foundation").directive("unregisteredRedirect",["$window","currentUser",function(a,d){return{restrict:"A",link:function(){d.get("_registered")||(a.location.href="/account/auth#!/signin?next="+encodeURIComponent(a.location.href))}}}]);angular.module("gateways").factory("affiliates",["api",function(a){var d={get:function(b,c){return a.get("/affiliates/"+b,c).then(function(a){return a.data.affiliate})},batchGet:function(){throw Error("Not Implimented in API!");},put:function(a,c){return d.batchPut([a],c).then(function(c){return a.key?c[a.key]:_.first(_.values(c))})},batchPut:function(b,c){return a.post("/affiliates",_.extend({affiliates:b},c)).then(function(a){return a.data.references.AffiliateProgram})},list:function(b){var c=_.omit(b,
"offset","limit","cursor_map");c.paging={cursor_map:b&&b.cursor_map||null,offset:b&&b.offset||0,limit:b&&b.limit||10};return a.get("/affiliates",c).then(function(a){return a.data.affiliates})},getImageUploadUrl:function(b){return a.get("/affiliates/"+encodeURIComponent(b)+"/image/upload_url").then(function(a){return a.data.url})},putProfile:function(b,c,e){b="/affiliates/"+encodeURIComponent(b)+"/profiles/"+encodeURIComponent(c);c={};c.modified_profile=angular.copy(e)||{};c.modified_profile.model=
"AffiliateContactDetails";return a.post(b,c).then(function(a){return a.data.profile})}};return d}]);angular.module("gateways").provider("api",[function(){var a=function(a){return _.reduce(_.keys(a).sort(),function(b,c){var d=a[c];angular.isArray(d)&&(c+="[]");b[c]=d;return b},{})},d=function(){return Date.now()||+new Date},b={init:function(a,b){a.configuration=b;b.baseUrl=_.isUndefined(b.baseUrl)?"":b.baseUrl;a.setBaseUrl=function(a){b.baseUrl=/\/$/.test(a)?a.substring(0,a.length-1):a;return this}}},c={baseUrl:"/api"};b.init(this,c);this.$get=["$http","mixin","basicUser","$window","gitRevision",
"universalAnalytics",function(e,f,g,h,i,k){var l=["sessionExpired"],j=g.key;e.defaults.headers.common["X-Udacity-Client"]="udacity.com; version="+i;var m=function(c){var g={get:function(b,f,h){h=h||{};"yes"===window.localStorage.getItem("bustAllTheCaches")&&(f=f||{},f.cacheBusterValue=Math.random());h.params=a(f);var i=g.buildGetUrl(b,f),k=d();return 1600<i.length?(h.lengthy||console.warn("Url potentially too large for GET request; switching to POST. Set configuration option lengthy=true to suppress this warning."),
delete h.params,b+=(-1===b.indexOf("?")?"?":"&")+"_method=GET",g.verifySession(g.timeRequest(e.post(c.baseUrl+b,f,h),k))):g.verifySession(g.timeRequest(e.get(c.baseUrl+b,h),k))},post:function(a,b,f){var h=d();return g.verifySession(g.timeRequest(e.post(c.baseUrl+a,b,f),h))},deleteRequest:function(a,b,f){f=f||{};f.params=b;b=d();return g.verifySession(g.timeRequest(e["delete"](c.baseUrl+a,f),b))},timeRequest:function(a,b){return a.success(function(a,c,e){a=e("X-Udacity-Trail");c=d()-b;e=h.location.pathname+
h.location.hash;0<=c&&36E5>c&&(window._gaq&&window._gaq.push(["_trackTiming",a,"request",c,e]),k.trackTiming({"var":a||"unknown",category:"request",label:e,value:c}))})},verifySession:function(a){return a.success(function(a,b,c){(a=c("X-Udacity-Account-Id"))&&a!==j&&g.emitEvent("sessionExpired",{accountId:j})}).error(function(a,b,c){a=c("X-Udacity-Account-Id");(401===b||a&&a!==j)&&g.emitEvent("sessionExpired",{accountId:j})})},buildGetUrl:function(b,c){var e;e="/api"+b;var d=a(c),d=_.reduce(d,function(a,
b,c){b&&null!==b&&(angular.isArray(b)||(b=[b]),b=_.map(b,function(a){angular.isObject(a)&&(a=JSON.stringify(a));return g._encodeUriQuery(c)+"="+g._encodeUriQuery(a)}),a=a.concat(b));return a},[]);e=0===d.length?e:e+(-1===e.indexOf("?")?"?":"&")+d.join("&");return e},_encodeUriQuery:function(a,b){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,b?"%20":"+")}};b.init(g,c);g=f.eventEmission(g,l);g.withConfig=_.bind(function(a){var e=
angular.copy(_.omit(c,"configuration"));b.init(e,e);a(e);return m(e)},g);return g};return m(c)}]}]);angular.module("gateways").factory("cohortsGateway",["api",function(a){return{get:function(d,b){return a.get("/cohorts/"+encodeURIComponent(d),b).then(function(a){return a.data.cohort})},remove:function(d){return a.deleteRequest("/cohorts/"+encodeURIComponent(d)).then(function(a){return a.data})},searchCohorts:function(d){return a.get("/cohorts",d).then(function(a){return a.data.cohorts})},put:function(d){return a.post("/cohorts",{cohort:d}).then(function(a){return a.data.cohort})}}}]);angular.module("gateways").factory("coupons",["api","$timeout","$q",function(a){return{get:function(d){return a.get("/coupons/"+d).then(function(a){return a.data.coupon})},put:function(d){return a.post("/coupons",d).then(function(a){return a.data.coupon})},list:function(d){var b=_.omit(d,"offset","limit");b.paging={offset:d&&d.offset||0,limit:d&&d.limit||60};return a.get("/coupons",b).then(function(a){return a.data})},computeDiscount:function(d,b){return a.get("/coupons/"+d+"/compute_discount",{product_key:b}).then(function(a){return a.data})}}}]);angular.module("gateways").factory("customers",["api",function(a){return{get:function(d,b){return a.get("/customers/"+encodeURIComponent(d),b).then(function(a){return a.data.customer})},put:function(d,b){return a.post("/customers/"+encodeURIComponent(d),b).then(function(a){return a.data.customer})},removeSubscription:function(d,b){return a.deleteRequest("/customers/"+encodeURIComponent(d)+"/subscriptions/"+encodeURIComponent(b)).then(function(a){return a.data})},removeCreditCard:function(d,b){return a.deleteRequest("/customers/"+
encodeURIComponent(d)+"/cards/"+encodeURIComponent(b)).then(function(a){return a.data})},graduate:function(d,b){return a.post("/customers/"+encodeURIComponent(d)+"/subscriptions/"+encodeURIComponent(b)+"/graduate").then(function(a){return a.data})}}}]);angular.module("gateways").factory("developmentEnvironments",["api",function(a){return{getDevelopmentEnvironment:function(d,b){return a.get("/development_environment/"+encodeURIComponent(d),b).then(function(a){return a.data.development_environment})},createDevelopmentEnvironment:function(d,b){return a.post("/development_environment/"+encodeURIComponent(d),b).then(function(a){return a.data.development_environment})},deleteDevelopmentEnvironment:function(d,b){return a.deleteRequest("/development_environment/"+
encodeURIComponent(d),b).then(function(a){return a.data})}}}]);angular.module("gateways").factory("employers",["api",function(a){var d={get:function(b,c){return a.get("/employers/"+b,c).then(function(a){return a.data.employers})},put:function(a,c){return d.batchPut([a],c).then(function(c){return a.key?c[a.key]:_.first(_.values(c))})},batchPut:function(b,c){return a.post("/employers",_.extend({employers:b},c)).then(function(a){return a})},list:function(b){var c=_.omit(b,"offset","limit","cursor_map");c.paging={cursor_map:b&&b.cursor_map||null,offset:b&&b.offset||
0,limit:b&&b.limit||10};return a.get("/employers",c).then(function(a){return a.data.employers})}};return d}]);angular.module("gateways").factory("entityStore",["entityStoreHelper","$q",function(a,d){var b=function(a){return!_.isNull(a)&&!_.isUndefined(a)},c={setProjections:function(b,c){a.setProjections(b,c)},get:function(c,f,g,h,i){return h&&void 0!==h.depth?g(c,h).then(function(d){b(d)&&a.stash(c,f,i,d);return d}):d.when(a.getFilledEntity(c,f,i)).then(function(d){return d?d:g(c,h).then(function(d){b(d)&&a.stash(c,f,i,d);return d})})},batchGet:function(c,f,g,h,i){if(h&&void 0!==h.depth)return g(c,h).then(function(c){return c?
(_.each(_.filter(_.values(c),b),function(b){a.stash(b.key,f,i,b)}),c):{}});var k={},l=[];_.each(c,function(b){var c=a.getFilledEntity(b,f,i);c?k[b]=c:l.push(b)});return d.when(k).then(function(b){return 0<l.length?g(l,h).then(function(c){c&&_.each(_.filter(_.values(c),function(a){return a}),function(c){a.stash(c.key,f,i,c);b[c.key]=c});return b}):b})},standardMixin:function(a,b){var d=_.omit(b,"get","batchGet");d.__gateway=b;d.get=function(d,g){return g&&g.__skipCache?b.get(d,g):c.get(d,a,b.get,g,
g&&g.projection)};d.batchGet=function(d,g){return g&&g.__skipCache?b.batchGet(d,g):c.batchGet(d,a,b.batchGet,g,g&&g.projection)};return d}};return c}]).factory("entityStoreHelper",["$cacheFactory",function(a){var d={caches:{},projections:{},stash:function(a,c,e,f){a=d.getRecord(a,c,e);angular.copy(f,a.entity);a.filled=!0},getRecord:function(a,c,e){var f=d.getCache(c,e).get(a);f||(f={entity:{key:a,model:c},storeTime:"now",filled:!1},d.getCache(c,e).put(a,f));return f},getEntity:function(a,c,e){return d.getRecord(a,
c,e).entity},getFilledEntity:function(a,c,e){var f=d.getRecord(a,c,e);e&&!f.filled&&d.projections[c]&&!0===d.projections[c][e].base&&(f=d.getRecord(a,c,void 0));return f.filled?f.entity:void 0},getCache:function(b,c){var e=b+":"+(c||"");return a.get(e)||a(e)},setProjections:function(a,c){d.projections[a]=c}};return d}]);angular.module("gateways").factory("exams",["$q","api",function(a,d){return{get:function(a){return d.get("/exams",{exam_variant_id:a}).then(function(a){return a.data})},startExamTimer:function(a){return d.post("/exams/me/session",{exam_variant_id:a}).then(function(a){return a.data})},terminateExam:function(a,c,e){var f={};a&&(f.exam_lesson_key=a);c&&(f.exam_variant_id=c);return d.deleteRequest("/exams/"+encodeURIComponent(e||"me")+"/session",f).then(function(a){return a.data})},getTimeRemaining:function(a,
c,e){var f={};a&&(f.exam_lesson_key=a);c&&(f.exam_variant_id=c);return d.get("/exams/"+encodeURIComponent(e||"me")+"/session",f).then(function(a){return a.data})},deleteToken:function(a,c,e){var f={};a&&(f.exam_lesson_key=a);c&&(f.exam_variant_id=c);return d.deleteRequest("/exams/"+encodeURIComponent(e||"me")+"/admin",f).then(function(a){return a.data})},getWithStudentPermissions:function(a,c){var e={exam_variant_id:c};return d.get("/exams/"+encodeURIComponent(a)+"/admin",e).then(function(a){return a.data})}}}]);angular.module("gateways").factory("features",["api",function(a){return{get:function(d){return a.get("/features/"+encodeURIComponent(d)).then(function(a){return a.data.feature})},put:function(d,b){var c="True"===b;return a.post("/features/"+encodeURIComponent(d),{feature:{enabled:c}}).then(function(a){return a.data.feature})},list:function(){return a.get("/features").then(function(a){return a.data.features})}}}]);angular.module("gateways").factory("groups",["api",function(a){return{get:function(d,b){return a.get("/groups/"+encodeURIComponent(d),b).then(function(a){return a.data.group})},put:function(d){return a.post("/groups",{groups:[d]}).then(function(a){return _.values(a.data.references.Group)[0]})},batchPut:function(d){return a.post("/groups",{groups:d}).then(function(a){return a.data.references.Group})},find:function(d){return a.get("/groups",d).then(function(a){return a.data.groups})},getKeysByAffiliate:function(d,
b){return a.get("/groups/affiliate/"+encodeURIComponent(d),b).then(function(a){return a.data.groups})},getMembers:function(d,b){return a.get("/groups/"+encodeURIComponent(d)+"/members",b).then(function(a){return a.data.accounts})},addMember:function(d,b){_.isArray(d)||(d=["Group."+d]);var c={group_keys_to_join:d};return a.post("/users/"+encodeURIComponent(b)+"/memberships",c).then(function(a){return a.data.group_refs_joined})},removeMember:function(d,b){_.isArray(d)||(d=["Group."+d]);var c={group_keys_to_leave:d};
return a.post("/users/"+encodeURIComponent(b)+"/memberships",c).then(function(a){return a.data.group_refs_left})}}}]);angular.module("gateways").factory("nodeStates",["api",function(a){var d={get:function(a,c,e){return d.batchGet(a,[c],e).then(function(a){return a[c]})},batchGet:function(b,c,e){e=angular.copy(e)||{};e.node_keys=c;e.user_key=b;return a.get("/nodes/state",e).then(function(a){var b={};_.each(a.data.nodestates,function(a){b[a.node_ref.key]=a});return b})}};return d}]);angular.module("gateways").factory("nodeTests",["$q","api",function(a,d){return{batchGet:function(a){return d.get("/node_tests",{node_key:a}).then(function(a){return a.data.node_tests})},put:function(a){return d.post("/node_tests",{node_tests:[a]}).then(function(a){var a=a.data.references.NodeFunctionalTest,b=_.keys(a)[0];return a[b]})},deleteTest:function(a){return d.deleteRequest("/node_tests/"+encodeURIComponent(a)).then(function(a){return a.data})}}}]);angular.module("gateways").factory("nodes",["$log","api","entityStore",function(a,d,b){var c={get:function(a,b){return c.batchGet([a],b).then(function(b){return b[a]})},batchGet:function(a,b){b=angular.copy(b)||{};b.keys=a;return d.get("/nodes",b).then(function(a){return a.data.references.Node||{}})},put:function(a,b){return c.batchPut([a],b).then(function(b){return a.key?b[a.key]:b[_.first(_.keys(b))]})},batchPut:function(a,b){b=angular.copy(b)||{};b.nodes=a;return d.post("/nodes",b).then(function(a){return a.data.references.Node})},
list:function(){throw Error("Not supported by the API");},state:function(a,b,d){return c.batchState([a],b,d).then(function(a){return _.first(a)})},batchState:function(a,b,c){c=angular.copy(c)||{};c.node_keys=a;c.user_key=b;return d.get("/nodes/state",c).then(function(a){return a.data.nodestates})},getRevision:function(a,b){return d.get("/nodes/"+encodeURIComponent(a)+"/revisions"+encodeURIComponent(b)).then(function(a){return a.data.node})},listRevisions:function(a,b){var c=_.omit(b,"offset","limit",
"cursor_map");c.paging={cursor_map:b&&b.cursor_map||null,offset:b&&b.offset||0,limit:b&&b.limit||10};return d.get("/nodes/"+encodeURIComponent(a)+"/revisions",c).then(function(a){return a.data.revisions})},examify:function(a){return d.post("/nodes/"+encodeURIComponent(a)+"/exam").then(function(a){return a.data})},deExamify:function(a){return d.deleteRequest("/nodes/"+encodeURIComponent(a)+"/exam").then(function(a){return a.data})},getPotentialTutorKeys:function(a,b){return d.get("/nodes/"+encodeURIComponent(a)+
"/tutors",b).then(function(a){return a.data})},addPotentialTutor:function(a,b){return d.post("/nodes/"+encodeURIComponent(a)+"/tutors",{tutor_key:b})},removePotentialTutor:function(a,b){return d.deleteRequest("/nodes/"+encodeURIComponent(a)+"/tutors",{tutor_key:b})},getForumPosts:function(b,c,g){return d.get("/nodes/"+encodeURIComponent(b)+"/forum_posts").then(function(b){try{var d=JSON.parse(b.data.posts);return _.first(_.map(d,function(a){return{title:a.title,href:a.href+"#"+c.key,date:a.date,score:a.score,
answer_count:a.answer_count,views:a.views,important:a.important}}),g)}catch(e){return a.error(e),[]}})}};b.setProjections("Node",{navigation:{supers:[],base:!0},synopsis:{supers:[],base:!0},classroom:{supers:[],base:!0},catalog:{supers:[],base:!0}});return b.standardMixin("Node",c)}]);angular.module("gateways").factory("products",["api",function(a){var d={get:function(b,c){return a.get("/products/"+b,c).then(function(a){return a.data.product})},batchGet:function(){throw Error("Not Implimented in API!");},put:function(a,c){return d.batchPut([a],c).then(function(c){return a.key?c[a.key]:_.first(_.values(c))})},batchPut:function(b,c){return a.post("/products",_.extend({products:b},c)).then(function(a){return a.data.references.Product})},list:function(b){var c=_.omit(b,"offset","limit",
"cursor_map");c.paging={cursor_map:b&&b.cursor_map||null,offset:b&&b.offset||0,limit:b&&b.limit||10};return a.get("/products",c).then(function(a){return a.products})}};return d}]);angular.module("gateways").factory("projects",["api",function(a){var d={putSubmission:function(b){return a.post("/projects/submissions",{submissions:[b]}).then(function(a){a=_.map(a.data.references.ProjectSubmission,function(a){return a});return _.first(a)})},createSubmission:function(a,c,e){return d.putSubmission({model:"ProjectSubmission",node_ref:{ref:"Node",key:a},submission_link:c,submission_text:e})},batchPutSubmission:function(b){return a.post("/projects/submissions",{submissions:b}).then(function(a){return a.data.references})},
getSubmissionsBySearch:function(b){return a.get("/projects/submissions",b).then(function(a){return a.data})},getSubmission:function(b,c){return a.get("/projects/submissions/"+encodeURIComponent(b),c).then(function(a){return a.data.submission})},getSubmissionUploadUrl:function(b){return a.get("/projects/submissions/"+encodeURIComponent(b)+"/submission_file/upload_url").then(function(a){return a.data.url})},getReportUploadUrl:function(b){return a.get("/projects/submissions/"+encodeURIComponent(b)+"/project_report.uploaded_report/upload_url").then(function(a){return a.data.url})}};
return d}]);angular.module("gateways").factory("publicCatalog",["api",function(a){var d=a.withConfig(function(a){a.setBaseUrl("/public-api/v0")});return{get:function(){throw Error("Not Implemented in API!");},batchGet:function(){throw Error("Not Implemented in API!");},put:function(){throw Error("Not Implemented in API!");},batchPut:function(){throw Error("Not Implemented in API!");},list:function(a,c){return d.get("/courses?projection=internal",a,c).then(function(a){return a.data})}}}]);angular.module("gateways").factory("registrar",["api",function(a){var d={_get:function(b,c,d){var c=c||{},f=_.defaults(d||{},{limit:100,offset:0});c.paging=f;return a.get(b,c).then(function(a){var b=null,a=a.data;a.more&&(b={cursor_map:a.cursor_map,offset:f.limit+f.offset,limit:f.limit},delete a.cursor_map,delete a.more,a.nextPage=b);return a})},getSummaries:function(a,c){return d._get("/registrar/"+a+"/summaries",{},c)},queueSummary:function(b,c,d,f,g,h){return a.post("/registrar/"+b+"/summaries?_processing=background",
{lesson_key:d,group_key:c,file_format:f,description:g,perform_regrade:!!h})},getUdacityUserKeys:function(b,c,d){return a.get("/registrar/"+encodeURIComponent(b)+"/search/"+encodeURIComponent(c)+"/"+encodeURIComponent(d)).then(function(a){return a.data})},getAffiliateProfile:function(b,c){return a.get("/registrar/"+encodeURIComponent(b)+"/profiles/"+encodeURIComponent(c)).then(function(a){return a.data.profile})},deleteAffiliateProfile:function(b,c){return a.deleteRequest("/registrar/"+encodeURIComponent(b)+
"/profiles/"+encodeURIComponent(c)+"?remove_experience_key=True").then(function(a){return a.data})}};return d}]);angular.module("gateways").factory("requisitions",["$http",function(a){return{list:function(){return a.get("/proxy/requisitions").then(function(a){return a.data})}}}]);angular.module("gateways").factory("session",["api",function(a){var d={get:function(b){return a.get("/session",b)},batchGet:function(){throw Error("Not Implimented in API!");},put:function(b){return a.post("/session",b)},batchPut:function(){throw Error("Not Implimented in API!");},list:function(){throw Error("Not Implimented in API!");},connect:function(a,c){var e=angular.copy(c)||{};e.udacity=a;e.connect=!0;return d.put(e)},terminate:function(b){return a.deleteRequest("/session",b)},impersonate:function(b,
c,d){d=angular.copy(d)||{};d=_.extend(d,{username:b,allow_writes:c});return a.post("/session/impersonate",d)},log:function(b,c){var d=angular.copy(c)||{};angular.isArray(b)||(b=[b]);d=_.extend(d,{entries:b});return a.post("/session/logs",d)},whiteboard:function(b,c,d,f){f=angular.copy(f)||{};f=_.extend(f,{title:b,unique_id:c,redirect:d});return a.get("/session/whiteboard",f)}};return d}]);angular.module("gateways").factory("users",["$q","api",function(a,d){return{get:function(a,c){return d.get("/users/"+encodeURIComponent(a),c).then(function(a){return a.data.user})},batchGet:function(){throw Error("Not Implemented in API!");},put:function(b,c){var e=angular.copy(c)||{};e.user=_.omit(b,"key");return d.post("/users/"+encodeURIComponent(b.key),e).then(function(a){return a.data.user},function(b){return a.reject(b.data)})},batchPut:function(){throw Error("Not Implemented in API!");},list:function(){throw Error("Not Implemented in API!");
},registerUser:function(a){return d.post("/users",a).then(function(a){return a.data.user})},requestPasswordReset:function(a){return d.post("/users/send_password_reset_email",{email_address:a})},requestUnsubscribe:function(a){return d.post("/users/unsubscribe",{email_address:a})},resetPassword:function(a,c,e){a={password:a,code:e};return d.post("/users/"+encodeURIComponent(c)+"/reset_password",a)},setEnrollments:function(b,c,e,f){f=angular.copy(f)||{};f.node_keys=c;f.state=e;return d.post("/users/"+
encodeURIComponent(b)+"/enrollments",f).then(function(a){return a.data.modified_enrollments},function(){return a.reject("Failed to change enrollments")})},changeEnrollmentSettings:function(a,c,e){return d.post("/users/"+encodeURIComponent(c)+"/enrollments/"+encodeURIComponent(a)+"/settings",e)},getCertificates:function(a,c){return d.get("/users/"+encodeURIComponent(a)+"/certificates",c).then(function(a){return a.data.certificates})},checkIfJabberIdIsStaff:function(a){return d.get("/users/account_for_jabber_id/"+
encodeURIComponent(a)).then(function(a){if(a=a.data.user._memberships)return 0<_.filter(a,function(a){return-1<a.group_ref.key.indexOf("staff")}).length})},checkIfFirstChatVisit:function(a){return d.get("/users/"+a+"/tags",{namespace:"chat",tag:"introtochatseen"})},setFirstChatVisit:function(a){return d.post("/users/"+a+"/tags",{tags_to_add:[{model:"Tag",namespace:"chat",tag:"introtochatseen"}]})},addToEmailList:function(a,c,e,f){a={email_address:c,user_name:a,list_name:e};f&&(a.data=f);return d.post("/users/join_email_list",
a)},getSignatureUploadUrl:function(a){return d.get("/users/"+encodeURIComponent(a)+"/signature/upload_url").then(function(a){return a.data.url})},getImageUploadUrl:function(a){return d.get("/users/"+encodeURIComponent(a)+"/image/upload_url").then(function(a){return a.data.url})},getTutors:function(a,c){return d.get("/users/"+encodeURIComponent(a)+"/tutors",c).then(function(a){return a.data})},getTutees:function(a,c){return d.get("/users/"+encodeURIComponent(a)+"/tutees",c).then(function(a){return a.data})},
setTutor:function(a,c,e){return d.post("/users/"+encodeURIComponent(a)+"/enrollments/"+encodeURIComponent(c)+"/tutor",{tutor_account_key:e}).then(function(a){return a.data})},removeTutor:function(a,c,e){return d.deleteRequest("/users/"+encodeURIComponent(a)+"/enrollments/"+encodeURIComponent(c)+"/tutor",{tutor_account_key:e}).then(function(a){return a.data})}}}]);angular.module("embedded").constant("tags",{collection:"k-",course:"c-",lesson:"l-",exercise:"e-",morsel:"m-",tidbit:"t-"}).constant("typeForTag",{"k-":"collection","c-":"course","l-":"lesson","e-":"exercise","m-":"morsel","t-":"tidbit"});angular.module("utility").directive("qualarooSurveyInfoHack",["qualarooSurveyor","dateTime","currentUser","cookieJar","qualaroo",function(a,d,b,c,e){return{link:function(){if(b.userIsLoggedIn()){var c=d.getCurrent(),g=new Date(c.setDate(c.getDate()-21));a.fetchEarliestPaidEnrollmentDate(b.getUser()).then(function(c){e.set({paid:c?"yes":"no"});e.set({subscribed_over_three_weeks:c&&c<g?"yes":"no"});e.set({gt:a.everEnrolledInGtCourses(b.getUser())?"yes":"no"})})}}}}]);angular.module("utility").factory("qualarooSurveyor",["dateTime","$q","nodeUtility","nodes",function(a,d,b,c){var e={fetchEarliestPaidEnrollmentDate:function(a){var g=_.without(_.filter(a._enrollments,function(a){return a.first_paid_enrollment_time},null,void 0));return g.length?c.batchGet(_.pluck(g,"node_key")).then(function(a){var c=_.filter(g,function(c){return _.any(a,function(a){return b.isCurrentEnrolled(c,a)})}),c=_.map(c,function(a){return e._convertIsoDateToYearMonthDayDate(a.first_paid_enrollment_time)});
return c.length?_.min(c):null}):d.when(!1)},_convertIsoDateToYearMonthDayDate:function(a){if(a)return a=a.substring(0,10).split("-"),a=_.map(a,function(a){return parseInt(a,10)}),new Date(a[0],a[1]-1,a[2])},everEnrolledInGtCourses:function(a){return _.any(a._enrollments,function(a){return _.any(a.group_refs,function(a){return a.key&&0===a.key.toLowerCase().indexOf("gt")})})}};return e}]);angular.module("courseCatalog").config(["$locationProvider",function(a){a.html5Mode(!0).hashPrefix("!")}]).constant("SEARCH_DEBOUNCE_MILLIS",5E3).controller("courseCatalog",["$scope","$location","optimizely","$timeout","$filter","$q","affiliates","courseCatalogHelper","publicCatalog","gaqHelper","SEARCH_DEBOUNCE_MILLIS","universalAnalytics",function(a,d,b,c,e,f,g,h,i,k,l,j){var m=_.debounce(function(a,b,c){k.pushTrackingEvent(a,b,c);j.trackEvent({category:a,action:b,label:c})},l);a.fullTextSearch=
{query:""};a.filterCourses=function(b){var c=_.object(_.map(a.filters,function(a,b){return[b,_.reduce(a.options,function(a,b){return b.selected?a.concat(b):a},[])]})),f=_.filter(b,function(b){return a.activeCategory&&_.any(a.activeCategory.all_children,function(a){return a&&a===b.key})&&_.every(a.filters,function(a,d){return!c[d].length||a.match(b,c[d])})});if(a.fullTextSearch.query){var g=$.trim(a.fullTextSearch.query).toLowerCase();m("Catalog","Search",g);f=e("filter")(f,a.fullTextSearch.query)}!f.length&&
a.activeCategory?(f=_.filter(b,function(b){return _.any(a.activeCategory.courses,function(a){return a&&a===b.key})}),a.fallback=!0):a.fallback=!1;b=_.sortBy(_.filter(a.filters,function(a){return a.exposeInAddressAs}),"id");_.each(b,function(a){var b=_.sortBy(_.pluck(_.where(a.options,{selected:!0}),"name"),_.identity);d.search(a.exposeInAddressAs,b)});return f};var p=null;a.getSelectedTechnologyNames=function(){p||(p=_.findWhere(a.filters,{id:"technologyKeywords"}));return _.map(_.pluck(_.where(p&&
p.options,{selected:!0}),"name"),e("titleCase"))};a.getPageDescription=function(){var b=a.getSelectedTechnologyNames(),c="",d=a.activeCategory&&a.activeCategory.name;1===b.length?c=_.first(b)+" ":1<b.length&&(c=_.initial(b).join(", ")+", and "+_.last(b)+" ");return"Browse "+d+" Course and Nanodegree Programs to help advance your career. You'll learn "+c+"from industry experts from Google, Facebook, Twitter and Cloudera."};i.list().then(function(b){a.courses=_.map(_.union(b.degrees,b.courses),function(a){a.affiliates.length&&
(a.affiliate_program_refs=_.map(a.affiliates,function(a){return{key:a.key}}));return a});a.affiliateMap=_.reduce(a.courses,function(a,b){b.affiliates.length&&_.each(b.affiliates,function(b){a[b.key]=b});return a},{});a.tracks=b.tracks;return{courses:a.courses,affiliates:a.affiliateMap,tracks:a.tracks}}).then(function(c){a.filters=h.initializeFilters(c.courses,c.affiliates,d.search());d.search("");var f=function(){var b=_.find(c.tracks,function(a){return e("slugify")(a.name)===d.path().substr(1)});
b?a.activeCategory=b:d.path("all")};a.$on("$locationChangeSuccess",f);f();a.loadingComplete=!0;setTimeout(b.activate,0)})}]);angular.module("courseCatalog").constant("AFFILIATE_PRIORITIES",{facebook:1E3,google:1E3,Salesforce:1E3,gt:8E3,sjsu:8E3,twentythree:9E3}).factory("courseCatalogHelper",["AFFILIATE_PRIORITIES",function(a){var d="ma004 ma006 ma008 bio110 ph100 ps001".split(" "),b=[{id:"skills",name:"Skill Level",makeTitleCase:!0,generateOptions:function(a,b,d){return _.map(_.sortBy(_.unique(_.map(a,function(a){return a.level})).concat("new to tech"),function(a){return{beginner:1,intermediate:2,advanced:3}[a]||0}),function(a){return{name:a,
selected:d.level===a}})},match:function(a,b){return _.any(b,function(b){return b.name===a.level||"new to tech"===b.name&&a.starter})}},{id:"partners",name:"Built by",generateOptions:function(b,d,f){return _.sortBy(_.map(d,function(a){return{name:a.name,key:a.key,selected:f.partner===a.key}}),function(d){return a[d.key]?a[d.key]+d.name.toLowerCase():_.any(b,function(a){return _.any(a.affiliate_program_refs,function(b){return d.key===b.key&&a.available&&a.open_for_enrollment})})?3E3+d.name.toLowerCase():
5E3+d.name.toLowerCase()})},match:function(a,b){return _.any(a.affiliate_program_refs,function(a){return _.any(b,function(b){return b.key===a.key})})}},{id:"technologyKeywords",name:"Technology",makeTitleCase:!0,exposeInAddressAs:"technology",generateOptions:function(a,b,d){a=_.unique(_.flatten(_.map(a,function(a){return _.pluck(_.where(a.tags,{namespace:"technology-keyword"}),"tag")})));return _.map(a,function(a){return{name:a,selected:d.technology===a||_.contains(d.technology,a)}})},match:function(a,
b){var d=_.pluck(b,"name");return _.any(a.tags,function(a){return"technology-keyword"===a.namespace&&_.contains(d,a.tag)})}},{id:"paid",name:"Free Trial Available",hideTitle:!0,generateOptions:function(a,b,d){return[{name:"Free Trial Available",selected:"true"===d.full}]},match:function(a){return a.open_for_enrollment}},{id:"legacy",name:"Hide Legacy Courses",hideTitle:!0,generateOptions:function(a,b,d){return[{name:"Hide Legacy Courses",selected:"true"!==d.legacy}]},match:function(a,b){return b.length&&
!_.contains(d,a.key)}}];return{initializeFilters:function(a,d,f){_.each(b,function(b){b.options=b.generateOptions(a,d,f)});return b},_filters:b}}]);angular.module("courseCatalog").directive("courseSummary",["$location","cacheVersion",function(a,d){var b={beginner:1,intermediate:2,advanced:3};return{scope:{course:"=",affiliateMap:"="},templateUrl:"/templates/angular/course_catalog/course_summary.html?"+d,link:function(a){a.levelClass=function(){return"icon-level-"+b[a.course.level]}}}}]);angular.module("dashboard").controller("dashboardPage",["$scope","$routeParams","$window","$q","currentUser","nodes","nodeStates","nodeUtility","users","siteExperience",function(a,d,b,c,e,f,g,h,i,k){a.courseKey=d.courseKey;var l=null,j={};a.completedLessonKeys=[];a.nodeMap={};a.courseState={};a.loading=!0;a.$on("$routeChangeSuccess",function(){a.courseKey=d.courseKey;a.enrollment=_.find(e.get("_enrollments"),function(b){return b.node_key===a.courseKey});c.all([f.batchGet([a.courseKey],{depth:1,projection:"dashboard",
required_behavior:"view"}).then(function(b){b[a.courseKey].steps_refs=_.filter(b[a.courseKey].steps_refs,function(a){return b[a.key]});a.nodeMap=b;a.course=b[a.courseKey]}),g.get("me",a.courseKey).then(function(b){_.extend(a.courseState,b)}),g.get("me",a.courseKey,{projection:"progress"}).then(function(b){_.extend(a.courseState,b);if(b){var b=_.filter(_.pairs(b.progress),function(a){return a[1].last_interaction_time}),c=null;0<b.length&&(c=_.sortBy(_.reject(b,function(b){return b[0]===a.courseKey}),
function(a){return a[1].last_interaction_time}).reverse()[0][0]);b=c}else b=null;a.lastInteractedLessonKey=b}),i.getCertificates("me").then(function(a){l=a;_.each(l,function(a){var b=a.node_ref.key;_.has(j,b)?j[b].last_modification_time<a.last_modification_time&&(j[b]=a):j[b]=a})})]).then(function(){a.loading=!1;a.premiumAccess=h.hasPermissionTo(a.course,"view-paid-supplemental-media")||h.isCurrentEnrolled(a.enrollment,a.course)||h.isGraduated(a.enrollment,a.course)})});a.getCompletedLessonKeys=function(a){return a?
_.unique(_.pluck(a.completed_descendant_node_refs,"key")):[]};a.isComplete=function(b,c){return _.contains(a.getCompletedLessonKeys(c),b)};a.isPartiallyComplete=function(a,b){return b&&b.progress&&b.progress[a]?0<b.progress[a].completed_morsel_count:!1};a.getCertificate=function(a){return j[a]};a.isCurrentEnrolled=h.isCurrentEnrolled;a.isGraduated=h.isGraduated;a.managedAccount=k.managedAccount}]);angular.module("page.dashboard",["ngRoute","core","dashboard"]);angular.module("page.dashboard").config(["$locationProvider","$routeProvider","tags","cacheVersion",function(a,d,b,c){d.when("/"+b.course+":courseKey",{templateUrl:"/templates/angular/dashboard.html?"+c})}]);angular.module("account").controller("membershipPage").controller("membershipPage",["$scope","api","groups","currentUser",function(a,d,b,c){a.memberships=[];a.ready=!1;a.leaveGroup=function(b){a.error=null;d.post("/users/me/memberships",{group_keys_to_leave:["Group."+b]}).then(function(b){var c=$.map(b.data.group_refs_left,function(a){return a.key});a.memberships=_.reject(a.memberships,function(a){return _.contains(c,a.groupId)})},function(b){a.error="Failed to leave group ("+b.status+")"})};a.joinGroup=
function(b){a.error=null;d.post("/users/me/memberships",{group_keys_to_join:["Group."+b]}).then(function(a){_.each(a.data.group_refs_joined,function(a){e(a.key)})},function(b){a.error="Failed to join group ("+b.status+")"})};var e=function(c){var d={groupId:c};a.memberships.push(d);b.get(c).then(function(a){d.name=a.name;d.canLeave=_.contains(a.guard.allowed_behaviors,"remove-self")},function(a){d.name="Failed to load ("+a.status+")"})};c.fetchFullUser().then(function(b){_.each(b._memberships,function(a){a.current&&
"Group"===a.group_ref.ref&&e(a.group_ref.key)});a.ready=!0})}]);angular.module("overview").directive("nanodegreeEnrollmentActions",["cacheVersion","currentUser","groups","$location","dateTime","$window","gaqHelper","cookieJar","googleTagManager","universalAnalytics",function(a,d,b,c,e,f,g,h,i,k){return{restrict:"A",scope:{enrollmentActions:"="},templateUrl:"/templates/overview/nanodegree_enrollment_actions.html?"+a,controller:"enrollmentActionsHelper",link:function(a){var b=function(a){return{nd000:{start:"May 28 at noon Eastern Time",end:"June 8 at 11:59 pm Eastern Time"},
nd001:{start:"May 28 at noon Eastern Time",end:"June 8 at 11:59 pm Eastern Time"},nd002:{start:"May 28 at noon Eastern Time",end:"June 8 at 11:59 pm Eastern Time"},nd003:{start:"May 28 at noon Eastern Time",end:"June 8 at 11:59 pm Eastern Time"},nd004:{start:"May 28 at noon Eastern Time",end:"June 8 at 11:59 pm Eastern Time"}}[a]||{}},c=function(){i.pushTrackingEvent("nanodegreeAccess");a._goToClass()};a.getNanodegreeButtonInfo=function(){return a.isAccessible&&(a.isPaidEnrolled||a.isPaidGraduated)?
{variant:"nanodegree is live, student is enrolled or graduated",text:"Continue nanodegree",action:c}:a.isPaidEnrollable?a.isClassFull?a.isPaidWaitlisted?(h.exists("udacity_notify_me_clicked_recently")&&(i.pushTrackingEvent("notificationListJoin"),g.pushTrackingEvent("Waitlist","SignUp",a.courseKey),k.trackEvent({category:"Waitlist",action:"SignUp",label:a.courseKey}),h.remove("udacity_notify_me_clicked_recently")),{variant:"nanodegree is full, student is waitlisted",statusMessage:"You will be emailed when enrollment opens "+
b(a.courseKey).start,statusSuccess:!0}):{variant:"nanodegree is full, student not waitlisted, not enrolled",text:"Notify me",sidenote:"when nanodegree re-opens",statusMessage:"<strong>Next enrollment opens "+b(a.courseKey).start+".</strong><br>You can start the program immediately after you enroll.",action:function(){h.set("udacity_notify_me_clicked_recently","yes",{expires:new Date((new Date).getTime()+6E5)});a._joinGroup(a.waitlistGroupKey)}}:{variant:"nanodegree live, student not enrolled",text:"Enroll in Nanodegree",
sidenote:"One week trial",statusMessage:"You can start the program immediately after you enroll. <br><strong>Enrollment closes "+b(a.courseKey).end+".</strong>",action:function(){i.pushTrackingEvent("nanodegreeEnrollment");a._purchaseCourse()}}:{variant:"nanodegree not open for paid enrollment",sidenote:"This nanodegree is not yet available for enrollment"}};a=_.extend(a,a.enrollmentActions);a.productLaunchDate=new Date(a.productLaunchDateString);a.hasProductLaunched=a.enrollmentActions.isLaunched;
a.isVIP=a.isAccessible&&(!a.isAvailable&&!a.isLaunched||a.canEditContent)&&a.getNanodegreeButtonInfo().action!==c;a.isFull=a.isClassFull&&!(a.isPaidInterested||a.isPaidEnrolled||a.isPaidGraduated)}}}]);angular.module("overview").controller("nanodegreePortal",["$scope","cacheVersion","nodes","$window","currentUser","dateTime","api","$timeout","$q","productState","modal","fetchDiscourseLink",function(a,d,b,c,e,f,g,h,i,k,l,j){var m={};a.submissions={};a.submissionsFetched={};a.launchHangoutOnAir=function(a,b){l.activate(a).finally(function(){var a=$("#"+b),c=a.attr("src");a.attr("src","");a.attr("src",c)})};a.dismiss=function(){l.confirm()};var p=function(b){var b=b||0,c=_.find(a.submissionsFetched,
function(a){return!a});angular.isUndefined(c)?(_.each(a.lessons,function(b){var c=a.lessonStates.showCheckmark,d=b.key;b="Project"===b._semantic_type?a.submissions[b.key]&&0<a.submissions[b.key].length&&a.submissions[b.key][0].project_report?(b=a.submissions[b.key][0].project_report)&&b._completed&&("DISTINCTION"===b._rating||"PASSED"===b._rating):!1:a.lessonStates.completed[b.key];c[d]=b}),c=_.find(a.lessonKeys,function(b){return!a.lessonStates.showCheckmark[b]}),m[c]=!0):h(function(){p(b+1)},Math.pow(2,
b))},n=function(a,b){return g.get("/users/me/nodestates",{node_keys:a}).then(function(a){_.each(a.data.nodestates,function(a){b.completed[a.node_ref.key]=a.node_completed||b.completed[a.node_ref.key];b.visited[a.node_ref.key]=!0})})};a.toggleOpenLesson=function(a){m[a]=!m[a]};a.showOpenLesson=function(a){return m[a]};a.markLessonAsComplete=function(b,c){c=c||1;a.lessonStates.completed[b]=!0;m[b]=!1;p();var d={items:[{content_context:[{node_key:a.nanodegree.key,tag:"c-"},{node_key:b,tag:"l-"}],data:{model:"CompletedExperience",
completion_context:"Student self-completed the lesson"},occurrence_time:f.getCurrentAsUTC()}],current_time:f.getCurrentAsUTC()};return g.post("/activity?related_chain=true",d).then(function(a){return a},function(d){console.error("Error when trying to post activity. Response:");console.error(d);5>c&&(console.error("Retrying. Attempt "+c),h(function(){a.markAsComplete(b,c+1)}))})};a.enroll=function(b){e.enroll(b,"enrolled",!0).then(function(){a.disableCoursewareAction=!1;a.enrollRequestPending=!1;c.location.href=
"/course/viewer#!/c-"+c.encodeURIComponent(b)})};a.nanodegreeKey=k.courseKey;a.loadingMessage="Loading projects";a.lessons=[];b.batchGet([a.nanodegreeKey],{depth:1}).then(function(c){a.loadingMessage="Checking Progress";a.courses={};a.nanodegree=c[a.nanodegreeKey];a.lessonKeys=_.pluck(a.nanodegree.steps_refs,"key");a.lessonKeys=_.filter(a.lessonKeys,function(a){return c[a]});a.lessons=_.map(a.lessonKeys,function(b){m[b]=!1;"Project"===c[b]._semantic_type&&(a.submissionsFetched[b]=!1);return c[b]});
a.relatedCourses=_.pluck(a.nanodegree.overview_details.related_course_refs,"key");var d=a.relatedCourses;b.batchGet(d).then(function(b){_.each(d,function(c){var d=b[c];if(d){var e=null,f=d.catalog_entry;f&&f._image&&(e=f._image.serving_url);a.courses[c]={key:c,imageUrl:e,title:d.title||"Title for testing"}}})},function(a){console.warn("failed to fetch nodes"+a.data.error)});a.lessonStates={};a.lessonStates.completed={};a.lessonStates.showCheckmark={};a.lessonStates.visited={};i.all([b.state(a.nanodegreeKey,
"me").then(function(b){b&&_.each(b.completed_descendant_node_refs,function(b){a.lessonStates.completed[b.key]=!0})}),n(a.lessonKeys,a.lessonStates)]).then(function(){a.loadingMessage=null;p()});a.courseStates={};a.courseStates.completed={};a.courseStates.visited={};n(a.relatedCourses,a.courseStates)});j(a.nanodegreeKey).then(function(b){a.forumUrl=b})}]);angular.module("overview").directive("projectSubmissions",["cacheVersion","projects","fileQueue","currentUser",function(a,d,b,c){return{restrict:"A",scope:{projectKey:"=",submissions:"=",submissionsFetched:"=",nanodegreeKey:"="},templateUrl:"/templates/projects/project_submissions.html?"+a,link:function(a){a.showLinkSubmission=!1;a.pickedFiles={};a.showSubmissionOptions={};a.sendToReviews=_.contains(["nd000","nd001","nd002","nd003","nd004"],a.nanodegreeKey);a.gradingUrl="https://review.udacity.com/#!/projects/"+
a.projectKey;c.fetchCohorts().then(function(b){b="2736698543"===a.projectKey&&(_.contains(_.pluck(b,"key"),"6044041682092032")||_.contains(_.pluck(b,"key"),"6633903867035648"));a.sendToReviews=a.sendToReviews&&!b});var f=function(){return d.getSubmissionsBySearch({node_key:a.projectKey,student_key:"me",limit:100}).then(function(b){b=_.filter(b.submissions,function(a){return a.project_report&&a.project_report._completed&&"UNGRADED"===a.project_report._rating?!1:a._submission_link||a._submission_file||
a._submission_text||a.project_report});a.submissions[a.projectKey]=_.sortBy(b,function(a){return a._creation_time}).reverse();b=a.submissions[a.projectKey];0===b.length?a.showSubmissionOptions=!0:(b=_.first(b).project_report,a.showSubmissionOptions=b&&b._completed&&"INCOMPLETE"===b._rating);return a.submissions})},g=function(){a.showLinkSubmission=!1;a.submitting=!1;a.authorshipConfirmed=!1;a.error=!1},h=d.createSubmission;a.submitFile=function(c){a.error=!1;a.submitting=!0;return h(a.projectKey).then(function(g){return d.getSubmissionUploadUrl(g.key).then(function(d){return b.fileUploadTask(d,
a.pickedFiles[c]).then(function(){a.pickedFiles[c]=null;return f()})})},function(){a.error=!0;a.submitting=!1})};a.showLinkSubmissionOption=function(){a.showLinkSubmission=!0};a.cancelSubmission=function(b){a.pickedFiles[b]=null;g(b)};a.submitLink=function(b,c){a.submitting=!0;return h(a.projectKey,b,c).then(function(){return f()["finally"](g)},function(){a.error=!0;a.submitting=!1})};f().finally(function(){a.submissionsFetched[a.projectKey]=!0})}}}]);angular.module("overview").directive("courseEnrollmentActions",["cacheVersion","currentUser","groups","$location","dateTime","$window","courseState","modal","googleTagManager",function(a,d,b,c,e,f,g,h,i){return{restrict:"A",scope:{enrollmentActions:"="},templateUrl:"/templates/overview/course_enrollment_actions.html?"+a,controller:"enrollmentActionsHelper",link:function(a){a.courseState=g;a.currentHighlightedFeature=0;a.freeCourseActionDefaultSectionTitle="Access Course Materials";a.paidCourseActionDefaultSectionTitle=
"Enroll in Course";window.setInterval(function(){a.currentHighlightedFeature=(a.currentHighlightedFeature+1)%5;a.$apply()},4E3);a.getPaidCourseActionConfiguration=function(){if(a.isAccessible&&a.isPaidEnrolled)return{variant:"class is live, student is enrolled",text:"Go to class",hidePrice:!0,hideFeatures:!0,action:a._goToClass};if(a.hasProductLaunched)if(a.isPaidEnrollable){if(a.isClassFull&&a.isPaidWaitlisted)return{variant:"class is full, student is waitlisted",statusMessage:"You will be be notified when course enrollment is open. You can start the free course now."};
if(a.isClassFull)return{variant:"class is full, student not enrolled",text:"Notify me",note:"Get notified when enrollment is open",sectionTitle:"Enrollment is at capacity",hideFeatures:!0,action:function(){a._joinGroup(a.waitlistGroupKey)}};if(a.hasProductLaunched)return{variant:"class is live, student not enrolled",text:"Start free trial",note:a.spotsRemaining&&20>=a.spotsRemaining?"Only "+a.spotsRemaining+" seats left!":null,action:function(){i.pushTrackingEvent("paidCourseEnrollment");a._purchaseCourse()}}}else return{variant:"class not open for paid enrollment",
hideSectionTitle:!0};else return{variant:"class not live",hideSectionTitle:!0}};var b=function(){i.pushTrackingEvent("freeCourseResume");a._goToClass()};a.getFreeCourseActionConfiguration=function(){var c=a.isPaidEnrollable;return a.isPaidEnrolled?{variant:"class is live, student is paid enrolled",hideSectionTitle:!0,placeholder:"You're all set, dive in!"}:a.isAccessible&&a.isFreeEnrolled?{variant:"class is live, student is enrolled",text:"Resume course materials",action:b}:a.isAvailable&&a.isEnrollable?
(a.freeCourseActionDefaultSectionTitle=c?"Access Course Materials":"Start Free Course",{variant:"class is live, student not enrolled",text:c?"Access course materials":"Start free course",action:function(){i.pushTrackingEvent("freeCourseStart");a._enrollInCourseware()}}):a.isFreeInterested?{variant:"class not live, student is interested",hideSectionTitle:!0,statusMessage:"You will be notified when the course is open."}:a.isEnrollable?{variant:"class not live, student not registered",text:"Notify me",
note:"Get notified when the course is open",hidePrice:!0,hideFeatures:!0,action:function(){a._joinGroup(a.notificationGroupKey)}}:{variant:"error"}};a=_.extend(a,a.enrollmentActions);a.productLaunchDate=new Date(a.productLaunchDateString);a.hasProductLaunched=a.enrollmentActions.isLaunched;a.isVIP=a.isAccessible&&!a.isAvailable&&a.getFreeCourseActionConfiguration().action!==b&&a.getPaidCourseActionConfiguration().action!==a._goToClass}}}]);angular.module("overview").directive("courseOverviewPage",function(){return{require:"overviewPage",controller:["$scope","courseState",function(a,d){a.courseState=d}]}});angular.module("overview").controller("enrollmentActionsHelper",["$scope","cacheVersion","currentUser","groups","$location","dateTime","$window",function(a,d,b,c,e,f,g){a._goToClass=function(){g.location.href="/course/viewer#!/c-"+g.encodeURIComponent(a.courseKey)};a._purchaseCourse=function(b){g.location.href="/checkout#!/0?products="+g.encodeURIComponent(b||a.productKey)};a._joinGroup=function(d){b.userIsLoggedIn()?(a.disableCoursewareAction=!0,c.addMember(d,"me").then(function(){a.disableCoursewareAction=
!1;g.location.reload()})):g.location.href="/account/auth#!/signup?join-group="+g.encodeURIComponent(d)+"&next="+g.encodeURIComponent(e.absUrl())};a._enrollInCourseware=function(b){a._enroll("enrolled",b)};a._enroll=function(c){a.disableCoursewareAction=!0;var d="interested"===c?"/course/"+encodeURIComponent(a.courseKey):"/course/viewer#!/c-"+encodeURIComponent(a.courseKey);b.userIsLoggedIn()?b.enroll(a.courseKey,c,!0).then(function(){a.disableCoursewareAction=!1;a.enrollRequestPending=!1;g.location.href=
d}):g.location.href="/account/auth#!/signup?next="+g.encodeURIComponent(d)+"&enroll="+g.encodeURIComponent(a.courseKey)+"&enroll_state="+g.encodeURIComponent(c)}}]);angular.module("overview").directive("nanodegreePortalResourcesSection",["cacheVersion","nanodegreePortalResourcesSectionDefinition",function(a,d){return{restrict:"A",scope:{enrollmentGroupKeys:"=",nanodegreeKey:"=",nanodegree:"=nanodegreeNode"},templateUrl:"/templates/angular/overview/nanodegree_portal_resources_section.html?"+a,controller:["$scope",function(a){var c=_.findWhere(d,{nanodegreeKey:a.nanodegreeKey})||{},e=_.find(c.cohorts,function(c){return _.intersection(c.groupKeys,a.enrollmentGroupKeys).length})||
{};a.fields=_.extend({},c.fields,e.fields)}]}}]);angular.module("overview").constant("nanodegreePortalResourcesSectionDefinition",[{nanodegreeKey:"nd000",cohorts:[{groupKeys:["5523316458127360","bd-nd000-201502"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/10_Bq2kqmk-XOnZHAHZ3SazCrCdSrXlUoLTagIVp5DE8/pub?embedded=true"}},{groupKeys:["5501167186739200","bd-nd000-201503"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1X3qQi1nbDySbkKZvRih6lJIZiZZv4yuKrtXJrgbnivw/pub?embedded=true"}},{groupKeys:["6690771898204160",
"bd-nd000-201504"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1IAil9eaH2mePrGhK8xk4pdgOJXUpZ2Jjzz7f1hhnpCU/pub?embedded=true"}}],fields:{officeHours:{url:"https://plus.google.com/u/0/communities/100982870918349023509/events",label:"Tuesday 7PM Eastern Time"},studentHandbook:{label:"Intro to Programming Student Handbook",url:"https://docs.google.com/a/knowlabs.com/document/d/1W-GV7Y0TNIPLox1UJDgFxvioq6Y0dYitQ-1_SIJsw0A/pub?embedded=true"}}},{nanodegreeKey:"nd001",cohorts:[{groupKeys:["4817353793077248",
"bd-nd001-201410"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1vRDr0jRpgHFa90O7Qp5h6RPOKolLCRUmDrR4XIag5cI/pub?embedded=true"}},{groupKeys:["6267327280054272","bd-nd001-201411"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1Yx4b-9Ak2UHJ0okteIktqh9jYg4CEva4ZNFM_jTxX6g/pub?embedded=true"}},{groupKeys:["4983755399233536","bd-nd001-201412"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1nFOI4ZFh4fYkldrRvmRmgbmJR_KbqRROCdwruGODxbQ/pub?embedded=true"}},
{groupKeys:["5228759094919168","bd-nd001-201501"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1YvNhuqoTltud0Dtu80O2KluSDGHiaokxuyM_L8CP03I/pub?embedded=true"}},{groupKeys:["4512575093473280","bd-nd001-201502"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1i0cCDtI4wjwDASDC2NF3UGJOMGmQsFFC1YtNf2SgEwU/pub?embedded=true"}},{groupKeys:["5368165068701696","bd-nd001-201503"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1NYSGvEj3qGGtAKHqnME1551K1f-0ZeyUKm_ejlc0L14/pub?embedded=true"}},
{groupKeys:["6256644858314752","bd-nd001-201504"],fields:{timelineUrl:"https://docs.google.com/document/d/1cq3Qngz67K3nlAp7VbIWgyzC0DuM2PXSyb5DcHmkR1c/pub?embedded=true"}}],fields:{officeHours:{url:"https://www.google.com/calendar/embed?src=knowlabs.com_p1m072tkblufad6kbm09l27n7o%40group.calendar.google.com",label:"Sign up here"},liveCodecasts:{url:"https://plus.google.com/communities/117736402989322525566/events",label:"Mondays at 9PM Eastern Time"},studentHandbook:{label:"Front-End Student Handbook",
url:"https://docs.google.com/document/d/1NOHs9j1OmzM8iK_D3OR-seSMRSSasnS1SzvXTFfP05k/pub?embedded=true"}}},{nanodegreeKey:"nd002",cohorts:[{groupKeys:["5140722388303872"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1DktL9l2gt7wJ0fOljXKgm6nrkIoApM2SKaArqkM8Fq0/pub?embedded=true"}},{groupKeys:["6708040971059200","bd-nd002-201412"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/17IdPL6soArRqCTVdjWGOpswREaGYx6foLNyV18HBBxs/pub?embedded=true"}},{groupKeys:["5323305082421248",
"bd-nd002-201501"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/10fSQ3zYKSof-gVR4iPFn8NrGNEccDRytfVh31_8TEh4/pub?embedded=true"}},{groupKeys:["6319104843055104","bd-nd002-201502"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/18_nAkFmABL7UThIGSHuiv1JvSxaq0D6F-xOIp7OxNYk/pub?embedded=true"}},{groupKeys:["5764048242606080","bd-nd002-201503"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1MvCysqTnWONbQDvzT0SnWsPRwzOTXTztedj5jENsz4E/pub?embedded=true"}},
{groupKeys:["6535685729419264","bd-nd002-201504"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/13PmA2163W_kz_XF9fu_paC4EgHgKrWsqORR6ROfBGlE/pub?embedded=true"}}],fields:{officeHours:{url:"https://plus.google.com/u/0/communities/116797052510270749486/events",label:"Tuesdays at 1PM Eastern Time, Thursdays at 9PM Eastern Time"},studentHandbook:{label:"Data Analyst Student Handbook",url:"https://docs.google.com/a/knowlabs.com/document/d/1ZHwe0R5z61HXGcssgQvnuXHdm7D5U9Y8xx_Ra18GWAs/pub?embedded=true"}}},
{nanodegreeKey:"nd003",cohorts:[{groupKeys:["6435323516551168","bd-nd003-201503"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1mSO6hbMpdqfDIawd06VSXP5iIvvfvJ8Y212o2EIh3-c/pub?embedded=true"}},{groupKeys:["5943260287860736","bd-nd003-201504"],fields:{timelineUrl:"https://docs.google.com/a/knowlabs.com/document/d/1HMh0mF9uCzZ9I108EsuYLcSKe6xsON8YKeiA98Y1_ns/pub?embedded=true"}}],fields:{officeHours:{url:"https://docs.google.com/a/knowlabs.com/document/d/1Bz3KsMD2H4oyyClaqW4S4UG5HPtXZPWU7NckmaXXtXI/pub?embedded=true",
label:"Office Hours Schedule"},studentHandbook:{label:"iOS Nanodegree Student Handbook",url:"https://docs.google.com/document/d/1R59drlFwUdEwOWWO34T9SqK77iy1SnHFYtCoO0FNCmk/pub?embedded=true"}}},{nanodegreeKey:"nd004",cohorts:[{groupKeys:["6152833176436736","bd-nd004-201502"],fields:{timelineUrl:""}},{groupKeys:["5302193229398016","bd-nd004-201503"],fields:{timelineUrl:"https://docs.google.com/document/d/1yQYM-D8ORX6K6i74uG3JTTWFRCrQtO5ohF9DMdraiv4/pub?embedded=true"}},{groupKeys:["4923294474305536",
"bd-nd004-201504"],fields:{timelineUrl:"https://docs.google.com/document/d/1JZF5xyCw2l8LiZ9flrDPTVwSUQJ7xgX7M2S3Oy_yev4/pub?embedded=true"}}],fields:{officeHours:{url:"https://www.google.com/calendar/embed?src=2g7k2utipoipf36n6efstihne4%40group.calendar.google.com&ctz=America/Los_Angeles",label:"Sign Up Here"},liveCodecasts:{url:"https://plus.google.com/u/0/communities/110653833363880184779/events",label:"2nd and 4th Wednesday at 8PM Eastern Time"},studentHandbook:{label:"Full Stack Student Handbook",
url:"https://docs.google.com/document/d/1aqruU5LZ6_1xugQdISC5fwsStjV21SAppuR2SZn_q3E/pub?embedded=true"}}}]);angular.module("overview").controller("overviewPage",["$scope","$location","modal","youtubeVideoPlayer","facebook","productState","gaqHelper","showChat","universalAnalytics",function(a,d,b,c,e,f,g,h,i){a.productState=f;a.toggleInstructors={};a.showTrailer=function(){var a=window.location.pathname.split("/").pop();g.pushTrackingEvent("CourseOverview","TrailerPlayed",a);i.trackEvent({category:"CourseOverview",action:"TrailerPlayed",label:a});a=function(){c.pauseVideo()};b.activate("trailer").then(a,
a);c.playVideo()};a.showGroupChat=!1;h.getGroupChatPromise().then(function(b){a.showGroupChat=b});a.getEscapedPageUrl=function(){return window.encodeURI(d.absUrl())};a.urlEncode=function(a){return window.encodeURIComponent(a)};a.currentQuote=0;a.isCurrentQuote=function(b){return a.currentQuote===b};a.quotes=[{name:"\u2605\u2605\u2605\u2605\u2605 Seth Weidman",type:"reviewed the Data Analyst Nanodegree program:",text:"What really sets Udacity's program apart from others (like Coursera's), however, is the support they give you outside of just teaching data science skills. They set up 'office hours' where you can ask questions about the nanodegree, provide resources on how to conduct informational interviews, and identify data science sites that those looking to break into the industry should read frequently. In addition the user community is robust and helpful. Overall, I haven't felt lost, I feel like I can get help when I've needed it, and I have felt motivated to continue.",
questionUrl:"https://www.quora.com/Reviews-of-Data-Analyst-Nanodegree-Udacity",question:"Reviews of: Data Analyst Nanodegree (Udacity)",sourceUrl:"http://www.quora.com",source:"Quora"},{name:"Ben Halperin",type:"reviewed the Front-End Web Developer Nanodegree program:",text:"I'm going to be working as a software developer at athenahealth starting in April. I was in the first cohort for the Front-End Web Developer Nanodegree, which I completed in December. The program is still very early (started in October), so there are only a handful of people who have completed it. There are no statistics to give at this point, but I know several people who either have new jobs, were promoted, or are currently looking (and getting interviews).",
questionUrl:"https://www.quora.com/Is-there-somebody-that-get-a-job-by-using-udacity-nanodegrees",question:"Is there somebody that get a job by using udacity nanodegrees?",sourceUrl:"http://www.quora.com",source:"Quora"},{name:"\u2605\u2605\u2605 Jack Golding",type:"reviewed the Data Analyst Nanodegree program:",text:"I really liked Udacity when it started. When they stopped giving free certificates away I became disgruntled, but they are stepping up the quality again. To have me pay for Udacity courses, they must become a lot more challenging and in depth, and I expect to learn from industry experts - not someone younger than myself who is still doing their university degree, which was my experience with paying for the Data Science track.",
questionUrl:"https://www.quora.com/Reviews-of-Data-Analyst-Nanodegree-Udacity",question:"Reviews of: Data Analyst Nanodegree (Udacity)",sourceUrl:"http://www.quora.com",source:"Quora"},{name:"Mario Nuevo",type:"reviewed the Nanodegree program:",text:"In my opinion, you are only watching the top of the iceberg. You will miss one of the most important benefits of being enrolled. Support. Support provided both by students and instructors. I learned even more on the forums and with 1st hand support by instructors than in the lessons themselves. Not to mention google+ and linkedin private groups, where you will be able to grow your network.",
questionUrl:"https://www.quora.com/Why-should-I-pay-for-a-Udacity-Nanodegree-when-the-classes-are-already-free",question:"Why should I pay for a Udacity Nanodegree when the classes are already free?",sourceUrl:"http://www.quora.com",source:"Quora"},{name:"Allan Reyes",type:"reviewed the Nanodegree program:",text:"Like all educational opportunities, you'll get out what you put in. The ND program is still very new. A certification certainly won't guarantee you employment on its own merit, but I can safely say that active participation will give you industry-relevant skills. It's also important to note that by participating in the ND program, you can make use of Udacity's excellent career services. You'll get more exposure to employers, tips and mentorship on how to conduct interviews and prepare your resume, and you'll have a full, robust portfolio of projects to demonstrate your capabilities.",
questionUrl:"https://www.quora.com/Is-there-somebody-that-get-a-job-by-using-udacity-nanodegrees",question:"Is there somebody that get a job by using udacity nanodegrees?",sourceUrl:"http://www.quora.com",source:"Quora"},{name:"Joel Colucci",type:"reviewed the Nanodegree program:",text:"A Nanodegree gives you the blueprint for building a strong portfolio according to industry best practices and standards. The overall value of the Nanodegree lies in the student's ability to take the knowledge and support provided to them to create great projects. No certificate is a 'golden ticket' to employment.",
questionUrl:"https://www.quora.com/How-valuable-is-a-Udacity-Nanodegree-certificate",question:"How valuable is a Udacity Nanodegree certificate?",sourceUrl:"http://www.quora.com",source:"Quora"}];a.nextQuote=function(){a.currentQuote=a.currentQuote==a.quotes.length-1?0:++a.currentQuote};a.prevQuote=function(){a.currentQuote=0==a.currentQuote?a.quotes.length-1:--a.currentQuote}}]).directive("gradQuote",function(){return{restrict:"E",scope:{quote:"=quote"},template:'<div class="row"><div class="col-xs-8 col-xs-offset-2"><div><strong>{{quote.name}}</strong> {{quote.type}}<br></div></div></div><div class="row row-gap-small"><div class="col-xs-2"><img src="//lh6.ggpht.com/k31eNZbBfu0YF09K6YH1n6MZTqAOGlyQqT2QzmRfWxyx6Q8_yIkklOZRiZxO7ve9x_D2mUpedABmp-i4yA=s45#w=90&h=90"alt="left quote" title="left quote" class="img-responsive pull-right"><br><br><br><a href="" ng-click="$parent.prevQuote()"><span class="glyphicon glyphicon-chevron-left pull-right"></span></a></div><div class="col-xs-8"><p>{{quote.text}}</p><div><span class="small">In response to <a ng-href="{{quote.questionUrl}}">{{quote.question}}</a> on <a ng-href="{{quote.sourceUrl}}">{{quote.source}}</a></span></div></div><div class="col-xs-2"><img src="//lh3.ggpht.com/1J1jqYP4jo8EDJOz5XeDaqlMtdmlOYhYgtg2LtHbc-UL9MTkvlpcCgT4qBgsaPB6Ihof4P-Xa20JqVnhEpg=s45#w=90&h=90"alt="right quote" title="right quote" class="img-responsive pull-left"><br><br><br><a href="" ng-click="$parent.nextQuote()"><span class="glyphicon glyphicon-chevron-right pull-left"></span></a></div></div>'}});angular.module("page.overview",["overview"]);angular.module("overview").directive("priceInfo",["$timeout","coupons","couponCode",function(a,d,b){return{restrict:"A",scope:{productKey:"=",amount:"=",undiscountedAmount:"=",interval:"=",intervalCount:"="},template:'<span data-ng-hide="loadingDiscount"><span data-ng-show="undiscountedAmount"<span class="original-price">{{undiscountedAmount | prettyDollars}}&nbsp;</span><strong><span class="actual-price">{{amount | prettyDollars}}</span><span class="subscription-interval">/{{intervalCount != 1 ? intervalCount : ""}}{{interval}} </span></strong><span class="discount-description text-unbreakable" data-ng-show="undiscountedAmount"><small>{{discountPercent()}}% discount</small></span></span><div data-ng-show="loadingDiscount"><p class="text-large">Applying discount...</p><div class="text-center"><img class="text-center" alt="loading discount!"src="//lh5.ggpht.com/b3OandPWsUWAnRVS5d8JS8OL0nu8dU2d3NceS7p1yKhPl9KD4EhqeylPm7yFbft5wmsA2VCAZ-8wAkmFduXJ=s0#w=90&h=30"></div></div>',
link:function(a){a.discountPercent=function(){return Math.round(100*(a.undiscountedAmount-a.amount)/a.undiscountedAmount)};b?(a.loadingDiscount=!0,d.computeDiscount(b,a.productKey).then(function(b){b.result&&b.coupon.valid&&(a.undiscountedAmount||(a.undiscountedAmount=a.amount),a.amount=b.result)},function(a){console.log(a)})["finally"](function(){a.loadingDiscount=!1})):a.loadingDiscount=!1}}}]);angular.module("page.auth",["ngRoute","core","account"]);
angular.module("page.auth").config(["$locationProvider","$routeProvider","cacheVersion",function(a,d,b){d.when("/signin",{templateUrl:"/templates/angular/account/signin.html?"+b,controller:"signInForm"}).when("/signup",{templateUrl:"/templates/angular/account/signup.html?"+b,controller:"signUpForm"}).when("/request-password-reset",{templateUrl:"/templates/angular/account/request_password_reset.html?"+b,controller:"requestPasswordReset"}).when("/password-reset",{templateUrl:"/templates/angular/account/password_reset.html?"+
b,controller:"passwordReset"})}]);angular.module("account").controller("accountAuth",["$scope","$location","optimizely",function(a,d,b){a.initialSearch=d.search();d.replace().url(d.path());a.$on("$viewContentLoaded",function(){b.activate()})}]);angular.module("account").controller("passwordReset",["$scope","$sce","validator","users",function(a,d,b,c){var e=a.initialSearch.code,f=a.initialSearch.user_key;a.submit=function(){if(!a.buttonDisabled){a.buttonDisabled=!0;a.fieldErrors=null;a.errorMessage=null;a.successMessage=null;var g=b.check({password:{pretty:"your new password",value:a.password,validators:[{type:"required",chained:[{type:"strLen",args:[7,void 0]}]}]},passwordConfirm:{pretty:"confirmed password",value:a.passwordConfirm,validators:[{type:"required",
chained:[{type:"equal",args:[a.password,"password"]}]}]}});g.valid?c.resetPassword(a.password,f,e).then(function(){a.successMessage=d.trustAsHtml('Success! You may now use your new password to <a href="#!/signin">Sign In</a> now.')},function(){a.buttonDisabled=!1;a.errorMessage=d.trustAsHtml('We were unable to reset your password. Please check your email for a more recent password reset email, or request a <a href="#!/request-password-reset">new one</a>.')}):(a.fieldErrors=g.errorText,a.buttonDisabled=
!1)}}}]);angular.module("account").controller("requestPasswordReset",["$scope","$sce","validator","users",function(a,d,b,c){a.submit=function(){if(!a.buttonDisabled){a.buttonDisabled=!0;a.fieldErrors=null;a.errorMessage=null;a.successMessage=null;var e=b.check({email:{pretty:"email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]}});e.valid?c.requestPasswordReset(a.email).then(function(){a.buttonDisabled=!1;a.successMessage=d.trustAsHtml("Success! Please check your email for the link to change your password.")},
function(b){b=b.status;a.buttonDisabled=!1;a.errorMessage=400===b?d.trustAsHtml("We couldn't find an account with that email."):409===b?d.trustAsHtml("We have recently sent a reset email to that address. It may have been marked as spam."):d.trustAsHtml("Something went wrong and we were unable to send your reset email.")}):(a.fieldErrors=e.errorText,a.buttonDisabled=!1)}}}]);angular.module("account").controller("signInForm",["$scope","$q","$sce","session","users","currentUser","groups","validator","google","facebook","$location","safelyRedirect",function(a,d,b,c,e,f,g,h,i,k,l,j){var m=a.initialSearch.next;f.userIsLoggedIn()&&j(m);a.showTopBox=a.initialSearch.showMessage;var p=function(){var b=a.initialSearch.enroll,c=a.initialSearch.enroll_state||"enrolled",e=a.initialSearch["join-group"],b=b?f.enroll(b,c,!0):d.when(!0),h=e?f.fetchFullUser().then(function(){return g.addMember(e,
f.get("key"))}):d.when(!0);return b.then(function(){return h.then(function(){j(m)})})},n=function(c){a.errorMessage=b.trustAsHtml("We were unable to validate your account.");return d.reject(c)},r=function(c){if(403===c.data.status)a.errorMessage=b.trustAsHtml('Your social account isn\'t connected yet, you can sign in with an existing account, or <a href="#!/signup">Sign Up</a> to get started.');else{if(502===c.data.status)return n(c);a.errorMessage=b.trustAsHtml("Something went wrong and we're currently looking into it.")}return d.reject(c)};
a.signInEmail=function(){a.buttonDisabled=!0;a.fieldErrors=null;a.email=$("#email").val();a.password=$("#password").val();var e=h.check({email:{pretty:"email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]},password:{pretty:"password",value:a.password,validators:[{type:"required"}]}});e.valid?c.put({udacity:{username:a.email,password:a.password}}).then(p,function(c){a.buttonDisabled=!1;a.errorMessage=b.trustAsHtml("The email or password you entered is invalid");return d.reject(c)}):
(a.fieldErrors=e.errorText,a.buttonDisabled=!1)};a.signInFacebook=function(){return k.getAuthResponse().then(function(a){return c.put({facebook:{signed_request:a.signedRequest}}).then(p,r)},n)};a.signInGoogle=function(){i.getToken(!1).then(function(a){return c.put({google:{token:a.code}}).then(p,r)},n)}}]);angular.module("account").controller("signUpForm",["$scope","$q","$sce","$timeout","session","users","currentUser","groups","validator","google","facebook","$location","safelyRedirect","gaqHelper","googleTagManager","retry","cookieJar","universalAnalytics",function(a,d,b,c,e,f,g,h,i,k,l,j,m,p,n,r,q,t){a._removeEmailCookie=function(){q.exists("emailAddressForSignUp")&&q.remove("emailAddressForSignUp",{path:"/"})};var u=function(){var b=function(){var b=a.initialSearch.next;b?m(b):m("/")},c=a.initialSearch.enroll,
e=a.initialSearch.enroll_state||"enrolled",f=a.initialSearch["join-group"],e=c?g.enroll(c,e,!0):d.when(!0),i=f?g.fetchFullUser().then(function(){return h.addMember(f,g.get("key"))}):d.when(!0),k,l;a._removeEmailCookie();c?(k=p.pushTrackingEvent("SignUp","Enroll",c),t.trackEvent({category:"SignUp",action:"Enroll",label:c})):(k=p.pushTrackingEvent("SignUp","Direct"),t.trackEvent({category:"SignUp",action:"Direct"}));l=n.pushTrackingEvent("RegistrationCompleted");return e["finally"](function(){return i["finally"](function(){return k["finally"](function(){return l["finally"](b)})})})},
v=function(c){a.errorMessage=b.trustAsHtml("We were unable to validate your account.");return d.reject(c)},s=function(c){a.errorMessage=b.trustAsHtml("We were unable to access your account.");return d.reject(c)},x=function(c){409===c.data.status?(a.errorMessage=b.trustAsHtml("This account already exists, please sign in to continue."),a._removeEmailCookie()):a.errorMessage=b.trustAsHtml("Something went wrong and we're currently looking into it.");a.buttonDisabled=!1;return d.reject(c)};a.signUpEmail=
function(){a.buttonDisabled=!0;a.errorMessage=null;a.fieldErrors=null;var b=i.check({email:{pretty:"your email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]},password:{pretty:"your password",value:a.password,validators:[{type:"required",chained:[{type:"strLen",args:[7,void 0]}]}]},firstName:{pretty:"your first name",value:a.firstName,validators:[{type:"required"}]},lastName:{pretty:"your last name",value:a.lastName,validators:[{type:"required"}]}});b.valid?f.registerUser({email_address:a.email,
first_name:a.firstName,last_name:a.lastName,password:a.password,tos_accepted:!0}).then(u,x):(a.fieldErrors=b.errorText,a.buttonDisabled=!1)};a.signUpFacebook=function(){return l.getAuthResponse().then(function(a){return l.getMeResponse().then(function(b){return f.registerUser({email_address:b.email,first_name:b.first_name,last_name:b.last_name,facebook:{signed_request:a.signedRequest},tos_accepted:!0}).then(u,x)},s)},v)};a.signUpGoogle=function(){k.getToken(!1).then(function(a){return e.put({google:{token:a.code}}).then(u,
function(){return r(k.getMeResponse,5,100).then(function(a){return k.getToken(!0).then(function(b){return f.registerUser({email_address:a.email,first_name:a.given_name,last_name:a.family_name,google:{token:b.code},tos_accepted:!0}).then(u,x)},v)},s)})},v)};q.exists("emailAddressForSignUp")&&(a.email=q.get("emailAddressForSignUp"))}]);angular.module("account").controller("viewerSettings",["$scope","currentUser","users","techDetect","$window",function(a,d,b,c){a.isBrowserIE="Explorer"===c.browserStats().browser;a.videoQualities=[{label:"Automatic",value:"default"},{label:"360p",value:"medium"},{label:"480p",value:"large"},{label:"720p",value:"hd720"},{label:"1080p",value:"hd1080"}];a.playbackRates=[{label:"0.25x",value:0.25},{label:"0.5x",value:0.5},{label:"Normal",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}];var e=d.getUser();
e.site_preferences=e.site_preferences||{};e.site_preferences=_.defaults(e.site_preferences,{use_html5_player:!0,auto_advance:!0,playback_rate:a.playbackRates[2].value,video_quality:a.videoQualities[0].value});a.settings={useHtml5Player:e.site_preferences.use_html5_player,autoAdvance:e.site_preferences.auto_advance,playbackRate:_.find(a.playbackRates,function(a){return a.value===e.site_preferences.playback_rate}),videoQuality:_.find(a.videoQualities,function(a){return a.value===e.site_preferences.video_quality})};
a.save=function(){a.serverSuccess=a.serverError="";a.saving=!0;e.site_preferences={use_html5_player:a.settings.useHtml5Player,auto_advance:a.settings.autoAdvance,playback_rate:a.settings.playbackRate.value,video_quality:a.settings.videoQuality.value};b.put(e).then(function(){a.saving=!1;a.serverSuccess="Classroom Settings Saved"},function(b){a.saving=!1;a.serverError=b.error})}}]);angular.module("payment").controller("checkoutPage",["$scope","paymentFlow","$routeParams","$location","api","gaqHelper","currentUser","cacheVersion","modal","dateTime","optimizely","$timeout","universalAnalytics",function(a,d,b,c,e,f,g,h,i,k,l,j,m){g.get("_registered")||(window.location.href="/account/auth#!/signup?next="+encodeURIComponent(window.location.href));a.$on("$routeChangeSuccess",function(){f.pushPageviewEvent();m.trackVirtualPageView();if(angular.isDefined(b.stepNumber)&&d.isInFlow())d.goToStep(b.stepNumber);
else{var e=[];c.search().products?(e=c.search().products.split(","),d.begin(e),a.flow=d.getCurrentFlowData()):window.history.back()}});a.getCurrentDate=function(){return k.getCurrent()};a.isProductLaunched=function(a){return a&&a.launch_date&&new Date(a.launch_date)<k.getCurrent()};a.isProductNotLaunched=function(a){return a&&!a.was_launched};a.getDatePlusDays=function(a,b){return a?new Date(a.getTime()+864E5*b):null};a.step={};a.submitStep=function(b){a.step.submitting=!0;d.submitStep(b).then(function(){a.step.submitting=
!1;$("html,body").animate({scrollTop:0})})};a.getCacheBustingUrl=function(a){return a&&a+"?"+h};a.currentUserName=g.getFullName();a.currentUserEmail=g.get("email").address;a.currentUserNickname=g.get("nickname");a.getCurrentUserIsVerified=function(){return g.get("email")._verified};a.getCurrentStep=d.getCurrentStep;a.getCurrentFlowSteps=d.getCurrentFlowSteps;j(function(){!a.getCurrentUserIsVerified()&&!window.optimizelyDisableVerificationModal&&i.activate("verify email")},1);a.$on("$includeContentLoaded",
function(){l.activate()})}]);angular.module("page.payment",["core"]).config(["$routeProvider",function(a){a.when("/:stepNumber",{}).otherwise({redirectTo:"/0"})}]);angular.module("payment").constant("DAY_IN_MILLISECONDS",864E5).factory("fullClassExperienceFlowDefinition",["$q","stripeCreditCard","validator","api","currentUser","products","customers","couponCode","users","$timeout","$log","nodes","DAY_IN_MILLISECONDS","optimizely","userTrials","googleTagManager","universalAnalytics",function(a,d,b,c,e,f,g,h,i,k,l,j,m,p,n,r,q){var t=function(a){return"card_declined"===a.code?"Your card was declined. Please try again. If this issue persists, please contact payment-support@udacity.com.":
"processing_error"===a.code?"An error occurred while processing your card. Please try again.If this issue persists, please contact payment-support@udacity.com.":a.code?a.message:"An error occurred while processing your card. Please check your information and try again. If this issue persists, please contact payment-support@udacity.com."},u=function(a){return a&&_.map(a._course_groups,function(a){return a.course_ref&&a.course_ref.key})},v=function(b,d){var e={product_keys:d.productKeys};b&&b.id&&(e.stripe_token=
b.id);d.coupon&&d.coupon.valid&&(e.coupon_id=d.coupon.key);return c.post("/customers/me/purchases",e).then(function(a){return a.data.purchase},function(b){d.generalPaymentFormError=b.data.error?t(b.data):"We are having difficulties processing your request. If this error keeps appearing please contact payment-support@udacity.com.";b.data.was_charged&&alert("Error - your card was charged successfully but an error occured.Please contact us at payment-support@udacity.com immediately and we'll get this sorted out. Your spot is reserved. Please do NOT pay again.");
return a.reject(b)})};return[{label:"Checkout",view:"/templates/angular/payment/payment_form.html",onStart:function(b,e){var i=[f.get(e.productKeys[0]),g.get("me")];if(h){var k=c.get("/coupons/"+h+"/compute_discount",{product_key:e.productKeys[0]}),k=k.then(function(a){e.coupon=a.data.coupon;a.data.coupon.valid&&(e.coupon.discounted_price=a.data.result)},function(){e.coupon={valid:!1};return null});i.push(k)}a.all(i).then(function(a){e.product=a[0];var b=_.first(e.product._course_groups).course_ref.key;
j.get(b).then(function(a){var b=a.catalog_entry._image?a.catalog_entry._image.serving_url:null;e.confirmationStepLabel={Degree:"Start Nanodegree",Course:"Start course"}[a._semantic_type];e.course={key:a.key,imageUrl:b,isNanodegree:"Degree"===a._semantic_type};r.pushTrackingEvent("checkoutStart",{productName:e.product.name,productPrice:e.product.amount,orderNodeKey:e.course.key,isNanodegree:"Degree"===a._semantic_type})});b=e.product.trial_period_days;e.inTrialPeriod=0<b;e.trialPeriodStarts=new Date(Date.now()+
b*m);e.customer=a[1];e.customerCard=d.getDefaultCard(e.customer);e.cardIsLoaded=!0;e.uriEncodedCourseKey=window.encodeURIComponent(u(e.product));p.activate()})},onJump:function(a){return a.paymentConfirmed?!1:!a.paymentConfirmed},onSubmit:function(b,c){if(c.customerCard)return v(!1,c);var e=b.creditCard||{},f=d.checkValidity(e);c.creditCardErrors=f.errorText;if(!f.valid)return!1;f=(c.product&&c.product.name)+", "+u(c.product);return d.createPaymentToken(f,e).then(function(a){return v(a,c)},function(b){c.generalPaymentFormError=
t(b.error);return a.reject(b)})}},{getLabel:function(a){return a.confirmationStepLabel},view:"/templates/angular/payment/payment_confirmation.html",onStart:function(a,b){b.paymentConfirmed=!0;b.payment=a;var c=b.product&&(b.product.amount||0)/100,d=null;try{d=_.find(a.customer.subscriptions,function(a){return a.plan.id===b.product.key}).id}catch(e){l.error("Failed to get Transaction Id",e)}window._gaq.push(["_addTrans",d,"Udacity",c,"0.00","0.00","Mountain View","California","USA"]);window._gaq.push(["_addItem",
d,"DD44",b.product&&b.product.name,u(b.product),c,"1"]);window._gaq.push(["_trackTrans"]);q.trackTransaction({transactionId:d,transactionTotal:c,transactionAffiliation:"Udacity",transactionProducts:[{name:b.product&&b.product.name||"Missing product name, FILL IN IN CONTENT EDITOR ASAP FOR "+_.first(u(b.product)),sku:"DD44",price:c,quantity:1,category:_.first(u(b.product))}]});r.pushTrackingEvent("CompletedOrder",{transactionVal:c,transactionOrderId:d,transactionPromoCode:h,orderNodeKey:b.course.key,
isNanodegree:b.course.isNanodegree})}}]}]);angular.module("payment").factory("paymentFlow",["$q","paymentState","$location",function(a,d,b){return{begin:function(a){a=d.startFlow(a);if(a.onStart)a.onStart(null,d.getCurrentFlowData());b.path("/"+d.getCurrentStep().number.toString())},submitStep:function(c){var e=a.defer();(c=d.getCurrentStep().onSubmit(c,d.getCurrentFlowData()))?a.when(c).then(function(a){var c=d.goToNextStep();if(c.onStart)c.onStart(a,d.getCurrentFlowData());e.resolve();b.path("/"+c.number.toString())},function(){e.resolve()}):
e.resolve();return e.promise},goToStep:function(a){a=window.parseInt(a,10);if(a!==d.getCurrentStep().number&&(a=d.getStepNumber(a),!a.onJump||a.onJump(d.getCurrentFlowData()))){if(a.onStart)a.onStart(null,d.getCurrentFlowData());b.path("/"+d.goToNextStep().number.toString())}},isInFlow:d.isInFlow,getCurrentStep:d.getCurrentStep,getCurrentFlowSteps:d.getCurrentFlowSteps,getCurrentFlowData:d.getCurrentFlowData}}]);angular.module("payment").factory("paymentFlowDefinitions",["fullClassExperienceFlowDefinition",function(a){var d={"default":a};_.each(d,function(a){_.each(a,function(a,b){a.number=b})});return{get:function(){return d["default"]}}}]);angular.module("payment").controller("paymentForm",["$scope","api",function(a,d){a.sendVerificationEmail=function(){d.post("/users/send_verification_email").success(function(){a.resentVerificationEmail=!0}).error(function(a){console.error("Something went wrong",a)})};a.refresh=function(){window.location.reload()}}]);angular.module("payment").factory("paymentState",["paymentFlowDefinitions",function(a){var d=null,b=null,c={};return{startFlow:function(e){d=a.get(e);b=d[0];c={productKeys:e||[]};return b},getCurrentStep:function(){return b},getStepNumber:function(a){return d[a]},isInFlow:function(){return!!d},getCurrentFlowSteps:function(){return d},getCurrentFlowData:function(){return c},setCurrentStepNumber:function(a){return b=d[a]},goToNextStep:function(){return b=d[b.number+1]}}}]);angular.module("payment").factory("stripeCreditCard",["$http","$q","$rootScope","validator",function(a,d,b,c){var e=window.Stripe,f=!!e,g={createPaymentToken:function(a,c){var k=d.defer(),l=g.checkValidity(c);l.valid?f&&e.createToken({subject:a,name:c.nameOnCard,number:c.number,cvc:c.cvc,exp_month:c.expiryMonth,exp_year:c.expiryYear},function(a,c){b.$apply(function(){c.error?k.reject(c):k.resolve(c)})}):k.reject(l);return k.promise},checkValidity:function(a){return c.check({nameOnCard:{pretty:"cardholder's name",
value:a.nameOnCard,validators:[{type:"required"}]},number:{pretty:"credit card number",value:a.number,validators:[{type:"required",chained:[{type:"javascript",args:[e.card.validateCardNumber,a.number],failMsg:"Please enter a valid credit card number."}]}]},cvc:{pretty:"security code",value:a.cvc,validators:[{type:"required",chained:[{type:"javascript",args:[e.card.validateCVC,a.cvc],failMsg:"Please enter a valid security code."}]}]},expiryMonth:{pretty:"expiration month",value:a.expiryMonth,validators:[{type:"required"}]},
expiryYear:{pretty:"expiration year",value:a.expiryYear,validators:[{type:"required"}]}})},prettifyErrorResponse:function(a){return"card_declined"===a.code?"Your card was declined. Please try again. If this issue persists, please contact payment-support@udacity.com.":"processing_error"===a.code?"An error occurred while processing your card. Please try again.If this issue persists, please contact payment-support@udacity.com.":a.code?a.message:"An error occurred while processing your card. Please check your information and try again. If this issue persists, please contact payment-support@udacity.com."},
buildCreditCardMask:function(a,b){return"American Express"===a?"**** ****** *"+b:"Diners Club"===a?"**** **** **"+b.slice(0,2)+" "+b.slice(2,4):"**** **** **** "+b},getDefaultCard:function(a){var b=null;a&&0<a.cards.length&&(b=_.find(a.cards,function(b){return b.id===a.default_card}),b.maskedNumber=g.buildCreditCardMask(b.type,b.last4));return b}};return g}]);angular.module("payment").directive("stripeCreditCardDetails",["cacheVersion",function(a){return{restrict:"A",scope:{card:"=stripeCreditCardDetails",customerCard:"=customerCard",errors:"="},templateUrl:"/templates/angular/payment/stripe_credit_card_details.html?"+a,link:function(a){a.monthNumbers=_.range(1,13);a.yearNumbers=_.range(2014,2025)}}}]);angular.module("payment").controller("verifyEmailModal",["$scope","modal","currentUser","api",function(a,d,b,c){a.verificationState="unverified";a.sendVerificationEmail=function(){a.verificationState="emailResent";c.post("/users/send_verification_email").error(function(b){console.error("Something went wrong",b);a.checkVerificationStatus()})};a.checkVerificationStatus=function(){b.fetchFullUser().then(function(){b.get("email")._verified?d.confirm():a.verificationState="stillNotVerified"})}}]);angular.module("permissions").directive("accountList",["cacheVersion",function(a){return{restrict:"A",templateUrl:"/templates/content_editor/permissions/account_list.html?"+a,scope:{accountRefs:"=accountList"},controller:["$scope",function(a){a.removeAccount=function(b){a.accountRefs.splice(b,1)};a.addAccount=function(b){a.accountRefs.push(b.key)}}]}}]);angular.module("permissions").factory("permissions",["api",function(a){var d={normalizeRef:function(a){return!a?a:a.ref&&a.key?a.ref+"."+a.key:a},getPrincipal:function(b,c){return a.get("/permissions/principals/"+encodeURIComponent(b),{fresh:!!c}).then(function(a){return a.data.principal})},findPrincipals:function(b,c,d,f){b={query:b};c&&(b.query+=" kind="+c);d&&(b.limit=d);f&&(b.cursor=f);return a.get("/permissions/principals",b).then(function(a){return a.data})},autoScopeRole:function(a){if("Role"===
a.kind){if(a.scope_names.length)return null;a={name:a.name,kind:"ScopedRole",scopes:{},key:"ScopedRole."+a.name+"\\3aglobal"}}return a},getBehaviors:function(b,c,d){return a.get("/permissions/behaviors/"+encodeURIComponent(b),{fresh:!!c}).then(function(a){var b=a.data.behaviors,a=_.map(b,function(a,b){a.name=b;return a}),c=function(a){a.priority=(a.priority||0)+1;_.each(a.implied_behaviors,function(a){b[a]&&c(b[a])})};d&&(_.each(a,function(a){c(a)}),a.sort(function(a,b){return a.priority!==b.priority?
b.priority-a.priority:a.name.localeCompare(b.name)}));return a})},grantPermission:function(a,c){var e=_.find(a.permissions,function(a){return a.behavior===c.behavior&&d.normalizeRef(a.principal_ref)===d.normalizeRef(c.principal_ref)});e||(a.permissions.push(c),e=c);e.derivation=_.union(e.derivation||[],["assigned"])},revokePermission:function(a,c){a.permissions=_.reject(a.permissions,function(a){return a.behavior===c.behavior&&d.normalizeRef(a.principal_ref)===d.normalizeRef(c.principal_ref)&&(a.derivation=
_.reject(a.derivation,function(a){return"assigned"===a}),0===a.derivation.length)?!0:!1})},hasPermission:function(a,c){var e=c.behavior,f=d.normalizeRef(c.principal_ref),g=c.derivation||[];return _.some(a.permissions,function(a){return(!e||e===a.behavior)&&(!f||f===d.normalizeRef(a.principal_ref))&&_.every(g,function(b){return _.contains(a.derivation,b)})})},grantCentralPermission:function(b){return a.post("/permissions/central",{permissions:{guard:{allow:[b]}}})}};return d}]);angular.module("permissions").directive("permissionsEditor",["permissions","cacheVersion",function(a,d){return{restrict:"A",templateUrl:"/templates/content_editor/permissions/permissions_editor.html?"+d,scope:{guard:"=permissionsEditor"},link:function(b,c){c.addClass("permissions-editor");b.message=null;b.kind=null;b.behaviors=[];b.$watch("guard",function(c){null===c||void 0===c?(b.message=null,b.kind=null,b.behaviors=[]):c.subject_kind?c.subject_kind!==b.kind&&(b.message="Loading behaviors...",a.getBehaviors(c.subject_kind,
!1,!0).then(function(a){b.kind=c.subject_kind;b.message=null;b.behaviors=a;_.each(b.behaviors,function(a){var b="Allowed to "+a.doc;a.implied_behaviors.length&&(a.implied_behaviors.sort(),b+="; implies "+a.implied_behaviors.join(", "));a.description=b+"."})},function(a){b.kind=c.subject_kind;b.message="Unable to fetch behaviors for "+c.subject_kind+": error "+a.status;b.behaviors=[]})):(b.message="Not allowed to view permissions.",b.kind=null,b.behaviors=[])});b.getDerivationOrder=function(a){return _.contains(a.derivation,
"assigned")?0:_.contains(a.derivation,"inherited")?1:_.contains(a.derivation,"synthetic")?2:3};b.getPrincipalRefOrder=function(b){return a.normalizeRef(b.principal_ref)};b.isAssigned=function(a){return _.contains(a.derivation,"assigned")};b.isSynthetic=function(a){return _.contains(a.derivation,"synthetic")};b.revokePermission=function(c){a.revokePermission(b.guard,c)}}}}]).controller("addPermissionController",["$scope","permissions",function(a,d){a.addPermission=function(b){d.grantPermission(a.guard,
{behavior:a.behavior.name,principal_ref:b.key})}}]);angular.module("permissions").constant("principalImageUrls",{unknown:"/media/img/site/icons/udacity/principal_unknown.png",Account:"/media/img/site/icons/udacity/principal_account.png",Group:"/media/img/site/icons/udacity/principal_group.png",ScopedRole:"/media/img/site/icons/udacity/principal_role.png"}).directive("principal",["permissions","cacheVersion","principalImageUrls",function(a,d,b){return{restrict:"A",templateUrl:"/templates/content_editor/permissions/principal.html?"+d,scope:{ref:"=principal"},
link:function(a,b){b.addClass("principal")},controller:["$scope",function(c){c.key=null;c.imageLink=null;c.name=null;c.details=null;var d={Account:function(a){!a.first_name&&!a.last_name&&!a.nickname?c.name=a.email.address:(c.name=a.first_name||a.last_name?a.first_name&&a.last_name?a.first_name+" "+a.last_name:a.first_name?a.first_name:a.last_name:a.nickname,a.email&&(c.details=a.email.address))},Group:function(a){c.name=a.name},ScopedRole:function(a){c.name=a.name;a.scopes&&(a=$.map(a.scopes,function(a,
b){return b+" = "+a}),a.sort(),c.details=a.join(", "))}},f=function(a,f){c.key=a?a.key:f;c.name=f;if(a){c.imageLink=a.image_url||b[a.kind]||b.unknown;var i=d[a.kind];i?(c.details=null,i(a)):c.details="unknown kind: "+a.kind}else c.details="not found",c.imageLink=b.unknown;c.rows=c.name&&c.details?2:1};c.$watch("ref",function(d){null===d||void 0===d?(c.key=null,c.imageLink=null,c.name=null,c.details=null):d.kind&&d.key?f(d):(d=a.normalizeRef(d),d!==c.key&&(c.imageLink=b.unknown,c.name=null,c.details=
"Loading...",a.getPrincipal(d).then(function(a){f(a,d)},function(a){c.key=d;c.imageLink=b.unknown;c.name=d;c.details="error "+a.status})))})}]}}]).service("principalTemplate",["$compile",function(a){return{link:a('<div data-principal="principal"></div>')}}]);angular.module("permissions").directive("principalInput",["permissions","principalTemplate","cacheVersion","$compile","$timeout",function(a,d,b,c,e){return{restrict:"A",templateUrl:"/templates/content_editor/permissions/principal_input.html?"+b,scope:{principalSelected:"=principalInput",kind:"@kind",tooltip:"@tooltip"},controller:["$scope","$element",function(a,b){a.active=!1;a.userInput=null;a.principalInputOverlay=b.find(".principal-input-overlay");a.autocompleteOptions={options:{html:!0,onlySelect:!0,
autoFocus:!0,appendTo:a.principalInputOverlay,position:{my:"left top",at:"left bottom+5",collision:"none"},source:function(b,c){a.fetchAutocomplete(b,c)}},events:{select:function(b,c){b.preventDefault();c.item.value&&(a.principalSelected(c.item.value),a.autocompleteOptions.methods.clean(),a.active=!1)},focus:function(a){a.preventDefault()}}};a.toggleActive=function(){a.active=!a.active}}],link:function(b,c){b.fetchAutocomplete=function(c,e){c.term?a.findPrincipals(c.term,null,10).then(function(c){c.principals.length?
(e($.map(c.principals,function(c){var c=a.autoScopeRole(c),e=b.$new(!0);e.principal=c;return{label:d.link(e,function(){}),value:c}})),b.principalInputOverlay.removeClass("hide-autocomplete-results")):(e([{groupLabel:"No matches"},{label:"placeholder",value:null}]),b.principalInputOverlay.addClass("hide-autocomplete-results"))},function(a){e([{groupLabel:"Error "+a.status},{label:"placeholder",value:null}]);b.principalInputOverlay.addClass("hide-autocomplete-results")}):e([])};c.on("blur",".principal-input-field",
function(){b.autocompleteOptions.methods.clean();b.$apply(function(){b.active=!1})});c.keydown(function(a){27===a.which&&b.$apply(function(){b.active=!1})});b.$watch("active",function(a,b){a!==b&&e(function(){c.find(".principal-input-field")[a?"focus":"blur"]()},0,!1)})}}}]);angular.module("staticPages").controller("affiliateLinking",["$scope","affiliates","dateTime",function(a,d,b){a.submitted=!1;a.postError=!1;a.isWorking=!1;a.submitId=function(c,e){a.isWorking=!0;a.errorMessage="";a.postError=!1;a.submitted=!1;var f={lms_id:a.affiliateID,last_modification_time:b.getCurrent()};d.putProfile(c,e,f).then(function(){a.submitted=!0;a.postError=!1;a.isWorking=!1},function(){a.postError=!0;a.isWorking=!1;a.errorMessage="We were not able to update your account at this time."})}}]);angular.module("staticPages").controller("emailListAdder",["$scope","validator","users","cookieJar","currentUser","gaqHelper","universalAnalytics",function(a,d,b,c,e,f,g){a.submitted=!1;a.errorList={};a.postError=!1;a.isWorking=!1;a._setCookie=function(a,b){var d=new Date;d.setUTCFullYear(d.getUTCFullYear()+1);c.set("emailAddressForSignUp",a,{expires:d});c.set(b+"-signed-up",!0,{expires:d})};a.name=e.get("first_name");a.email=e.getEmail();a.submitEmailAddress=function(c){a.isWorking=!0;a.errorList=
{};a.postError=!1;a.submitted=!1;var e=d.check({name:{pretty:"your name",value:a.name,validators:[{type:"required"}]},email:{pretty:"your email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]}});e.valid?b.addToEmailList(a.name,a.email,c).then(function(){f.pushTrackingEvent("EmailList","SignUp",c);g.trackEvent({category:"EmailList",action:"SignUp",label:c});a.submitted=!0;a.postError=!1;a.isWorking=!1;a._setCookie(a.email,c)},function(){a.postError=!0;a.isWorking=!1}):
(a.isWorking=!1,a.errorList=e.errorText)}}]);angular.module("staticPages").controller("employersPage",["$scope","validator","employers",function(a,d,b){a.submitted=!1;a.errorList=null;a.postError=!1;a.isWorking=!1;a.positions={frontEnd:!1,fullStack:!1,dataAnalyst:!1,iosDeveloper:!1,other:!1};var c=function(a){for(var b in a)if(a[b])return!0;return!1};a.submit=function(){a.isWorking=!0;a.errorList=null;a.postError=!1;a.submitted=!1;var e=d.check({fullName:{pretty:"your full name",value:a.fullName,validators:[{type:"required"}]},companyName:{pretty:"your company name",
value:a.companyName,validators:[{type:"required"}]},email:{pretty:"your email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]},positions:{pretty:"your positions",value:a.positions,validators:[{type:"required",chained:[{type:"javascript",args:[c,a.positions]}]}]},tos:{pretty:"terms of service",value:a.tos,validators:[{type:"required"}]}});if(e.valid){var e=a.companyName,f=a.fullName,g=a.email,h=a.positions,i=[],k;for(k in h)h[k]&&i.push(k);b.put({model:"Employer",company_name:e,
person_name:f,email_address:g,positions_to_fill:i,locations_of_positions:a.positionLocation},{}).then(function(){a.submitted=!0;a.postError=!1;a.isWorking=!1},function(){a.postError=!0;a.isWorking=!1})}else a.isWorking=!1,a.errorList=e.errorText}}]);angular.module("staticPages").controller("fiftyBackController",["$scope","$window","users","currentUser","validator","dateTime",function(a,d,b,c,e,f){a.formSubmitted=!1;a.formPostError=!1;a.formSubmissionInProgress=!1;a.nanodegrees=[{key:"nd000",name:"Introduction to Programming"},{key:"nd001",name:"Front-End Web Developer"},{key:"nd002",name:"Data Analyst"},{key:"nd003",name:"iOS Developer"},{key:"nd004",name:"Full Stack Developer"}];a.selectedNanodegree=a.nanodegrees[0];a.beforeMay="";a.graduated=
"";a.employerPaying="";a.certificateError=!1;a.user={isLoggedIn:c.userIsLoggedIn(),name:c.getFullName(),email:c.getEmail(),accountKey:c.getUser().key,certificates:[]};var g=function(){a.formSubmitted=!0;a.formPostError=!1;a.formSubmissionInProgress=!1},h=function(){a.formPostError=!0;a.formSubmissionInProgress=!1},i=function(b){a.formSubmissionInProgress=!1;console.log(b.error)},k=function(){if(a.user.graduatedFrom===a.selectedNanodegree.key){a.certificateError=!1;var c;e.check({Email:{pretty:"your email address",
value:a.user.email,validators:[{type:"required",chained:[{type:"email"}]}]}}).valid?(c={timestamp:f.getCurrentAsUTC(),accountKey:a.user.accountKey,courseKey:a.selectedNanodegree.key?a.selectedNanodegree.key:"nd000"},b.addToEmailList(a.user.name,a.user.email,"fifty-back-promo",c).then(g,h)):a.formSubmissionInProgress=!1}else a.certificateError=!0,a.formSubmissionInProgress=!1};a.submit=function(){a.formSubmissionInProgress=!0;b.getCertificates(a.user.accountKey).then(function(b){a.user.certificates=
b;b=_.map(b,function(a){return a.node_ref.key});a.user.graduatedFrom=_.find(b,function(b){return b===a.selectedNanodegree.key})},function(a){console.log("Failed to get user certificates from API",a.error)}).then(k,i)}}]);angular.module("staticPages").controller("homepageCarousel",["$scope","$timeout",function(a,d){var b;a.storyNumber=0;a.stories=[{name:"dan",story:'Software Engineer Dan drew upon knowledge from several of his Udacity courses while completing technical interviews and was recruited to work for Google. <a href="http://blog.udacity.com/2013/10/googlers-advice-for-online-learners.html" target="_blank">Dan\'s story &#0187;</a>',linkText:"Dan: Experienced Developer"},{name:"megan",story:'After learning Python in Intro to Computer Science, Megan was able to transition from her career as a researcher to a junior developer at Sauce Labs. <a href="http://blog.udacity.com/2013/10/megan-from-researcher-to-developer.html" target="_blank">Megan\'s story &#0187;</a>',
linkText:"Megan: New to tech"},{name:"brent",story:'Brent worked in finance, but used knowledge from Udacity courses to advance his understanding of programming to land a product management internship at Google. <a href="http://blog.udacity.com/2013/08/how-udacity-helped-me-get-summer.html" target="_blank">Brent\'s story &#0187;</a>',linkText:"Brent: Tech-related job"}];var c=a.stories.length;a.switchStory=function(b){a.storyNumber=b};a.stopCarouselAutoAdvance=function(){d.cancel(b)};a.startCarouselAutoAdvance=
function(){b=d(function(){a.storyNumber=(a.storyNumber+1)%c;a.startCarouselAutoAdvance()},6500)};a.startCarouselAutoAdvance()}]);angular.module("staticPages").controller("homepageEmail",["$scope","cookieJar",function(a,d){a.hide=function(){a.hidePopUp=!0};d.exists("homepage-email-capture-signed-up")&&(a.hidePopUp=!0)}]);angular.module("staticPages").controller("jobListings",["$scope","requisitions",function(a,d){d.list().then(function(b){a.locations=_.groupBy(b,function(a){return a.categories.location});a.locations=_.map(a.locations,function(a,b){var d={left:[],right:[]};_.each(_.sortBy(_.map(_.groupBy(a,function(a){return a.categories.team}),function(a,b){return{name:b,positions:a}}),function(a){return-1*a.positions.length}),function(a,b){0===b%2?d.left.push(a):d.right.push(a)});return{name:b,columns:d}})})}]);angular.module("staticPages").controller("jobsImageGallery",["$scope","modal",function(a,d){a.images=[{url:"//lh5.ggpht.com/L5p-cd1uvO2wmtQR02usaGt3Z8JdggqKMoUymo4rAQCgNawOLOXHNi8-10181FIXzFXfiCeQO0QU4-r3pQ=s200#w=1200&h=750",alt:"a surprise birthday filled with balloons"},{url:"//lh5.ggpht.com/PUM7Chd29p1rbljUOA0bfW-Qm_LNHN6Py8MrnubulanrIGnqKKIXyvMn67LXcAuX2wMx8j4by-h-x7zVTu2d=s200#w=1200&h=750",alt:"the company aboard sebastian's boat"},{url:"//lh3.ggpht.com/Q87vvX0Ia-SsU2_Olgsiv1X3avrXO4aRvP5DV5JAHCIqGiGaGUGU2B6bY7nt7vNc-QdJQCj_INJ8yUNYFCU=s200#w=1200&h=750",
alt:"employees excitedly playing foosball"},{url:"//lh3.ggpht.com/qaqGh_Z6UfjvGE2Qh1_enoCJybv2tuZBgaJUpVesenyjYPHQUrGgymNAzBwdZe1-zD1T-T9gHl780iGlDus=s200#w=1200&h=750",alt:"employees at an offsite, smiling at the camera"},{url:"//lh3.ggpht.com/aUB0SqBzVXv2a_6VMGYHWwjojGSrEqOpcpdvpiFseTMUWqpmP23L3nmLjjp-0xS0gcCVu9raResm_KMwKfjW=s200#w=1200&h=750",alt:"employees relaxing by the poolside"},{url:"//lh3.ggpht.com/ZBgL1MP6R6M4dPdmSboemGgM9Re5z27vRBdiFNi334j8jGyZIFxdTAxHwxqdorWlUniib6p7qyPO-yOT3Q=s200#w=1200&h=750",
alt:"employees discussing pedagogy"}];a.showFullImage=function(a){d.activate("galleryImage",a)}}]);angular.module("staticPages").controller("nanodegreePageController",["$scope","validator","users","$filter","$q","affiliates","$window","currentUser",function(a,d,b,c,e,f,g,h){a.partnerImages={};a.nanodegrees={};a.company="ATAndT";a.step=1;a.submitted=!1;a.errorList=null;a.postError=!1;a.isWorking=!1;a.name=h.getFullName();a.email=h.getEmail();a.navigateTo=function(a){g.location.href=a};a.setCompany=function(b){a.company=b};a.getCompanyStyle=function(b){return a._getHoverStyle(a.company===b)};a.setStep=
function(b){a.step=b};a.getCircleStyle=function(b){return a._getHoverStyle(a.step===b)};a._getHoverStyle=function(a){return a?"opaque":"translucent"};a.submitList=function(f){a.isWorking=!0;a.errorList=null;a.postError=!1;a.submitted=!1;var g,h=d.check({Name:{pretty:"your name",value:a.name,validators:[{type:"required"}]},nanodegrees:{pretty:"a nanodegree",value:0<f.length||null,validators:[{type:"required"}]},Email:{pretty:"your email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]}});
h.valid?(g={reason:a.reason},e.all(_.map(f,function(d){d=c("slugify")(d);return b.addToEmailList(a.name,a.email,"nanodegree-interest-"+d,g)})).then(function(){a.submitted=!0;a.postError=!1},function(){a.postError=!0})["finally"](function(){a.isWorking=!1})):(a.isWorking=!1,a.errorList=h.errorText)};a.submit=function(b){b=_.filter(_.keys(b),function(a){return b[a]});a.submitList(b)};a.mainPageSocial={twitter:{text:"Get a job I love with a credential that fits into my life? Yes. Udacity Nanodegree programs, built by industry.",
url:"https://www.udacity.com/nanodegree"},facebook:{name:"Introducing Udacity Nanodegree Credentials",link:"https://www.udacity.com/nanodegree",caption:"Industry credentials for today's jobs in tech",description:"Stand out with tech skills that matter. Learn from the very best in industry. Study smart without leaving your current job."},gplus:{link:"https://www.udacity.com/nanodegree"}};_.each(["att","google","Cloudera","salesforcecorp","autodesk"],function(b){f.get(b).then(function(c){c&&c._image&&
(a.partnerImages[b]=c._image.serving_url)})})}]);angular.module("staticPages").controller("organizationPage",["$scope","validator","users",function(a,d,b){a.submitted=!1;a.errorList=null;a.postError=!1;a.isWorking=!1;a.showNoteField=!1;a.businessPartners=[{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/google_svg.svg",text:"Training developers globally, including Google employees, in Android, web, and cloud development techniques and best practices.",alt:"Google"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/att_svg.svg",
text:"Providing their employees with the tools to stay up to date in the latest technologies.",alt:"AT&T"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/ge_svg.svg",text:"Preparing emerging leaders with critical skills in areas like mobile, cloud and big data.",alt:"GE"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/capitalone_svg.svg",text:"Investing in existing employees to open up new technology career paths.",alt:"Capital One"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/accenture_svg.svg",
text:"Broadening the talent pipeline by pretraining candidates, including veterans.",alt:"Accenture"}];a.trainingGoals=[{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/industry.svg",text:"Developed and taught by experts from <br> Google, Facebook, and others.",title:"Industry created curriculum"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/nd_formula_2.svg",text:"Students develop skills by coding <br> and building a portfolio of demonstrable work.",title:"Project-based"},
{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/nd_formula_3.svg",text:"Coaches review code, answer questions, <br> and offer support along with peers in online forums.",title:"Coaching + peer support"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/nd_formula_1.svg",text:"10 hours/week. Any time. <br> Any location. Any device.",title:"Online & flexible"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/certificate.svg",text:"Dashboards let you monitor employee <br> progress and results.",
title:"Tracking & reporting"},{source:"//s3.amazonaws.com/content.udacity-data.com/site-svgs/section6.svg",text:"Students earn meaningful certifications <br> validated by rigorous coach evaluations.",title:"Verified certifications"}];a.toggleNote=function(){a.showNoteField=!a.showNoteField};a.businessDirection="left";a.goalsDirection="left";a.currentIndex=0;a.currentGoalsIndex=0;a.isCurrentSlideIndex=function(a,b){return b===a};a.prevSlide=function(a,b,d){b=b<a-1?++b:0;c("left",b,d)};a.nextSlide=
function(a,b,d){b=0<b?--b:a-1;c("right",b,d)};var c=function(b,c,d){switch(d){case "training":a.currentIndex=c;a.businessDirection=b;break;case "goals":a.currentGoalsIndex=c;a.goalsDirection=b;break;default:a.currentGoalsIndex=c,a.goalsDirection=b,a.currentIndex=c,a.businessDirection=b}};a.submit=function(){a.isWorking=!0;a.errorList=null;a.postError=!1;a.submitted=!1;var c;c=d.check({firstName:{pretty:"your first name",value:a.firstName,validators:[{type:"required"}]},lastName:{pretty:"your last name",
value:a.lastName,validators:[{type:"required"}]},companyName:{pretty:"your company name",value:a.companyName,validators:[{type:"required"}]},email:{pretty:"your email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]}});c.valid?(c={company_name:a.companyName,job_title:a.jobTitle,note:a.note},b.addToEmailList(a.firstName+" "+a.lastName,a.email,"enterprise-contacts",c).then(function(){a.submitted=!0;a.postError=!1;a.isWorking=!1},function(){a.postError=!0;a.isWorking=!1})):
(a.isWorking=!1,a.errorList=c.errorText)}}]).animation(".slide-animation",function(){return{beforeAddClass:function(a,d,b){var c=a.scope(),e="";c.business?e=c.$parent.businessDirection:c.item&&(e=c.$parent.goalsDirection);"ng-hide"==d?(d=a.parent().width(),"right"!==e&&(d=-d),TweenMax.to(a,0.5,{left:d,onComplete:b})):b()},removeClass:function(a,d,b){var c=a.scope();"ng-hide"==d?(a.removeClass("ng-hide"),d="",c.business?d=c.$parent.businessDirection:c.item&&(d=c.$parent.goalsDirection),c=a.parent().width(),
"right"===d&&(c=-c),TweenMax.fromTo(a,0.5,{left:c},{left:0,onComplete:b})):b()}}});angular.module("staticPages").controller("proctoredExamPage",["$scope","exams","$window",function(a,d,b){a.passedPasswordCheck=!1;a.isFetching=!1;a.convertTime=function(a){if(!a||"number"!==typeof a)return"No time has been set";var b=Math.floor(a/60),d=Math.floor(a/3600),g=Math.floor(a%3600/60),h=Math.floor(a%60),i=[];1===d&&(i+=d+" hour ");1<d&&(i+=d+" hours ");1===g&&(i+=g+" minute ");1<g&&(i+=g+" minutes ");1===h&&(i+=h+" second ");1<h&&(i+=h+" seconds ");return i=1===b?i+"(1 minute)":i+("("+Math.floor(a/
60)+" minutes)")};a.fetchExamDetails=function(b){a.isFetching=!0;a.processingResult="";d.get(b).then(function(b){a.isFetching=!1;null===b.exam_bank?(a.processingResult="Please check the password and try again.",a.examPassword=null):(a.passedPasswordCheck=!0,a.exam={timeLimit:a.convertTime(b.exam_variant.time_allotted),instructions:b.exam_bank.instructions,name:b.exam_bank.title})},function(){a.isFetching=!1;a.processingResult="Please check the password and try again."})};a.reset=function(){a.processingResult=
"";a.examPassword=null;a.passedPasswordCheck=!1};a.beginExam=function(c){a.isFetching=!0;a.processingResult="";d.startExamTimer(c).then(function(c){a._url="/course/exam#!/c-"+c.course_key+"/l-"+c.exam_node_keys;b.location.href=a._url},function(b){a.isFetching=!1;a.processingResult=403===b.status?'You are not permitted to take the exam "'+a.exam.name+'". Please check the exam title is correct for your course. If it is not, ask the proctor to check the password entered for the exam. If it is, please contact proctoredexams@udacity.com immediately.':
500===b.status&&b.data.error.match(/has already taken/)?"It looks like you've already taken this exam. Please contact proctoredexams@udacity.com immediately.":"There was an error. Please try again. If the problem persists, please contact proctoredexams@udacity.com immediately."})}}]);angular.module("staticPages").controller("projectNameLoader",["$scope","nodes",function(a,d){a.fetchProjects=function(b){return d.batchGet(b).then(function(c){a.projects=_.without(_.map(b,function(a){return c&&c[a]?{courseLink:"/course/"+encodeURIComponent(a),courseTitle:c[a].title,projectTitle:c[a].catalog_entry&&c[a].catalog_entry.paid_class?c[a].catalog_entry.paid_class.project_name:null}:null}),null);return a.projects})};a.fetchProjects(["cs101","ud359","ud032"])}]);angular.module("staticPages").controller("appCtrl",["$scope",function(a){a.toggle=!0}]).animation(".text-swap-animation",function(){var a;return{enter:function(d,b){d.css("opacity",0);a=jQuery(d).height();d.css("height",0);jQuery(d).animate({opacity:1,height:a},b)},leave:function(d,b){d.css("opacity",1);d.css("height",a);jQuery(d).animate({opacity:0,height:0},b)},move:function(a,b){jQuery(a).css({opacity:0.5});jQuery(a).animate({opacity:1},b)}}});angular.module("staticPages").controller("veteransPageController",["$scope","$filter","$window","currentUser","users","validator",function(a,d,b,c,e,f){a.submitted=!1;a.errorList=[];a.postError=!1;a.isWorking=!1;a.email=c.getEmail();a.submit=function(){a.isWorking=!0;a.errorList=null;a.postError=!1;a.submitted=!1;var b;b=f.check({"First Name":{pretty:"your first name",value:a.firstName,validators:[{type:"required"}]},"Last Name":{pretty:"your last name",value:a.lastName,validators:[{type:"required"}]},
Email:{pretty:"your email address",value:a.email,validators:[{type:"required",chained:[{type:"email"}]}]}});if(b.valid){var c=a.firstName+" "+a.lastName;b={name:c,branch:a.branch,is_vet_or_active:a.isMilitary?"true":"false"};e.addToEmailList(c,a.email,"veteran-interest",b).then(function(){a.submitted=!0;a.postError=!1},function(){a.postError=!0})["finally"](function(){a.isWorking=!1})}else a.isWorking=!1,a.errorList=b.errorText}}]);angular.module("tasks").factory("task",["$q",function(a){return{make:function(d){var b=a.defer(),c=a.defer(),e=a.when(!0),f={running:!1,ready:!0,done:!1,canceled:!1,start:function(){if(!f.ready||f.done)return!1;f.running=!0;a.when(d(f))["finally"](function(){f.done=!0;f.running=!1}).then(function(a){b.resolve(a)},function(a){b.reject(a)},function(a){b.notify(a)});return f},then:b.promise.then,"finally":b.promise["finally"],notify:function(a){b.promise.then(void 0,void 0,a)},after:function(b){if(f.running)return a.reject(a.when("Task already running!"));
f.ready=!1;var d=e.then(function(){return b},function(){return a.reject(b)})["finally"](function(){e===d&&(f.ready=!0,c.notify(!0))});e=d;return f},readyNotification:function(a){return c.promise.then(void 0,void 0,a)},name:function(a){f.name=a;return f},resetName:function(a){f.name=a;return f},cancel:function(){f.canceled=!0}};return f}}}]);angular.module("tasks").directive("taskProgress",[function(){return{restrict:"A",template:'<button class="btn btn-mini btn-danger" data-ng-click="cancel()"><span class="glyphicon glyphicon-remove"></span></button>{{task.name}}<progress value="{{loaded}}" max="{{total}}"> Progressing</progress>',scope:{task:"="},link:function(a){a.task.notify(function(d){a.loaded=d.loaded;a.total=d.total});a.cancel=function(){a.task.cancel()}}}}]);angular.module("tasks").factory("queue",["$q","$timeout","task",function(a,d,b){var c,a=function(a,b){return c(a,b)};a.LOW_PRIORITY=1;a.MEDIUM_PRIORITY=5;a.HIGH_PRIORITY=10;a.DEFAULT_PRIORITY=5;a.make=function(a,c){var g={maxConcurrent:c||10,running:[],pending:[],newTask:function(a,c){var d=b.make(a);d.priority=c||g.DEFAULT_PRIORITY;return g.enqueueTask(d)},newUniqueTask:function(a,c,d){var e=_.findWhere(g.running,{key:c})||_.findWhere(g.pending,{key:c});if(e)return e;a=b.make(a);a.priority=d||g.DEFAULT_PRIORITY;
a.key=c;return g.enqueueTask(a)},getUniqueTask:function(a){return _.findWhere(g.running,{key:a})||_.findWhere(g.pending,{key:a})},enqueueTask:function(a){a.priority=a.priority||g.DEFAULT_PRIORITY;g.pending.splice(_.sortedIndex(g.pending,a,"priority"),0,a);d(g.run);return a},run:function(){g.running=_.reject(g.running,function(a){return a.done});for(var a=g.running.length,b,c=0;c<g.maxConcurrent-a;c++){b=null;for(var e=g.pending.length-1;0<=e;e--)if(g.pending[e].ready){b=g.pending[e];break}else void 0!==
g.pending[e]&&g.pending[e].readyNotification(g.run);if(null!==b)g.pending=_.without(g.pending,b),b["finally"](g.run),g.running.push(b),d(b.start);else break}}};return g};c=a.make;return a}]);angular.module("user").factory("currentUser",["$log","$q","$rootScope","users","basicUser","gaqHelper","nodes","nodeUtility","userUtility","cohortsGateway","universalAnalytics",function(a,d,b,c,e,f,g,h,i,k,l){var j=angular.copy(e),m={get:function(a){return j[a]},getUser:function(){return j},getFullName:function(){return i.getFullName(j)},isStaff:function(){if(j._memberships)return 0<_.filter(j._memberships,function(a){return-1<a.group_ref.key.indexOf("staff")}).length},getEnrolledCourses:function(){return _.chain(m.get("_enrollments")).filter(function(a){if(a&&
"enrolled"===a.state)return!0}).map(function(a){return a.node_key}).value()},getEnrolledNanodegreeKeys:function(){return _.filter(m.getEnrolledCourses(),function(a){return 0===a.indexOf("nd")})},fetchGraduatedNanodegreeKeys:function(){return m.fetchCertificates().then(function(a){return _.chain(a).map(function(a){return a.node_ref.key}).filter(function(a){return 0===a.indexOf("nd")}).value()})},fetchEnrolledAndGraduatedNanodegreeKeys:function(){return m.fetchGraduatedNanodegreeKeys().then(function(a){return _.union(m.getEnrolledNanodegreeKeys(),
a)})},getGroupKeys:function(){return _.chain(m.get("_memberships")).filter(function(a){return a.group_ref&&"Group"===a.group_ref.ref}).map(function(a){return a.group_ref.key}).value()},getEmail:function(){return i.getEmail(j)},setUser:function(a){angular.copy(angular.copy(a),j)},fetchFullUser:function(a){a=a?{cacheBust:Math.random()}:{};return c.get("me",a).then(function(a){m.setUser(a);return a})},fetchCertificates:function(){return j._certificates?d.when(j._certificates):c.getCertificates("me").then(function(a){return j._certificates=
a})},checkIfFirstChatVisit:function(){return c.checkIfFirstChatVisit("me")},setFirstChatVisit:function(){return c.setFirstChatVisit("me")},fetchCohorts:function(){return m.fetchFullUser().then(function(a){return d.all(_.map(a._cohort_keys,function(a){return k.get(a)}))},function(b){a.error(b)})},userIsLoggedIn:function(){return j._registered},isEnrolledIn:function(a){return _.some(j._enrollments,function(b){return b.node_key===a&&"enrolled"===b.state})},isEnrolledForCreditIn:function(a){var b=["151101088",
"150207572","151148782","151059885","151254701"];return void 0!==_.find(j._enrollments,function(c){var d=_.pluck(c.group_refs,"key");return c.node_key===a&&"enrolled"===c.state&&0<_.intersection(d,b).length})},isCourseEmailSubscribed:function(a){return 0<_.filter(j._enrollments,function(b){return b.node_key===a&&b.email_ok}).length},enroll:function(a,d,e){d=d||"enrolled";return c.setEnrollments("me",[a],d).then(function(a){j._enrollments=j._enrollments||[];_.each(a,function(a){var b=_.find(j._enrollments,
function(b){return b.node_key===a.node_key});b?j._enrollments[_.indexOf(j._enrollments,b)]=a:j._enrollments.push(a)});if(1===a.length){b.$broadcast("modifiedEnrollment",a);var c=d.slice(0,1).toUpperCase()+d.slice(1,-2),g=f.pushTrackingEvent("Enrollment",c,a[0].node_key);l.trackEvent({category:"Enrollment",action:c,label:a[0].node_key});return e?g.then(function(){return a},function(){console.warn("Failed to push enrollment to Google Analytics");return a}):a}return a})},changeEnrollmentSettings:function(a,
b){return c.changeEnrollmentSettings(a,"me",b)},getEnrollmentsWithState:function(a){return _.filter(j._enrollments,function(b){return b.state===a})},setTag:function(a,b){var e=m.get("tags");if(_.findWhere(e,{namespace:a,tag:b}))return d.when(e);var f=e.concat([{namespace:a,tag:b}]);j.tags=f;return c.put({key:m.get("key"),tags:f}).catch(function(a){j.tags=e;return d.reject(a)})},removeTag:function(a,b){var e=m.get("tags");if(!_.findWhere(e,{namespace:a,tag:b}))return d.when(e);var f=_.reject(e,function(c){return c.namespace===
a&&c.tag===b});j.tags=f;return c.put({key:m.get("key"),tags:f}).catch(function(a){j.tags=e;return d.reject(a)})},isNanodegreeStudent:function(){return Boolean(_.find(j._enrollments,function(a){return"nd"===a.node_key.slice(0,2)}))}};return m}]);angular.module("user").directive("userMenu",["currentUser","session",function(a,d){return{restrict:"A",controller:["$scope",function(){}],link:function(b){b.isLoggedIn=a.userIsLoggedIn;b.user=a.getUser;b.isNanodegreeStudent=a.isNanodegreeStudent();b.logOut=function(){d.terminate().then(function(){window.location.reload()})}}}}]);angular.module("user").factory("userUtility",[function(){return{getFullName:function(a){if(a)return a.first_name&&a.last_name?a.first_name+" "+a.last_name:a.first_name||a.last_name},getEmail:function(a){return a.email&&a.email.address}}}]);angular.module("utility").directive("animatedToggle",function(){return{restrict:"A",link:function(a,d,b){b.toggleTarget||console.error("You must provide a toggle-target with a selector for the child element to toggle");b.toggler||console.error("You must provide an element to trigger the toggle");var c=d.find(b.toggleTarget),a=d.find(b.toggler);c||console.error("Element to toggle ("+b.toggleTarget+") not found!");a||console.error("Element to trigger toggle ("+b.toggler+") not found!");$(a).on("click",
function(){$(c).toggle("fast")});window.location.hash.substring(1)===a.attr("id")?$(c).show():$(c).hide()}}});angular.module("utility").service("applicationEnvironment",["$location",function(a){var d=/(abcinth)|(localhost)/;return{isInDevelopment:function(){return d.test(a.absUrl())}}}]);angular.module("utility").factory("callbackList",function(){return{create:function(){var a=[],d,b=!1,c={add:function(e,f,g){a.push(e);b&&f?(e(d),g&&c.remove(e)):g&&(e._removeOnFire=!0);return c},remove:function(b){for(var d=a.length,g=0;g<d;g++)a[g]===b&&(a.splice(g,1),g-=1);return c},fire:function(e){var f,g=_.clone(a),h=g.length;for(f=0;f<h;f++)try{g[f](e)}catch(i){console.error("Exception encountered in callback:"+i.message),console.error(g[f])}d=e;b=!0;for(f=0;f<a.length;f++)!0===a[f]._removeOnFire&&
(c.remove(a[f]),f-=1);return c},_getCallbacks:function(){return a}};return c}}});angular.module("utility").controller("contentEditorUrlGenerator",["$scope","$location",function(a,d){a.getContentEditUrl=function(){return"/admin/tools/content-editor#!"+d.path()}}]);angular.module("utility").factory("cookieJar",[function(){var a=function(a,c,d,f){a=encodeURIComponent(a)+"="+(d?encodeURIComponent(c):c);angular.isObject(f)&&(angular.isDate(f.expires)&&(a+="; expires="+f.expires.toUTCString()),angular.isString(f.path)&&""!==f.path&&(a+="; path="+f.path),angular.isString(f.domain)&&""!==f.domain&&(a+="; domain="+f.domain),!0===f.secure&&(a+="; secure"));return a},d=function(a,c){var d={};if(angular.isString(a)&&0<a.length)for(var f=a.split(/;\s/g),g=null,h=null,
i=null,k=0,l=f.length;k<l;k++){i=f[k].match(/([^=]+)=/i);if(angular.isArray(i))try{g=decodeURIComponent(i[1]),h=!1===c?f[k].substring(i[1].length+1):decodeURIComponent(f[k].substring(i[1].length+1))}catch(j){}else g=decodeURIComponent(f[k]),h="";d[g]=h}return d};return{exists:function(a){if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.exists(): Cookie name must be a non-empty string.");return d(document.cookie,!0).hasOwnProperty(a)},get:function(a,c){var c=angular.isObject(c)?c:{},
e=d(document.cookie,!c.raw);if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.get(): Cookie name must be a non-empty string.");return angular.isUndefined(e[a])?null:angular.isFunction(c.converter)?c.converter(e[a]):e[a]},getSub:function(a,c,d){a=this.getSubs(a);if(null!==a){if(!angular.isString(c)||""===c)throw new TypeError("$cookieJar.getSub(): Subcookie name must be a non-empty string.");return angular.isUndefined(a[c])?null:angular.isFunction(d)?d(a[c]):a[c]}return null},getSubs:function(a){if(!angular.isString(a)||
""===a)throw new TypeError("$cookieJar.getSubs(): Cookie name must be a non-empty string.");var c=d(document.cookie,!1);if(angular.isString(c[a])){var e=c[a],a=e.split("&"),c=null,f={};if(0<e.length)for(var e=0,g=a.length;e<g;e++)c=a[e].split("="),f[decodeURIComponent(c[0])]=decodeURIComponent(c[1]);return f}return null},remove:function(a,c){if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.remove(): Cookie name must be a non-empty string.");c=_.extend(c||{},{expires:new Date(0)},!0);
return this.set(a,"",c)},removeSub:function(a,c,d){d=d||{};if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.removeSub(): Cookie name must be a non-empty string.");if(!angular.isString(c)||""===c)throw new TypeError("$cookieJar.removeSub(): Subcookie name must be a non-empty string.");var f=this.getSubs(a);if(angular.isObject(f)&&f.hasOwnProperty(c)){delete f[c];if(d.removeIfEmpty){for(var g in f)if(f.hasOwnProperty(g)&&!angular.isFunction(f[g])&&!angular.isUndefined(f[g]))return this.setSubs(a,
f,d);return this.remove(a,d)}return this.setSubs(a,f,d)}return""},set:function(b,c,d){d=d||{};if(!angular.isString(b))throw new TypeError("$cookieJar.set(): Cookie name must be a string.");if(angular.isUndefined(c))throw new TypeError("$cookieJar.set(): Value cannot be undefined.");b=a(b,c,!d.raw,d);return document.cookie=b},setSub:function(a,c,d,f){if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.setSub(): Cookie name must be a non-empty string.");if(!angular.isString(c)||""===c)throw new TypeError("$cookieJar.setSub(): Subcookie name must be a non-empty string.");
if(angular.isUndefined(d))throw new TypeError("$cookieJar.setSub(): Subcookie value cannot be undefined.");var g=this.getSubs(a),g=angular.isObject(g)?g:{};g[c]=d;return this.setSubs(a,g,f)},setSubs:function(b,c,d){if(!angular.isString(b))throw new TypeError("$cookieJar.setSubs(): Cookie name must be a string.");if(!angular.isObject(c))throw new TypeError("$cookieJar.setSubs(): Cookie value must be an object.");if(!angular.isObject(c))throw new TypeError("createCookieHashString(): Argument must be an object.");
var f=[],g;for(g in c)c.hasOwnProperty(g)&&(!angular.isFunction(c[g])&&!angular.isUndefined(c[g]))&&f.push(encodeURIComponent(g)+"="+encodeURIComponent(String(c[g])));c=f.join("&");b=a(b,c,!1,d);return document.cookie=b}}}]);angular.module("utility").service("country",[function(){return{countries:"Afghanistan;Aland Islands;Albania;Algeria;American Samoa;Andorra;Angola;Anguilla;Antarctica;Antigua And Barbuda;Argentina;Armenia;Aruba;Australia;Austria;Azerbaijan;Bahamas;Bahrain;Bangladesh;Barbados;Belarus;Belgium;Belize;Benin;Bermuda;Bhutan;Bolivia, Plurinational State of;Bonaire, Sint Eustatius and Saba;Bosnia and Herzegovina;Botswana;Bouvet Island;Brazil;British Indian Ocean Territory;Brunei Darussalam;Bulgaria;Burkina Faso;Burundi;Cambodia;Cameroon;Canada;Cape Verde;Cayman Islands;Central African Republic;Chad;Chile;China;Christmas Island;Cocos (Keeling) Islands;Colombia;Comoros;Congo;Congo, the Democratic Republic of the;Cook Islands;Costa Rica;Cote d'Ivoire;Croatia;Cuba;Cyprus;Czech Republic;Denmark;Djibouti;Dominica;Dominican Republic;Ecuador;Egypt;El Salvador;Equatorial Guinea;Eritrea;Estonia;Ethiopia;Falkland Islands (Malvinas);Faroe Islands;Fiji;Finland;France;French Guiana;French Polynesia;French Southern Territories;Gabon;Gambia;Georgia;Germany;Ghana;Gibraltar;Greece;Greenland;Grenada;Guadeloupe;Guam;Guatemala;Guernsey;Guinea;Guinea-Bissau;Guyana;Haiti;Heard Island and McDonald Islands;Holy See (Vatican City State);Honduras;Hong Kong;Hungary;Iceland;India;Indonesia;Iran, Islamic Republic of;Iraq;Ireland;Isle of Man;Israel;Italy;Jamaica;Japan;Jersey;Jordan;Kazakhstan;Kenya;Kiribati;Korea, Democratic People's Republic of;Korea, Republic of;Kuwait;Kyrgyzstan;Lao People's Democratic Republic;Latvia;Lebanon;Lesotho;Liberia;Libya;Liechtenstein;Lithuania;Luxembourg;Macao;Macedonia, The Former Yugoslav Republic Of;Madagascar;Malawi;Malaysia;Maldives;Mali;Malta;Marshall Islands;Martinique;Mauritania;Mauritius;Mayotte;Mexico;Micronesia, Federated States of;Moldova, Republic of;Monaco;Mongolia;Montenegro;Montserrat;Morocco;Mozambique;Myanmar;Namibia;Nauru;Nepal;Netherlands;New Caledonia;New Zealand;Nicaragua;Niger;Nigeria;Niue;Norfolk Island;Northern Mariana Islands;Norway;Oman;Pakistan;Palau;Palestinian Territory, Occupied;Panama;Papua New Guinea;Paraguay;Peru;Philippines;Pitcairn;Poland;Portugal;Puerto Rico;Qatar;Reunion;Romania;Russian Federation;Rwanda;Saint Barthelemy;Saint Helena, Ascension and Tristan da Cunha;Saint Kitts and Nevis;Saint Lucia;Saint Martin (French Part);Saint Pierre and Miquelon;Saint Vincent and the Grenadines;Samoa;San Marino;Sao Tome and Principe;Saudi Arabia;Senegal;Serbia;Seychelles;Sierra Leone;Singapore;Sint Maarten (Dutch Part);Slovakia;Slovenia;Solomon Islands;Somalia;South Africa;South Georgia and the South Sandwich Islands;South Sudan;Spain;Sri Lanka;Sudan;Suriname;Svalbard and Jan Mayen;Swaziland;Sweden;Switzerland;Syrian Arab Republic;Taiwan, Province of China;Tajikistan;Tanzania, United Republic of;Thailand;Timor-Leste;Togo;Tokelau;Tonga;Trinidad and Tobago;Tunisia;Turkey;Turkmenistan;Turks and Caicos Islands;Tuvalu;Uganda;Ukraine;United Arab Emirates;United Kingdom;United States;United States Minor Outlying Islands;Uruguay;Uzbekistan;Vanuatu;Venezuela, Bolivarian Republic of;Viet Nam;Virgin Islands, British;Virgin Islands, U.S.;Wallis and Futuna;Western Sahara;Yemen;Zambia;Zimbabwe".split(";")}}]);angular.module("utility").factory("dateTime",["$filter",function(a){var d=null,b={initialize:function(a){d=(new Date).getTime()-a},convertDateToUTC:function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())},getCurrent:function(){return new Date(b._getActualMillisecondsSinceEpoch())},getCurrentAsUTC:function(){var c=b.convertDateToUTC(new Date(b._getActualMillisecondsSinceEpoch()));return a("date")(c,"yyyy-MM-ddTHH:mm:ss.000")+
"Z"},calculateDaysBetweenDates:function(a,b){return Math.abs((b.getTime()-a.getTime())/864E5)},_getActualMillisecondsSinceEpoch:function(){return(new Date).getTime()-d}};return b}]);angular.module("utility").factory("fetchDiscourseLink",["$q","currentUser",function(a,d){var b=null,c=function(c){b||(b=a.defer(),d.fetchCohorts().then(function(a){var d=null;_.each(a,function(a){_.contains(_.union(a._course_keys,[a.node_key]),c)&&(d?b.resolve("http://discussions.udacity.com/categories"):d="http://discussions.udacity.com/c/"+a.forum_slug)});1===a.length&&(d="http://discussions.udacity.com/c/"+_.first(a).forum_slug);b.resolve(d?d:"http://discussions.udacity.com/categories")}));return b.promise};
c._FALLBACK_URL="http://discussions.udacity.com/categories";return c}]);angular.module("utility").directive("filePicker",[function(){return{require:"ngModel",scope:{buttonLabel:"=?"},template:'<span class="btn btn-default file-picker">{{buttonLabel || \'Choose File\'}}<input type="file" class="input-control-file"></span>',link:function(a,d,b,c){c.render=angular.noop;d.find("input").on("change",function(b){c.$setViewValue(_.first(b.target.files));a.$apply()})}}}]);angular.module("utility").service("fileQueue",["queue","api","$q",function(a,d,b){var c={uploadQueue:a("fileUpload"),blobStoreUploadTask:function(a,b,g){return c.fileUploadTask(d.get(a+"/upload_url").then(function(a){return a.data.url}),b,g)},fileUploadTask:function(d,f,g){return c.uploadQueue.newUniqueTask(function(a){var c=b.defer(),g=new XMLHttpRequest;g.onreadystatechange=function(){if(4===g.readyState)if(200===g.status){var a=JSON.parse(g.response.slice(5));c.resolve(a)}else c.reject(g.response&&
JSON.parse(g.response.slice(5)))};g.upload.addEventListener("progress",function(b){c.notify(b);a.canceled&&g.abort()},!1);b.when(d).then(function(a){g.open("POST",a,!0);g.setRequestHeader("X-XSRF-Token",document.cookie.match(/(^|; *)XSRF-TOKEN=(.*?)(;|$)/)[2]);a=new FormData;a.append("file",f);g.send(a)},function(a){c.reject(a)});return c.promise},d,a.LOW_PRIORITY).name(g||"File upload to "+d)}};return c}]);angular.module("utility").factory("gaqHelper",["$q",function(a){var d=function(){var b=a.defer();_gaq.push(["_set","hitCallback",function(){b.resolve(!0)}]);return b.promise};return{pushTrackingEvent:function(a,c,e,f){var g=d();_gaq.push(["_trackEvent",a,c,e,f]);return g},pushPageviewEvent:function(a){var c=d();_gaq.push(["_trackPageview",a||location.pathname+location.search+location.hash]);return c}}}]);angular.module("utility").factory("googleTagManager",["$q",function(a){return{pushTrackingEvent:function(d,b){var c=a.defer();window.dataLayer?(b=b||{},b.event=d,b.eventCallback=function(){c.resolve(!0)},window.dataLayer.push(b)):c.resolve(!0);return c.promise}}}]);angular.module("utility").factory("libraryLoader",["$q","$rootScope","$timeout","cacheVersion",function(a,d,b,c){var e={codemirror:"/media/js/standalone/libs/codemirror/codemirror-custom.min.js",mathquill:"/media/js/standalone/libs/mathquill.min.js?"+c,jshint:"/media/js/standalone/libs/jshint/jshint-1.0.0.min.js",base64:"/media/js/standalone/libs/base64.js"},f={},g={loadLibraries:function(b){return a.all(_.map(b,function(a){return g._fetchLibrary(a)}))},_fetchLibrary:function(c){var d=e[c]?e[c]:c,
g=a.defer();if(f[c])return f[c];f[c]=g.promise;jQuery.ajax({dataType:"script",cache:!0,url:d}).success(function(){b(function(){g.resolve()})}).error(function(){b(function(){g.reject()})});return g.promise},_addLibrary:function(a,b){e[a]=b}};return g}]);angular.module("utility").service("mixin",["callbackList",function(a){return{eventEmission:function(d,b){var c=_.object(_.map(b,function(b){return[b,a.create()]}));if(!_.isArray(b)||!_.all(b,function(a){return _.isString(a)}))throw"eventNames must be an array of strings";if(!_.isObject(d))throw"targetObject must be an object to mix into";var e=function(a,b,e){if(c[a])e();else throw b;return d};if(_.intersection(_.keys(d),["addEventListener","removeEventListener","emitEvent"]).length)throw"Can't add event methods--they already exist!";
d.addEventListener=function(a,b,h){var h=h||{},i=_.without(_.keys(h),"replayLast","removeOnDestructionOf","removeAfterFired");if(i.length)throw Error("Unsupported options "+i+" when adding event listener");return e(a,'Cannot listen for non-emitted event "'+a+'"',function(){if(!_.isFunction(b))throw Error('You must provide a callback to run when the "'+a+'" event is emitted');c[a].add(b,h.replayLast,h.removeAfterFired);_.isObject(h.removeOnDestructionOf)&&h.removeOnDestructionOf.$on&&h.removeOnDestructionOf.$on("$destroy",
function(){d.removeEventListener(a,b)})})};d.removeEventListener=function(a,b){return e(a,'Cannot remove listener from non-emitted event "'+a+'"',function(){c[a].remove(b)})};d.emitEvent=function(a,b){return e(a,"Cannot emit invalid event "+a+". Add to exposed events when mixing in.",function(){if(void 0===b||null===b)b={};c[a].fire(b)})};return d}}}]);angular.module("utility").service("notifications",["$document","$window",function(a,d){var b="default",c=function(){Notification&&Notification.requestPermission(function(a){b=a})},e={};c();return{getNotificationPermissions:function(){return b},createNotification:function(c,g,h){"granted"===b&&("noisy"===e[c]&&a[0].hidden)&&((new Notification(g,{body:h,icon:"//lh4.ggpht.com/9aWgWwryYb9oBUJxLwgS_7PVb6R_eXHB8amKSsHdQrtxEY6Hec-9AFwGFafb65fWakLvZ5il7f9QL1ONy_w=s0#w=120&h=120",tag:c})).onclick=function(){d.focus()})},
requestNotificationPermissions:function(){c()},registerNotificationCreator:function(a,b){b||(b="muted");e[a]=b},changeMuteSettings:function(a,b){e[a]=b},toggleMuteSettings:function(a){e[a]&&(e[a]="noisy"===e[a]?"muted":"noisy")},getMuteSettings:function(a){return e[a]}}}]);angular.module("utility").factory("optimizely",["$http",function(){window.optimizely=window.optimizely||[];return{activate:function(a){if(window.optimizely.push){var d=["activate"];a&&d.push(a);window.optimizely.push(d)}},push:function(a){window.optimizely.push&&window.optimizely.push(a)}}}]);angular.module("utility").factory("qualaroo",[function(){return{set:function(a){window._kiq.push&&window._kiq.push(["set",a])}}}]);angular.module("utility").factory("recordActivity",["$q","mixin","dateTime","api",function(a,d,b,c){var e={send:function(d,e){if(!_.isArray(d)&&!_.isObject(d))return console.error("recordActivity.send takes an object or list of objects"),a.reject("recordActivity.send takes an object or list of objects");_.isArray(d)||(d=[d]);var e=e||{},h={current_time:b.getCurrentAsUTC()};h.items=_.map(d,function(a){var c={data:a.data,occurrence_time:a.timestamp||e.timestamp||b.getCurrentAsUTC()};"undefined"!==typeof a.context&&
(c.content_context=_.without(a.context,null,void 0,"none"));return c});e.chain&&(h.related_chain=!0);return c.post("/activity",h).then(null,function(b){console.error("Error when trying to post activity."," Payload:",h," Chained:",e.chain," Response",b);return a.reject(b)})},experimentAssignment:function(a,b,c){return e.send([{data:{model:"ExperimentAssignment",experiment:a,treatment:b}}],c)},surveyResponse:function(a,b,c){return e.send([{data:{model:"SurveyResponse",survey_name:a,items:b}}],c)},observation:function(a,
b,c,d){return e.send([{data:{model:"Observation",observation_type:a,details_version:b,details:c}}],d)}};return d.eventEmission(e,["activity"])}]);angular.module("utility").directive("responsivenessEnabler",function(){return{controller:["$scope","$rootScope",function(a,d){d.$broadcast("setResponsiveness",!0)}]}});angular.module("utility").factory("retry",["$q","$timeout",function(a,d){var b=function(c,e,h){return c()["catch"](function(i){return 0<e?d(angular.noop,h).then(function(){return b(c,e-1,h)}):a.reject(i)})},c=function(b,e,h){return b()["catch"](function(i){return 0<e?d(angular.noop,h).then(function(){return c(b,e-1,2*h)}):a.reject(i)})},e=function(a,b,d){return c(a,b,d)};e.linear=b;e.falloff=c;return e}]);angular.module("utility").factory("safelyRedirect",[function(){var a=function(d){!d||"/"===d?a._changeLocation("/"):_.any([/^\/[^\/%]/,/^http[s]?:\/\/(?:[^.]+\.)?udacity\.com(?:\/|$)/i,/^http[s]?:\/\/(?:[^.]+\-dot\-)?(udacity\-abcinth|udacity\-dev|udacityu)\.appspot\.com(?:\/|$)/i,/^http[s]?:\/\/127\.\d+\.\d+\.\d+(?::\d+)?(?:\/|$)/i,/^http[s]?:\/\/?localhost(?::\d+)?(?:\/|$)/i],function(a){return a.test(d)||a.test(window.decodeURIComponent(d))})?a._changeLocation(d):(console.error("Invalid url to redirect to: "+
d),a._changeLocation("/"))};a._changeLocation=function(a){window.location.href=a};return a}]);angular.module("utility").factory("facebook",["$q","$timeout","$location","mixin","facebookHelper",function(a,d,b,c,e){e.loadApi().then(function(){f.emitEvent("loaded")});var f={feedShare:function(c){var h=a.defer();if("object"!==typeof c||_.isNull(c))return a.reject("feedShare requres an options object");c=_.extend({},c,{method:"feed"});c.picture&&"//"===c.picture.substring(0,2)&&(c.picture=b.protocol()+":"+c.picture);e.loadApi().then(function(){window.FB.ui(c,function(a){d(function(){_.isNull(a)?
h.reject("unshared cancel"):void 0===a?h.reject("unshared close"):a.error?h.reject(a):(f.emitEvent("feedShare",a),h.resolve(a))})})});return h.promise},getAuthResponse:function(){var b=a.defer();e.loadApi().then(function(){var a=window.FB.getAuthResponse();a?b.resolve(a):window.FB.login(function(a){a&&a.authResponse?b.resolve(a.authResponse):b.reject(a)},{scope:"email"})});return b.promise},getMeResponse:function(){var b=a.defer();e.loadApi().then(function(){window.FB.getLoginStatus(function(a){"connected"===
a.status?window.FB.api("/me",function(a){a.error?b.reject(a):b.resolve(a)}):(console.warn("tried to get me from FB but was not authd"),b.reject(a))})});return b.promise}};return c.eventEmission(f,["loaded","feedShare","like"])}]);
angular.module("utility").factory("facebookHelper",["$q","mixin","libraryLoader","$timeout",function(a,d,b,c){var e,f,d={_init:function(){e=a.defer();f=!1},loadApi:function(){!0!==f&&($("body").append('<div id="fb-root"></div>'),window.fbAsyncInit||(window.fbAsyncInit=function(){window.FB.init({appId:365362206864879,channelUrl:"//"+window.location.host+"/facebookChannel.html",status:!0,cookie:!0,xfbml:!0,version:"v2.2"});f=!0;e.resolve(!0)}),c(function(){b.loadLibraries(["//connect.facebook.net/en_US/sdk.js"]).then(null,
function(){console.warn("Facebook libraries failed to load!");e.reject("Facebook libraries failed to load!")})},100));return e.promise}};d._init();return d}]);angular.module("utility").directive("facebookShare",["facebook","$location",function(a,d){return{restrict:"A",scope:{facebookShare:"="},template:'<a href="" data-ng-class="classes" data-ng-click="share()" data-ng-transclude></a>',transclude:!0,replace:!0,link:function(b,c,e){b.classes=e["class"];b.share=function(){var c=b.facebookShare||{};c.link=c.link||d.absUrl();a.feedShare(c)}}}}]);angular.module("utility").factory("google",["$timeout","$q","mixin","googleHelper",function(a,d,b,c){var e=c.getConfig();c.loadApi().then(function(){f.emitEvent("loaded")});var f={getToken:function(b){var f=d.defer();"boolean"===typeof b||"undefined"===typeof b?(b=!0===b?!0:!1,c.loadApi().then(function(){window.gapi.auth.authorize(_.extend({response_type:"code",immediate:b},e),function(b){a(function(){b&&b.code?f.resolve(b):(console.warn("google.getToken failed to return a token!"),f.reject("google.getToken failed to return a token!"))})})})):
f.reject("Immediate must be boolean or undefined");return f.promise},getMeResponse:function(){var b=d.defer();c.loadApi().then(function(){window.gapi.auth.authorize(_.extend({immediate:!0},e),function(c){window.gapi.client.load("oauth2","v2",function(){window.gapi.client.oauth2.userinfo.get().execute(function(d){d.token=c;a(function(){"undefined"!==typeof d.error?b.reject(d):b.resolve(d)})})})})});return b.promise}};return b.eventEmission(f,["loaded"])}]);
angular.module("utility").factory("googleHelper",["$timeout","$q","$location","libraryLoader",function(a,d,b,c){var e,f,g={client_id:"72069832843-ji15b2fqekfntf5q1k9q0pboieao8hfa.apps.googleusercontent.com",scope:"profile email"},h={_init:function(){e=d.defer();f=!1;g.client_id="127.0.0.1"===b.host()?"72069832843-8m1i2jll4frcqge66a2be0utlbv8ij1h.apps.googleusercontent.com":"72069832843-ji15b2fqekfntf5q1k9q0pboieao8hfa.apps.googleusercontent.com"},_consts:function(){return{PROD_APP_ID:"72069832843-ji15b2fqekfntf5q1k9q0pboieao8hfa.apps.googleusercontent.com",
LOCAL_APP_ID:"72069832843-8m1i2jll4frcqge66a2be0utlbv8ij1h.apps.googleusercontent.com",CURRENT_APP_ID:g.client_id}},getConfig:function(){g.foo="bar";return _.clone(g)},loadApi:function(){!0!==f&&(window.__GFDGoogle||(window.__GFDGoogle=function(){window.gapi.auth.init(function(){a(function(){f=!0;e.resolve(!0)})})}),c.loadLibraries(["https://apis.google.com/js/client:platform.js?onload=__GFDGoogle"]).then(function(){},function(){console.warn("Google libraries failed to load!");e.reject("Google libraries failed to load!")}));
return e.promise}};h._init();return h}]);angular.module("utility").directive("googlePlusShare",["facebook","$location",function(a,d){return{restrict:"A",scope:{googlePlusShare:"="},template:'<a href="" data-ng-class="classes" data-ng-click="share()" ng-transclude></a>',transclude:!0,replace:!0,link:function(a,c,e){a.classes=e["class"];a.share=function(){window.open("https://plus.google.com/share?url="+window.encodeURIComponent(a.googlePlusShare.link||d.absUrl()))}}}}]);angular.module("utility").factory("normalizedSocialService",["facebook","google",function(a,d){return{normalizeAccountService:function(b){var c={},e=d;c.login=d.getToken;"facebook"===b&&(e=a,c.login=a.getAuthResponse);c.getAccount=e.getMeResponse;return c},normalizeAccount:function(a,c){"google"===a&&(c.firstName=c.given_name,c.lastName=c.family_name);"facebook"===a&&(c.firstName=c.first_name,c.lastName=c.last_name);return c},createSessionData:function(a,c){var d={};"google"===a?d.google={token:c.code}:
"facebook"===a?d.facebook={signed_request:c.signedRequest}:console.warn("normalized_socia_service.js:createSessionData got an accountTypethat is not facebook or google...is that right?");return d}}}]);angular.module("utility").directive("socialSharing",["$location","facebook",function(a,d){return{restrict:"A",template:'<p style="text-align:center; font-weight: bold; margin-bottom: 15px">Share your accomplishment!<br><a class="btn" style="min-width: 150px" data-ng-click="shareFacebook(course.title)"><span class="social-icon facebook" style="position: relative;left: -6px; vertical-align: middle;"></span>Facebook</a><a class="btn" style="min-width: 150px; margin-left: 10px;" data-tweet-link href data-tweet="{text: \'Just finished \'+lesson.title+\' in Udacity\\\'s \'+course.title, via: \'udacity\', url: locationToTweetFrom}"><span class="social-icon twitter" style="position: relative; left: -6px; vertical-align: middle;"></span>Twitter</a></p>',
link:function(b){b.locationToTweetFrom=a.absUrl();b.$on("$routeChangeSuccess",function(){b.locationToTweetFrom=a.absUrl()});b.shareFacebook=function(b){console.log("sharing!");b={link:a.absUrl(),picture:"https://lh4.ggpht.com/KmrVJFnjArFRMCXTnOxnQ9kG_o2Lllo1Q7S3Jq-UwXO_BQ5DondbistdOW8DpqXgJNNIeOUU0acX36LcXKU=s500-c#w=500&h=539",description:b+" is a full course available, 100% free, at udacity.com. Come learn with us!"};d.feedShare(b).then()}}}}]);angular.module("utility").directive("tweetLink",["twitter",function(a){return{restrict:"A",scope:{tweet:"="},template:'<a target="_blank" ng-class="attributes.class" ng-href="{{_tweetUrl}}" ng-transclude></a>',transclude:!0,replace:!0,link:function(d){d._tweetUrl=a.buildTweetUrl(d.tweet);d.$watch("tweet",function(b){b&&(d._tweetUrl=a.buildTweetUrl(b),a.reloadTwitterWidgets())},!0)}}}]);angular.module("utility").factory("twitter",["mixin","twitterHelper",function(a,d){window.twttr||(window.twttr={_e:[],ready:function(a){window.twttr._e.push(a)}},window.setTimeout(function(){var a=window,c;var d,f=document.getElementsByTagName("script")[0];document.getElementById("twitter-wjs")?c=void 0:(c=document.createElement("script"),c.id="twitter-wjs",c.src="https://platform.twitter.com/widgets.js",f.parentNode.insertBefore(c,f),c=window.twttr||(d={_e:[],ready:function(a){d._e.push(a)}}));a.twttr=
c},100));window.twttr.ready(function(a){a.events.bind("click",function(a){d.recordTweetEvent("tweetStart",a)});a.events.bind("tweet",function(a){d.recordTweetEvent("tweetSent",a)});a.events.bind("retweet",function(a){d.recordTweetEvent("retweetSent",a)})});return a.eventEmission({buildTweetUrl:function(a){var c=["url","text","via","in_reply_to","related"],d=[],f;"string"===typeof a?a={text:a}:_.isObject(a)||(a={});for(f=0;f<c.length;f++)"string"===typeof a[c[f]]&&""!==a[c[f]].trim()&&d.push(c[f]+
"="+encodeURIComponent(a[c[f]]));return"https://twitter.com/intent/tweet?"+d.join("&")},reloadTwitterWidgets:function(){window.twttr.widgets?window.twttr.widgets.load():window.twttr.ready(function(){window.twttr.widgets.load()})}},["tweet","retweet"])}]);angular.module("utility").factory("twitterHelper",["basicUser","recordActivity",function(a,d){return{recordTweetEvent:function(b,c){d.observation(b,1,{user:a.key,url:document.URL,triggerLink:c.target.href})}}}]);angular.module("utility").factory("techDetect",["mixin",function(a){var d,b,c=function(){b={browser:null,version:null,browserDim:null,cookies:null,flash:null,os:null,screenDim:null,screenColorDepth:null,ua:navigator.userAgent||"unspecified UA",lang:navigator.language||"unspecified language"}};c();var e=function(a){for(var b=0;b<a.length;b++){var c=a[b].string,e=a[b].prop;d=a[b].versionSearch||a[b].identity;if(c){if(-1!==c.indexOf(a[b].subString))return a[b].identity}else if(e)return a[b].identity}},
f=function(a){var b=a.indexOf(d);if(-1!==b)return parseFloat(a.substring(b+d.length+1))},g=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.userAgent,subString:"Safari",identity:"Safari",versionSearch:"Version"},{prop:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),identity:"UIWebView",versionSearch:"OS"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},
{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:navigator.userAgent,
subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],h=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.userAgent,subString:"iPod",identity:"iOS"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",
identity:"Linux"}],i=function(a){if(null===b.browser||a)b.browser=e(g)||"An unknown browser";return b.browser},k=function(a){if(null===b.version||a)i(),b.version=f(navigator.userAgent)||f(navigator.appVersion)||"an unknown version";return b.version},l=function(a){if(null===b.os||a)b.os=e(h)||"an unknown OS";return b.os},j=function(a){if(null===b.cookies||a)document.cookie="cookietest=1",b.cookies=-1!==document.cookie.indexOf("cookietest="),document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT";
return b.cookies},m=function(a){if(null===b.flash||a)try{b.flash=!!(navigator.mimeTypes["application/x-shockwave-flash"]||window.ActiveXObject&&new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(c){b.flash=!1}return b.flash},p=function(a){if(null===b.browserDim||a)b.browserDim=[$(window).width(),$(window).height()];return b.browserDim},n=function(a){if(null===b.screenDim||a)b.screenDim=[screen.width,screen.height];return b.screenDim},r=function(a){if(null===b.screenColorDepth||a)b.screenColorDepth=
screen.colorDepth;return b.screenColorDepth};return a.eventEmission({browserSize:p,browserType:i,browserVersion:k,cookiesEnabled:j,flashEnabled:m,os:l,screenSize:n,screenColorDepth:r,ua:function(){return b.ua},language:function(){return b.lang},flushCache:c,browserStats:function(a){return{browser:i(a),version:k(a),os:l(a)}},getAllTech:function(a){a=!!a;i(a);k(a);l(a);j(a);m(a);p(a);n(a);r(a);return b}},["browserDetected"])}]);angular.module("utility").factory("universalAnalytics",["googleTagManager",function(a){return{trackEvent:function(d,b){return a.pushTrackingEvent(!1!==b?"uaEvent":"uaNonHitEvent",{uaEventCategory:d.category,uaEventAction:d.action,uaEventLabel:d.label,uaEventValue:d.value})},trackTiming:function(d){(!d.var||!d.category||!d.label)&&console.error("Missing field in UA track timing event. Provided fields:",d);return a.pushTrackingEvent("uaTrackTimingEvent",{uaEventVarName:d.var,uaEventCategory:d.category,
uaEventLabel:d.label,uaEventValue:d.value})},trackTransaction:function(d){(!d.transactionId||!_.has(d,"transactionTotal"))&&console.error("Missing field in UA transaction event. Provided fields:",d);d.transactionProducts&&0<d.transactionProducts.length&&_.any(d.transactionProducts,function(a){return!a.name||!_.has(a,"sku")||!_.has(a,"price")||!a.quantity})&&console.error("Missing field in product for UA transaction event Provided products:",d.transactionProducts);return a.pushTrackingEvent("uaTransaction",
d)},trackVirtualPageView:function(d,b){return a.pushTrackingEvent("uaVirtualPageView",{uaEventPageUrl:d||location.pathname+location.search+location.hash,uaEventPageTitle:b||window.document.title})}}}]);angular.module("utility").factory("userTrials",["mixin","currentUser","recordActivity","userTrialsHelper",function(a,d,b,c){var e={enroll:function(a,g){if("string"!==typeof a||"string"!==typeof g||""===a.trim()||""===g.trim())console.error("Trial key and treatment must both be non-empty strings.");else{var h=c.getEnrollments(d.get("key"));h[a]=g;c.saveEnrollments(d.get("key"),h);b.experimentAssignment(a,g);e.emitEvent("enrollment",{trial:a,treatment:g})}},unenroll:function(a){if("string"!==typeof a||
""===a.trim())console.error("Trial key must be a non-empty string.");else{var b=c.getEnrollments(d.get("key")),h=b[a]||null;null!==h?(delete b[a],c.saveEnrollments(d.get("key"),b),e.emitEvent("unenrollment",{trial:a,treatment:h})):console.warn("Tried to unenroll from "+a+" but wasn't enrolled in it!")}},getTreatment:function(a){return c.getEnrollments(d.get("key"))[a]||null},getOrEnrollManually:function(a,b,c){c=_.isArray(c)?c:[];if("string"!==typeof a||""===a.trim())return console.error("trialKey must be a non-empty string."),
null;if(_.isFunction(b)){var d=e.getTreatment(a);null===d&&(d=b.apply(void 0,c),e.enroll(a,d));return d}console.error("assignmentFn must be a function.");return null},getAllEnrollments:function(){return $.extend(!0,{},c.getEnrollments(d.get("key")))}};return a.eventEmission(e,["enrollment","unenrollment"])}]);
angular.module("utility").factory("userTrialsHelper",["cookieJar",function(a){return{getEnrollments:function(d){return"string"!==typeof d||""===d.trim()?(console.error("user key must be a non-empty string."),null):a.getSubs("trials-"+d)||{}},saveEnrollments:function(d,b){"string"!==typeof d||""===d.trim()?console.error("User key must be a non-empty string."):"object"!==typeof b||null===b?console.error("User trial enrolls must be objects."):a.setSubs("trials-"+d,b)}}}]);angular.module("utility").factory("validator",[function(){var a={valid:!0,errorText:""},d={noop:function(){return a},required:function(b,c){var d=!0;"undefined"===typeof b?d=!1:"boolean"===typeof b?d=b:"string"===typeof b?d=""!==b.replace(/^\s*(.*?)\s*$/,"$1"):null===b&&(d=!1);return d?a:{valid:!1,errorText:c+" is required."}},strLen:function(b,c,d){("string"!==typeof b||"string"!==typeof c||"object"!==typeof d||2!==d.length)&&console.error("Wrong parameters passed to strLen validator for "+c);var b=
b.length,f=d[0],d=d[1];if("number"===typeof f&&"number"===typeof d){if(f===d&&f!==b)return{valid:!1,errorText:c+" has to be exactly "+d+" characters long."};if(b<f||b>d)return{valid:!1,errorText:c+" has to be between "+f+" and "+d+" characters long."}}else{if("number"===typeof f&&b<f)return{valid:!1,errorText:c+" has to be at least "+f+(1===f?" character":" characters")+" long."};if("number"===typeof d&&b>d)return{valid:!1,errorText:c+" has to be "+(0===d?"zero characters":"fewer than "+(d+1)+" characters")+
" long."}}return a},numericString:function(b,c){return"string"!==typeof b?(console.error("The numericString evaluator can only take in a string! You tried "+typeof b),{valid:!1,errorText:"The numericString evaluator can only take in a string! You tried "+typeof b}):!/^[0-9]+$/.test(b)?{valid:!1,errorText:c+" can only be numeric characters."}:a},email:function(b,c){("string"!==typeof b||"string"!==typeof c)&&console.error("Wrong parameters passed to email validator for "+c);return/^[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?$/i.test(b)?
a:{valid:!1,errorText:c+" has to be a valid email address."}},equal:function(b,c,d){("string"!==typeof b&&"number"!==typeof b&&"boolean"!==typeof b||"object"!==typeof d||2!==d.length)&&console.error("Wrong parameters passed to equal validator for "+c);"string"!==typeof b&&("number"!==typeof b&&"boolean"!==typeof b)&&console.error('Validator "Equal" only works for strings, numbers, and booleans. Tried '+typeof b+" for "+c);return b===d[0]?a:{valid:!1,errorText:c+" and "+d[1]+" have to be the same."}},
javascript:function(b,c,d){var f=d[0],d=[b].concat(d.slice(1)),f=f.apply(void 0,d);return"boolean"!==typeof f?(console.error("Javascript evaluator types must return only boolean values! This one returned "+f),{valid:!1,errorText:"Validator for "+c+" should have returned a bool, but returned "+f}):f?a:{valid:!1,errorText:c+" failed validation with value "+b}},regex:function(b,c,d){return"object"!==typeof d[0]||!1===d[0]instanceof RegExp?(console.error("Regex evaluator types must have a regex value for arg[0] but got "+
d[0]),{valid:!1,errorText:"Validator for "+c+" should be called with regex as arg[0]"}):"string"!==typeof b?(console.error("Regex can only be called on a string! Tried to call it on "+b+" for "+c),{valid:!1,errorText:"Broken validator. Regex for "+c+" wasn't called on a string"}):b.match(d[0])?a:{valid:!1,errorText:c+" failed regex validation with value "+b}},dateString:function(b,c){var d={valid:!1,errorText:c+" must be a date of the format mm/dd/yyyy."},f=b.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2}|\d{4})$/);
if(null!==f){var g=+f[1],h=+f[3],f=new Date(h,g-1,+f[2]);return(""+f.getFullYear()).slice(-2)===(h+"").slice(-2)&&f.getMonth()===g-1?a:d}return d}};return{check:function(a){var c,e={valid:!0,errorText:{}},f,g;for(g in a)if(a.hasOwnProperty(g)){c=a[g];for(var h=0;h<c.validators.length;h++)if(f=c.validators[h],"undefined"===typeof f.disabled||!1===f.disabled)if("function"===typeof d[f.type]){var i=c.value,k=c.pretty||g,l=d[f.type](i,k,f.args||[]);l.valid?f.hasOwnProperty("chained")&&(l={},l[g]={pretty:k,
value:i,validators:f.chained},f=this.check(l),!1===f.valid&&(e.valid=!1,e.errorText[g]=e.errorText[g]||[],e.errorText[g]=e.errorText[g].concat(f.errorText[g]))):(e.valid=!1,e.errorText[g]=e.errorText[g]||[],e.errorText[g].push("undefined"===typeof f.failMsg?l.errorText.charAt(0).toUpperCase()+l.errorText.slice(1):f.failMsg))}else console.warn("You tried to use a validator that doesn't exist! The name you tried to use was: "+f.type)}return e}}}]);angular.module("viewer").controller("contentGate",["$scope","modal","currentUser","$location",function(a,d,b,c){a.signUpAndReturnToCourse=function(a){window.location.href="/account/auth#!/signup?next=%2Fcourse%2Fviewer%23!"+encodeURIComponent(c.path())+"&enroll="+encodeURIComponent(a)};a.signInAndReturnToCourse=function(a){window.location.href="/account/auth#!/signin?next=%2Fcourse%2Fviewer%23!"+encodeURIComponent(c.path())+"&enroll="+encodeURIComponent(a)};a.enrollInCourse=function(c){a.enrollRequestPending=
!0;b.enroll(c).then(function(){a.enrollRequestPending=!1;d.confirm()})}}]);angular.module("viewer").controller("imageQuizPanel",["$scope","lesson","imageQuiz","tidbits",function(a,d,b,c){a.attempts=0;a.correctlyAnswered=!1;a.status="unsubmitted";a.quizReturn=null;a.tidbitViewerMode="quiz-only";a.isTidbitAvailable=function(a){return a.completed||c.isTidbitRelevant(a,a.tidbit_ref.containingExercise.quiz_ref.binCodes)};a.isTidbitRelevant=function(b){return!a.isPlaying(b.tidbit_ref)&&a.quizReturn&&c.isTidbitRelevant(b,a.quizReturn.binCodes,!0)};a.isPlaying=function(b){return a.tidbit&&
b&&a.tidbit.key===b.key};a.submitQuiz=function(){b.submit()};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Submit Answer"};d.addEventListener("morselChange",function(){a.quizReturn=null;a.attempts=0;a.correctlyAnswered=!1;a.status="unsubmitted"},{replayLast:!0,removeOnDestructionOf:a});d.addEventListener("tidbitChange",function(b){a.tidbitViewerMode=c.getTidbitViewerMode(b.tidbit)},{replayLast:!0,removeOnDestructionOf:a});b.addEventListener("submitting",function(){a.status=
"processing";a.quizReturn=null});b.addEventListener("correct",function(b){a.attempts++;a.status="correct";a.correctlyAnswered=!0;a.quizReturn={status:"correct",text:b.comment,binCodes:b.binCodes}},{removeOnDestructionOf:a}).addEventListener("incorrect",function(b){a.attempts++;a.status="incorrect";a.quizReturn={status:"incorrect",text:b.comment,binCodes:b.binCodes}},{removeOnDestructionOf:a}).addEventListener("error",function(b){a.attempts++;a.status="error";a.quizReturn={status:"error",text:b.comment}},
{removeOnDestructionOf:a}).addEventListener("recorded",function(b){a.status="recorded";a.quizReturn={status:"recorded",text:b.comment}})}]);angular.module("viewer").controller("programmingQuizOutputPanel",["$scope","lesson","programmingQuiz","tidbits",function(a,d,b,c){a.status="unsubmitted";a.stdout=null;a.stderr=null;a.images=null;a.ready=!1;a.run=function(){b.run();a.status="processing";a.stdout=null;a.stderr=null;a.images=null};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Test Run"};a.reset=function(){window.confirm("Are you sure you want to reset to the original assignment stub?")&&b.reset()};d.addEventListener("morselChange",
function(){a.stdout=null;a.stderr=null;a.images=null;a.ready=!1;a.status="unsubmitted"},{replayLast:!0,removeOnDestructionOf:a});d.addEventListener("tidbitChange",function(b){a.tidbitViewerMode=c.getTidbitViewerMode(b.tidbit)},{replayLast:!0,removeOnDestructionOf:a});b.addEventListener("run",function(b){a.status="evaluated";a.stdout=b.result.stdout;a.stderr=b.result.stderr;a.images=b.result.images;if(!a.stdout&&!a.stderr&&(!a.images||0===a.images.length)&&!a.isEmbeddingIframe)a.stdout="Your code didn't display any output"},
{removeOnDestructionOf:a});b.addEventListener("runError",function(){a.stderr="The server encountered an error. Please try running again.";a.status="error"},{removeOnDestructionOf:a});b.addEventListener("ready",function(){a.ready=!0},{removeOnDestructionOf:a})}]);angular.module("viewer").controller("programmingQuizPanel",["$scope","lesson","programmingQuiz","tidbits",function(a,d,b,c){a.status="unsubmitted";a.quizReturn=null;a.attempts=0;a.answeredCorrectly=!1;a.submitProgrammingQuiz=function(){b.submit();a.status="processing";a.quizReturn=null};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Submit"};a.isTidbitAvailable=function(a){return a.completed||c.isTidbitRelevant(a,a.tidbit_ref.containingExercise.quiz_ref.binCodes)};a.isTidbitRelevant=
function(b){return!a.isPlaying(b.tidbit_ref)&&a.quizReturn&&c.isTidbitRelevant(b,a.quizReturn.binCodes,!0)};a.isPlaying=function(b){return a.tidbit&&b&&a.tidbit.key===b.key};d.addEventListener("morselChange",function(){a.status="unsubmitted";a.quizReturn=null;a.attempts=0;a.answeredCorrectly=!1},{replayLast:!0,removeOnDestructionOf:a});d.addEventListener("tidbitChange",function(b){a.tidbitViewerMode=c.getTidbitViewerMode(b.tidbit)},{replayLast:!0,removeOnDestructionOf:a});b.addEventListener("evaluated",
function(b){a.status="evaluated";a.attempts++;b=b.result;a.quizReturn={text:b.comment,binCodes:b.bin_codes};!0===b.passed?(a.quizReturn.status="correct",a.answeredCorrectly=!0):a.quizReturn.status=!1===b.passed?"incorrect":"recorded"},{removeOnDestructionOf:a});b.addEventListener("evaluationError",function(){a.status="error";a.attempts++;a.quizReturn={status:"incorrect",text:"There was an error grading your quiz, please try submitting again."}},{removeOnDestructionOf:a});b.addEventListener("submitting",
function(){a.status="processing";a.quizReturn=null})}]);angular.module("viewer").controller("videoPlayer",["$scope","lesson","youtubeVideoPlayer","viewerSettings",function(a,d,b,c){var e=!1;a.pauseVideo=function(){e&&b.pauseVideo()};a.obliterateVideo=function(){e&&b.destroyVideo()};a.playVideo=function(a,d){e?b.loadVideo(a.youtube_id,0):(b.attach(d.get(0),a.youtube_id,{autoPlay:c.get("autoPlay")?1:0}),e=!0)};b.addEventListener("apiReady",function(){d.addEventListener("pendingMorselChange",a.pauseVideo,{removeOnDestructionOf:a}).addEventListener("pendingLessonChange",
a.obliterateVideo,{removeOnDestructionOf:a}).addEventListener("pendingCourseChange",a.obliterateVideo,{removeOnDestructionOf:a});c.addEventListener("change",function(a){"autoPlay"===a.name&&(!1===a.oldValue&&!0===a.newValue&&e)&&b.playVideo()});b.addEventListener("ready",function(){a.loadingComplete(!0)},{removeOnDestructionOf:a});b.addEventListener("videoPlay",function(){a.loadingComplete(!0)},{removeOnDestructionOf:a})},{replayLast:!0,removeOnDestructionOf:a,removeAfterFired:!0})}]);angular.module("viewer").controller("viewerExam",["$scope","exams","modal","$window",function(a,d,b,c){a.confirmEndExam=function(a){d.terminateExam(a).then(function(){c.location.href="/"},function(){alert("Something went wrong. Please alert the proctor, and email proctoredexams@udacity.com.")})};a.endExam=function(a){b.activate("confirm",a).then(function(a){a&&alert(a.message)})}}]);angular.module("viewer").constant("loadingMessages",{general:"The instructor is setting up the classroom;Thanks for waiting while we prepare the classroom;The instructors are getting camera-ready for you;Waking up the sleepers in the front row...;And now for something completely different...;Dust off your slide-rule...;Cleaning the whiteboard;Adding duplication fluid to our ditto machine...;Reticulating Splines;Contemplating banana bread recipes;Once you have completed the course, cake will be served;Check the materials section for each class to find helpful course notes and other information from fellow Udacians!;Did you know you can meet other Udacians on the Forums?".split(";"),
ma006:["We recommend having a pencil and paper handy for this class."],ma008:["We recommend having a pencil and paper handy for this class."],st095:["We recommend having a pencil and paper handy for this class.",'Want to read about some fascinating real-world statistics? Check out Dan Ariely\'s book "Predictably Irrational"!']});angular.module("viewer").constant("videoViewedTimeThreshold",3).controller("viewerPage",["$scope","lesson","$location","$routeParams","lessonActivityTracker","$timeout","videoViewedTimeThreshold","youtubeVideoPlayer","viewerSettings","cacheVersion","loadingMessages","lessonPrefetcher","tags","libraryLoader","viewerPartialMap","examMode","techDetect","api","sessionLapsed","modal","currentUser","nodeUtility","gaqHelper","canEditNotes","guidedTour","users","qualaroo","$log","showChat","universalAnalytics",
function(a,d,b,c,e,f,g,h,i,k,l,j,m,p,n,r,q,t,u,v,s,x,D,F,J,K,G,H,I,E){function A(){var b;b=_.without(_.union(l.general,l[w]),null,void 0,"");a.viewerLoadingMessage=b[_.random(b.length-1)];a.isViewerLoading=!0}function z(a,b,c){if(a){var d=n[a.model];if(d){if(!c||d.extension)return"/templates/angular/viewer/partials/"+d.prefix+b+"?"+k}else console.error("Unrecognized morsel type "+a.model)}else if(!c)return"/templates/angular/viewer/partials/loading"+b+"?"+k}function B(a){f.cancel(y);("Video"===a.model||
"SketchVideo"===a.model)&&h.addEventListener("videoPlay",function(){f.cancel(y);y=f(C(a.key),1E3*g,!1)},{removeAfterFired:!0})}function C(a){return function(){if(h.getCurrentTime()>=g){var b=h.getCurrentTime();h.emitEvent("videoPause",b);h.emitEvent("videoPlay",b+1);d.markMorselAsCompleted(a)}else y=f(C(a),500,!1)}}a.modalsUrl="/templates/viewer/partials/viewer_modals.html?"+k;a.getCoachServicesUrl=function(){if(a.course)return"/conditional/tutoring?course_id="+window.encodeURIComponent(a.course.key)+
"&cache_bust="+k};a.userIsLoggedIn=s.userIsLoggedIn();a.canEditNotes=F;a.course=null;a.lessons=null;a.lesson=null;a.morsels=null;a.morsel=null;a.tidbit=null;var w=b.path().match("/"+m.course+"([^/]+)"),w=w?w[1]:null;a.courseKeyFromUrl=w;w||(window.location.href="/");t.addEventListener("sessionExpired",function(){window.location.href="/account/auth#!/signin?next=%2Fcourse%2Fviewer%23!"+encodeURIComponent(b.path())});u&&(window.location.href="/account/auth#!/signin?next=%2Fcourse%2Fviewer%23!"+encodeURIComponent(b.path()));
d.addEventListener("lessonPermissionDenied",function(){window.location.href="/course/"+w});d.addEventListener("courseChange",function(a){if((!a.lessons||0===a.lessons.length)&&!a.lastLessonVisited&&!c.lessonKey)window.location.href="/course/"+w}).addEventListener("coursePermissionDenied",function(){c.lessonKey||(window.location.href="/course/"+w)});d.addEventListener("lessonChange",function(a){if(!a.morsels||0===a.morsels.length)window.location.href="/course/"+w});a.isViewerLoading=!0;d.addEventListener("courseChange",
function(){p.loadLibraries(["codemirror","mathquill"]).then(function(){},function(){H.error("Classroom failed to load a required library");alert("Failed to load some required parts of the course! Please refresh the page. If this issue persists, please contact support@udacity.com. Thanks!")})}).addEventListener("morselChange",function(){a.isViewerLoading=!1});d.addEventListener("courseChange",function(b){a.course=b.course;a.lessons=b.lessons;a.enrollment=_.find(s.get("_enrollments"),function(a){return a.node_key===
b.course.key});a.premiumAccess=x.hasPermissionTo(a.course,"view-paid-supplemental-media")||a.enrollment&&(x.isCurrentEnrolled(a.enrollment,b.course)||x.isGraduated(a.enrollment,b.course));G.set({isPaid:a.premiumAccess?"yes":"no"})},{replayLast:!0,removeOnDestructionOf:a}).addEventListener("lessonChange",function(b){a.lesson=b.lesson;a.morsels=b.morsels},{replayLast:!0,removeOnDestructionOf:a}).addEventListener("morselChange",function(b){a.morsel=b;B(b)},{replayLast:!0}).addEventListener("tidbitChange",
function(b){(a.tidbit=b.tidbit)&&B(b.tidbit)},{replayLast:!0});d.addEventListener("pendingLessonChange",function(){a.morsels=null;a.morsel=null;a.tidbit=null});a.$on("$routeChangeSuccess",function(b,f,g){if(b=!c.morselKey)if(!g||!f)b=!1;else{var h=g.pathParams,f=f.pathParams;if(_.keys(h).length===_.keys(f).length)b=!1;else{var i=!0;_.each(f,function(a,b){h[b]!==a&&(i=!1)});b=i}}b&&window.history.back();c.courseKey&&c.courseKey!==w&&window.location.reload();g&&(D.pushPageviewEvent(),E.trackVirtualPageView());
if((null===a.course||a.course.key!==c.courseKey)&&"none"!==c.courseKey)A(),d.addEventListener("courseChange",function(b){c.lessonKey||(b.lastLessonVisited?a.goToLesson(b.lastLessonVisited.key):a.goToLesson(b.lessons[0].key))},{removeAfterFired:!0}),d.changeCourse(c.courseKey);if((null===a.lesson||a.lesson.key!==c.lessonKey)&&c.lessonKey)A(),d.addEventListener("lessonChange",function(b){c.morselKey||(b.lastMorselVisited?a.goToMorsel(b.lastMorselVisited):a.goToMorsel(b.morsels[0]))},{removeAfterFired:!0}),
d.changeLesson(c.lessonKey);if((null===a.morsel||a.morsel.key!==c.morselKey)&&c.morselKey)e.logNodeVisit("morsel"),a.lesson&&a.lesson.key===c.lessonKey?d.changeMorsel(c.morselKey):d.addEventListener("lessonChange",function(){d.changeMorsel(c.morselKey)},{removeAfterFired:!0});if(null===a.tidbit||a.tidbit.key!==c.tidbitKey)c.tidbitKey&&e.logNodeVisit("tidbit"),a.morsel&&a.morsel.key===c.morselKey?d.changeTidbit(c.tidbitKey):d.addEventListener("morselChange",function(){d.changeTidbit(c.tidbitKey)},
{removeAfterFired:!0})});a.alert=function(a){alert(a)};a.log=function(a){console.log(a)};a.getCurrentMorselType=function(){return a.morsel?a.morsel.model:null};a.getStyleClassesForMorsel=function(b){var c="";if(a.morsel)if("Exercise"===b.model){if(b.completed||b.lecture_ref&&b.lecture_ref.completed)c+="is-viewed";if(b.key===(a.morsel.containingExercise?a.morsel.containingExercise.key:a.morsel.key))c+=" is-current"}else b.completed&&(c+="is-viewed"),a.morsel.key===b.key&&(c+=" is-current");return c};
a.checkToShowChat=function(){if(a.enrollment)return"enrolled"===a.enrollment.state&&s.userIsLoggedIn()};a.showGroupChat=!1;I.getGroupChatPromise().then(function(b){a.showGroupChat=b});a.getPlayerPartialForCurrentMorsel=function(){return z(a.morsel,"_player.html")};a.getPlayerExtensionPartialForCurrentMorsel=function(){return z(a.morsel,"_extension.html",!0)};a.getSidePanelPartialForCurrentMorsel=function(){return z(a.morsel,"_side_panel.html")};a.goToMorsel=function(e){(!e||!e.key)&&console.error("Cannot go to invalid morsel "+
e);(!a.morsel||e.key!==a.morsel.key)&&f(function(){if("Exercise"===e.model){var a=e.lecture_ref||e.quiz_ref;d.announcePendingMorselChange(a);b.path("/"+m.course+c.courseKey+"/"+m.lesson+c.lessonKey+"/"+m.exercise+e.key+"/"+m.morsel+a.key)}else d.announcePendingMorselChange(e),e.containingExercise?b.path("/"+m.course+c.courseKey+"/"+m.lesson+c.lessonKey+"/"+m.exercise+e.containingExercise.key+"/"+m.morsel+e.key):b.path("/"+m.course+c.courseKey+"/"+m.lesson+c.lessonKey+"/"+m.morsel+e.key)})};a.goToTidbit=
function(d){!d&&a.tidbit?c.exerciseKey?b.path("/"+m.course+c.courseKey+"/"+m.lesson+c.lessonKey+"/"+m.exercise+c.exerciseKey+"/"+m.morsel+c.morselKey):b.path("/"+m.course+c.courseKey+"/"+m.lesson+c.lessonKey+"/"+m.morsel+c.morselKey):(!a.tidbit||d.key!==a.tidbit.key)&&f(function(){b.path("/"+m.course+c.courseKey+"/"+m.lesson+c.lessonKey+"/"+m.exercise+d.containingExercise.key+"/"+m.morsel+d.containingExercise.quiz_ref.key+"/"+m.tidbit+d.key)})};a.goToNextMorsel=function(){var b=a.morsel,c=a.morsels.length;
b.containingExercise&&(b=b.containingExercise);b=b.indexInLesson;b<c-1?a.goToMorsel(a.morsels[b+1]):(h.pauseVideo(),a.course?s.userIsLoggedIn()&&s.isEnrolledIn(a.course.key)?a.lessons&&a.lesson.key===a.lessons[a.lessons.length-1].key?(a.enrollment=_.find(s.get("_enrollments"),function(b){return b.node_key===a.course.key}),v.activate("endOfCourse",{courseIsComplete:a.course.catalog_entry.complete,courseKey:a.course.key,isPaidEnrolled:x.isCurrentEnrolled(a.enrollment,a.course),isGraduated:x.isGraduated(a.enrollment,
a.course)})):v.activate("endOfLesson",{lessonKey:a.lesson.key,userIsLoggedIn:s.userIsLoggedIn()}):s.userIsLoggedIn()?v.activate("endOfLessonEnrollGate",{lessonKey:a.lesson.key,userIsLoggedIn:s.userIsLoggedIn()}):v.activate("endOfLessonSignInGate",{lessonKey:a.lesson.key,userIsLoggedIn:s.userIsLoggedIn()}):v.activate("endOfIsolatedContent"))};a.goToPreviousMorsel=function(){var b=a.morsel;b.containingExercise&&(b=b.containingExercise);b=b.indexInLesson;0<b?a.goToMorsel(a.morsels[b-1]):console.error("Can't go to previous; at beginning of lesson")};
a.goToLesson=function(e){if(!a.lesson||e!==a.lesson.key)d.announcePendingLessonChange(),f(function(){b.path("/"+m.course+c.courseKey+"/"+m.lesson+e)})};a.goToNextLesson=function(){if(a.lessons){var b=a.lessons.length,c=_.find(a.lessons,function(b){return b.key===a.lesson.key}).indexInCourse;0<=c&&c<b-1?a.goToLesson(a.lessons[c+1].key):console.error("Can't go to next; at end of course!")}else console.error("Can't go to next lesson, we're not in a course!")};a.os=q.os(!1);a.isActiveMorsel=function(b){return a.morsel&&
a.morsel.key===b};a.getProgressPercentage=function(){return 77};var y}]);angular.module("viewer").controller("viewerPlayer",["$scope","lesson","$timeout","$window","currentUser","userTrials",function(a,d,b,c,e,f){a.isPlayerLoading=!0;c=function(a){var b=["attempt-1","attempt-2","control"],a=_.reduce(("skip-button-test-"+a).split(""),function(a,b){return(37*a+b.charCodeAt(0))%1009},0);return b[a%b.length]};a.skipButtonTrial=e.userIsLoggedIn()?f.getOrEnrollManually("skip_button_trial",c,[e.get("key")]):"excluded";a.loadingComplete=function(c){c?b(function(){a.$apply(function(){a.isPlayerLoading=
!1})},0,!1):a.isPlayerLoading=!1};d.addEventListener("pendingMorselChange",function(b){a.isPlayerLoading=b.from&&("Video"===b.from.model||"SketchVideo"===b.from.model)&&("Video"===b.to.model||"SketchVideo"===b.to.model)?!1:b.from&&b.from.key===b.to.key?!1:!0})}]);angular.module("page.viewer",["viewer"]).config(["$routeProvider","tags",function(a,d){a.when("/"+d.course+":courseKey/"+d.lesson+":lessonKey/"+d.exercise+":exerciseKey/"+d.morsel+":morselKey/"+d.tidbit+":tidbitKey",{}).when("/"+d.course+":courseKey/"+d.lesson+":lessonKey/"+d.exercise+":exerciseKey/"+d.morsel+":morselKey",{}).when("/"+d.course+":courseKey/"+d.lesson+":lessonKey/"+d.morsel+":morselKey",{}).when("/"+d.course+":courseKey/"+d.lesson+":lessonKey",{}).when("/"+d.course+":courseKey",{})}]);angular.module("viewer").directive("bsDropdownCloser",function(){return{restrict:"A",link:function(a,d){d.on("click",function(){$(d).closest(".dropdown").removeClass("open")})}}});angular.module("viewer").directive("codeMirrorEditor",["codeMirror","codeEditor",function(a,d){return{restrict:"A",priority:3,link:function(b,c,e){a.attach(c.get(0),{language:e.language,theme:e.theme,autofocus:!0});b.fileCount=null;d.addEventListener("filesLoaded",function(a){b.fileCount=a.files.length},{removeOnDestructionOf:b});b.getActiveLanguage=function(){return a.getActiveLanguage()};b.getAvailableLanguages=function(){return a.getAvailableLanguages()};b.setActiveLanguage=function(b){a.setActiveLanguage(b)};
b.$on("$destroy",function(){a.detach()})}}}]);angular.module("viewer").directive("contentGateWatcher",["lesson","currentUser","imageQuiz","programmingQuiz","$location","modal",function(a,d,b,c,e,f){return{restrict:"A",link:function(e){var h=d.userIsLoggedIn(),i=!1,k=function(){b.removeEventListener("correct",k);c.removeEventListener("evaluated",l);h?f.activate("enrollGate"):f.activate("signInGate")},l=function(a){a.result&&a.result.passed&&k()},j=function(){b.addEventListener("correct",k);c.addEventListener("evaluated",l)};a.addEventListener("courseChange",
function(a){a=a.course;i=a._enrollable&&!(h&&d.isEnrolledIn(a.key));e.showGate=e.showGate&&i;i&&j()},{replayLast:!0,removeAfterFired:!0,removeOnDestructionOf:e});e.$on("$routeChangeSuccess",function(){if(f.isModalActive("enrollGate")||f.isModalActive("signInGate"))f.cancel(),j()})}}}]);angular.module("viewer").directive("editorFileTabs",["codeEditor",function(a){return{restrict:"A",link:function(d){d.files=null;d.currentFilename=null;a.addEventListener("filesLoaded",function(a){d.files=a.files},{removeOnDestructionOf:d});a.addEventListener("activeFileChanged",function(a){d.currentFilename=a.newActiveFile.name},{removeOnDestructionOf:d});d.switchToFile=function(b){d.currentFilename=b;a.switchToFile(b)}}}}]);angular.module("viewer").directive("examDoneButton",[function(){return{restrict:"A",controller:["$scope","$routeParams","api",function(a,d,b){a.busy=!1;a.leaveExam=function(){a.busy=!0;b.post("/users/me/leave_exam",{exam_key:d.lessonKey}).success(function(){alert("Your exam is done. You will be redirected to the home page.");window.location.href="/"}).error(function(b,d){a.busy=!1;alert("Failed to close exam (error "+d+").  Please try again.")})}}]}}]);angular.module("viewer").directive("examNanny",["examMode","$http","$timeout","$routeParams","exams",function(a,d,b,c,e){return{restrict:"A",controller:["$scope",function(b){var d=!1,h=!1,i=function(){c.lessonKey&&e.getTimeRemaining(c.lessonKey).then(function(a){a=a.seconds_remaining;900>a&&(840<a&&!d)&&(alert("You have 15 minutes remaining."),d=!0);300>a&&(240<a&&!h)&&(alert("You have 5 minutes remaining."),h=!0);0>=a&&(alert("Time is up! You will now be directed to the home page."),window.location.href=
"/")},function(a){403===a.status?(alert("You do not have permission to view this exam! You will now be directed to the home page."),window.location.href="/"):404===a.status&&(alert("You are not registered for this exam. Redirecting to the registration page"),window.location.href="/content/exam")})};a&&(setInterval(i,15E3),b.$on("$routeChangeSuccess",function(){i()}))}]}}]);angular.module("viewer").directive("iframeCommander",["iframeEvaluator","isTrustedDomain","lesson",function(a,d,b){return{restrict:"A",link:function(c,e){function f(){var a;window.location.origin||(a=window.location,a=a.protocol+"//"+a.hostname+(a.port?":"+a.port:""));return window.location.origin||a}c.isEmbeddingIframe=!1;var g=e.find(".output-iframe-container");a.addEventListener("newEvaluation",function(a){a=a.iframeUrl?a.iframeUrl:"/content/frame/grade?node=Node."+a.nodeId;g.empty();g.append($("<iframe />",
{src:a,"class":"output-iframe"}));c.isEmbeddingIframe=!0},{removeOnDestructionOf:c});a.addEventListener("postMessageRequest",function(a){if(d(f())){var b=a.iframeUrl?a.iframeUrl:f();g.find(".output-iframe").get(0).contentWindow.postMessage(JSON.stringify({parts:a.submission.parts,operation:a.submission.operation,messageType:"evaluate"}),b);c.isEmbeddingIframe=!0}},{removeOnDestructionOf:c});b.addEventListener("pendingMorselChange",function(){g.empty();c.isEmbeddingIframe=!1},{removeOnDestructionOf:c})}}}]);angular.module("viewer").directive("iframePlayer",["lesson","$sce",function(a,d){return{restrict:"A",link:function(b,c){a.addEventListener("morselChange",function(a){"EmbeddedFrame"===a.model&&(b.iframeSourceUrl=d.trustAsResourceUrl(a.external_uri),$(c.get(0).contentWindow).ready(function(){b.loadingComplete(!0)}))},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("viewer").directive("imageFormQuiz",["lesson","$routeParams","imageQuiz","tidbits","viewerSettings","cacheVersion",function(a,d,b,c,e,f){return{restrict:"A",templateUrl:"/templates/viewer/partials/image_form_quiz.html?"+f,link:function(d){b.addEventListener("ready",function(){d.loadingComplete(!0)},{removeOnDestructionOf:d});a.addEventListener("morselChange",function(a){"ImageFormQuiz"===a.model&&(a=$.extend({},a),d.progressLoaded=!1,d.tidbitViewerMode="quiz-only",b.setQuiz(a),d.getQuiz=
b.getQuiz,d.answers=b.answers,d.radioGroupAnswers=b.radioGroupAnswers)},{replayLast:!0,removeOnDestructionOf:d});a.addEventListener("tidbitChange",function(a){d.tidbitViewerMode=c.getTidbitViewerMode(a.tidbit)},{replayLast:!0,removeOnDestructionOf:d})}}}]);angular.module("viewer").directive("instructorNotes",["cacheVersion","canEditNotes",function(a,d){return{restrict:"A",templateUrl:"/templates/viewer/partials/instructor_notes.html?"+a,scope:!0,controller:["$scope",function(a){a.canEdit=d}]}}]);angular.module("viewer").directive("lessonVideoPlayer",["lesson","youtubeVideoPlayer","currentUser",function(a,d,b){return{restrict:"A",controller:"videoPlayer",link:function(c,e){var f=null;d.addEventListener("apiReady",function(){a.addEventListener("morselChange",function(a){f=a;a._video&&c.playVideo(a._video,e)},{replayLast:!0,removeOnDestructionOf:c});d.addEventListener("videoEnd",function(){if(!b.get("site_preferences")||b.get("site_preferences").auto_advance)f.containingExercise&&f.containingExercise.quiz_ref&&
(!f.containingExercise.answer_ref||f.containingExercise.answer_ref.key!==f.key)?c.goToMorsel(f.containingExercise.quiz_ref):c.goToNextMorsel()},{removeOnDestructionOf:c})},{replayLast:!0,removeOnDestructionOf:c,removeAfterFired:!0})}}}]);angular.module("viewer").directive("mathquillTextfield",["imageQuiz","libraryLoader",function(a,d){return{restrict:"A",link:function(b,c){d.loadLibraries(["mathquill"]).then(function(){c.mathquill("editable");c.focusout(function(){a.answers[b.widget.marker]=c.mathquill("latex")});b.$watch(function(){if(b.widget)return a.answers[b.widget.marker]},function(a){c.mathquill("latex",a)})})}}}]);angular.module("viewer").directive("nodeNotesEditor",["$http","$timeout",function(a,d){return{restrict:"A",template:'<textarea class="input-block-level form-control" data-ng-model="morsel[fieldName]" style="min-height: 100px"></textarea><button class="btn btn-sm btn-default" data-ng-click="saveNodeText()">Save Notes</button>',scope:{morsel:"=",fieldName:"="},link:function(b){b.saveNodeText=function(){if("owner_comments"!==b.fieldName||window.confirm("Instructor notes are viewable by all students! Are you sure you want to save?")){var c=
[{model:b.morsel.model,key:b.morsel.key,last_edit_time:b.morsel.last_edit_time}];c[0][b.fieldName]=b.morsel[b.fieldName];var c={nodes:c},e=b.morsel[b.fieldName];b.morsel[b.fieldName]="Saving...";a.post("/api/nodes",c).success(function(a){b.morsel[b.fieldName]="Successfully saved!!";d(function(){angular.extend(b.morsel,a.references.Node[b.morsel.key])},2E3)}).error(function(a){alert("Sorry, the update failed. Please copy your text out of the window, refresh the page, and try again.");b.morsel[b.fieldName]=
e;console.warn("Update failed!",a)})}}}}}]);angular.module("viewer").directive("playerLoadingMask",function(){return{restrict:"A",transclude:!0,template:'<div class="player-loading-overlay" data-ng-show="isPlayerLoading" data-fade-out="200"><div class="player-loading-overlay-message"><img alt="Loading..." src="//lh5.ggpht.com/b3OandPWsUWAnRVS5d8JS8OL0nu8dU2d3NceS7p1yKhPl9KD4EhqeylPm7yFbft5wmsA2VCAZ-8wAkmFduXJ=s0#w=90&h=30"></div></div><div data-ng-transclude></div>',link:function(a,d){d.addClass("player-loading-mask")}}});angular.module("viewer").directive("programmingQuizPlayer",["codeMirror","lesson","$routeParams","programmingQuiz","tidbits",function(a,d,b,c,e){return{restrict:"A",priority:10,link:function(b,g){b.getClasses=function(){var a=[b.tidbitViewerMode];1<b.fileCount&&a.push("multi-file");return a};c.addEventListener("ready",function(){b.loadingComplete()},{removeOnDestructionOf:b});a.addEventListener("attached",function(){d.addEventListener("morselChange",function(a){"ProgrammingQuiz"===a.model&&(b.loading=
!0,a=$.extend({},a),c.init(a))},{replayLast:!0,removeOnDestructionOf:b})},{removeOnDestructionOf:b,removeAfterFired:!0});d.addEventListener("tidbitChange",function(a){b.tidbitViewerMode=e.getTidbitViewerMode(a.tidbit)},{replayLast:!0,removeOnDestructionOf:b});var h=g.find(".code-mirror-holder"),i=g.find(".editor-file-tabs"),k=function(){h.outerHeight(g.height()-(b.files&&1<b.files.length?i.outerHeight():0))},l=_.debounce(k,750),j=_.throttle(k,200);$(window).on("resize",l);$(window).on("resize",j);
b.$watch("files",function(){window.setTimeout(j,0)});k()}}}]);angular.module("viewer").directive("quizVideoPlayer",["lesson","youtubeVideoPlayer","currentUser",function(a,d,b){return{restrict:"A",controller:"videoPlayer",link:function(c,e){var f=null;d.addEventListener("apiReady",function(){a.addEventListener("tidbitChange",function(a){(a=(f=a.tidbit)?f._video:null)?c.playVideo(a,e):c.pauseVideo()},{replayLast:!0,removeOnDestructionOf:c});d.addEventListener("videoEnd",function(){(!b.get("sitePreferences")||b.get("sitePreferences").autoAdvance)&&f&&f.containingExercise&&
f.containingExercise.answer_ref&&f.containingExercise.answer_ref.key===f.key?c.goToNextMorsel():c.goToTidbit(null)},{removeOnDestructionOf:c})},{replayLast:!0,removeOnDestructionOf:c,removeAfterFired:!0})}}}]);angular.module("viewer").directive("quizWidget",function(){return{restrict:"A",link:function(a,d){var b=!0;a.$watch("widget",function(a,e){b&&e&&(d.css({top:100*e.placement.y+"%",left:100*e.placement.x+"%"}),"TextInputWidget"===e.model||"NumericInputWidget"===e.model?(d.width(100*e.placement.width+"%"),d.height(100*e.placement.height+"%")):"MathInputWidget"===e.model&&d.css({"min-width":100*e.placement.width+"%","min-height":100*e.placement.height+"%"}),b=!1)})}}});angular.module("viewer").directive("readingPlayer",["lesson",function(a){return{restrict:"A",link:function(d){a.addEventListener("morselChange",function(a){"Reading"===a.model&&(d.textFrameContent=a.text,d.loadingComplete())},{replayLast:!0,removeOnDestructionOf:d})}}}]);angular.module("viewer").directive("sidePanelUpsell",["currentUser","cookieJar","nodeUtility","cacheVersion","products","siteExperience","$q","dateTime","$location","$window",function(a,d,b,c,e,f,g,h,i,k){return{restrict:"A",templateUrl:"/templates/viewer/partials/side_panel_upsell.html?"+c,link:function(c){c.isCurrentlyEnrollable=function(a){return!a.catalog_entry.paid_class||!a.catalog_entry.paid_class.open_for_enrollment||!a.catalog_entry.paid_class.class_product_refs?g.when(!1):e.get(_.first(a.catalog_entry.paid_class.class_product_refs).key).then(function(a){if(a.capped)return!1;
if(a.launch_date){var b=h.getCurrent(),a=a.launch_date.split("-"),c=new Date;c.setUTCFullYear(parseInt(a[0],10),parseInt(a[1],10)-1,parseInt(a[2],10));c.setUTCHours(18,0,0,0);return c<b}return!0})};var j=c.$watch("course",function(e){if(e){var g=_.find(a.get("_enrollments"),function(a){return a.node_key===e.key}),g=g&&b.isCurrentEnrolled(g,e);d.exists("cancel-side-panel-upsell")||g||f.managedAccount?c.showBanner=!1:c.isCurrentlyEnrollable(e).then(function(a){c.showBanner=a;c.learnMore="/what-we-offer#!/?courseKey="+
k.encodeURIComponent(e.key)+"&start="+k.encodeURIComponent(i.absUrl())},function(){c.showBanner=!1});j()}else c.showBanner=!1});c.goToPurchase=function(a){k.location.href="/checkout#!/0?products="+k.encodeURIComponent(_.first(a.catalog_entry.paid_class.class_product_refs).key)};c.cancelBanner=function(){d.set("cancel-side-panel-upsell",!0);c.showBanner=!1}}}}]);angular.module("viewer").directive("supplementalMaterialsList",["cacheVersion",function(a){return{templateUrl:"/templates/viewer/partials/supplemental_materials_list.html?"+a}}]);angular.module("viewer").directive("viewerDiscussions",["forumService","lesson","$http","cacheVersion","siteExperience","fetchDiscourseLink","currentUser","nodeUtility",function(a,d,b,c,e,f,g,h){return{restrict:"A",templateUrl:"/templates/viewer/partials/viewer_discussions.html?"+c,controller:["$scope","$attrs","examMode",function(b,c,l){b.examMode=l;b.postsStartIndex=0;b.postsEndIndex=0;b.limitedAccess=e.limitedAccess;b.affiliateExperienceId=e.affiliateExperienceId;var j=c.numPerPage;d.addEventListener("courseChange",
function(c){var e=c.course.key;b.course=c.course;angular.isString(e)&&"nd"===e.slice(e.length-2)&&(b.isNanodegreeAssociatedCourse=!0,f(e).then(function(a){b.discourseCohortUrl=a}));d.addEventListener("morselChange",function(d){b.morsel=d;var d=b.course,k=b.morsel;d&&k&&!b.limitedAccess&&(b.seeAllCoursePostsUrl="http://discussions.udacity.com/c/standalone-courses/"+b.course.forum_slug,b.askAQuestionUrl="http://discussions.udacity.com/c/standalone-courses/"+b.course.forum_slug+"/create",b.enrollment=
_.find(g.get("_enrollments"),function(a){return a.node_key===b.course.key}),b.isPaidCourse=h.hasPermissionTo(b.course,"view-paid-supplemental-media")||b.enrollment&&(h.isCurrentEnrolled(b.enrollment,b.course)||h.isGraduated(b.enrollment,b.course)),f(b.course.key).then(function(a){b.discourseCohortUrl=a}),a.getPosts(k.containingExercise?k.containingExercise.key:k.key,0,j,d).then(function(a){b.posts=a;b.postsStartIndex=1+0*j;b.postsEndIndex=b.posts.length+0*j}));"Degree"===c.course._semantic_type&&
(b.isNanodegree=!0,f(e).then(function(a){b.discourseCohortUrl=a}))},{replayLast:!0,removeOnDestructionOf:b})},{replayLast:!0,removeAfterFired:!0})}]}}]);angular.module("viewer").directive("viewerFeedback",["validator","recordActivity","cacheVersion","lesson","lessonContentContext","techDetect","youtubeVideoPlayer",function(a,d,b,c,e,f,g){return{templateUrl:"/templates/viewer/partials/viewer_feedback.html?"+b,controller:["$scope","modal",function(b,c){b.form={feedbackReason:{value:null,validators:[{type:"required",failMsg:"Please select the type of feedback you wish to give."}]},feedbackExplanation:{value:null,validators:[{type:"javascript",args:[function(a,
b){return"other"!==b.form.feedbackReason.value?!0:"string"===typeof a&&""!==a.replace(/\s+/,"")},b],failMsg:"Please explain the issue you're having."}]}};b.formValidationResults={valid:!0,errorText:{}};var k=[{name:"Video Problem",code:"videoProblem",explanation:"e.g. text is unreadable, video doesn\u2019t play"},{name:"Mistake",code:"mistake",explanation:"e.g. instructor made an error"},{name:"Subtitle Problem",code:"subtitleProblem",explanation:"e.g. subtitles do not match what is said"},{name:"Confusing content",
code:"confusingContent",explanation:"e.g. course material is not explained correctly"}],l=[{name:"Instructions are unclear in a video or question.",code:"instructionsUnclear",explanation:"Did you check the instructor notes below the video player?"},{name:"A correct answer is not accepted.",code:"correctAnswerNotAccepted",explanation:"Did you check the discussions for additional help?"},{name:"Feedback on submitted answer is not useful.",code:"gradingFeedbackUnhelpful"},{name:"Answer video is unclear.",
code:"answerVideoUnclear"},{name:"A link is broken or directs to the wrong site.",code:"brokenLink"},{name:"There is a problem with the download code file(s).",code:"supplementalMaterialIssue"}],j=[{name:"Instructions are unclear in a video or question.",code:"instructionsUnclear",explanation:"Did you check the instructor notes below?"},{name:"A link is broken or directs to the wrong site.",code:"brokenLink"},{name:"There is a problem with the download code file(s).",code:"supplementalMaterialIssue"}];
b.showFeedbackDialog=function(){b.morselTitle=b.morsel.title;"Video"===b.morsel.model?(g.pauseVideo(),b.feedbackOptions=k):b.feedbackOptions="ImageFormQuiz"===b.morsel.model||"ProgrammingQuiz"===b.morsel.model?l:j;c.activate("feedback")};var m=function(a){for(var a=_.pairs(a),b={},c=0;c<a.length;++c){var d=a[c][0],e=a[c][1];if(_.isObject(e))for(var e=_.pairs(m(e)),f=0;f<e.length;++f)b[d+"."+e[f][0]]=e[f][1];else void 0!==e&&null!==e&&(b[d]=e)}return b};b.submitFeedback=function(){b.formValidationResults=
a.check(b.form);if(b.formValidationResults.valid){var k=[{context:e.getCurrent(),data:{model:"SurveyResponse",survey_name:"LessonFeedbackVersion2"}}],j={reason:b.form.feedbackReason.value,explanation:b.form.feedbackExplanation.value,techDetect:f.getAllTech(),currentUrl:window.location.href};"Video"===b.morsel.model&&(j=_.extend(j,{youtube:{availablePlaybackRates:g.getAvailablePlaybackRates(),currentPlaybackRate:g.getCurrentPlaybackRate(),currentTime:g.getCurrentTime()}}));j=m(j);k[0].data.items=_.map(_.pairs(j),
function(a){return{name:a[0],content:a[1]}});d.send(k);c.confirm();b.form.feedbackReason.value=null;b.form.feedbackExplanation.value=null;c.activate("feedback-confirmation").then(function(){"Video"===b.morsel.model&&g.playVideo()})}}}]}}]);angular.module("viewer").factory("codeEditor",["mixin","codeMirror","libraryLoader",function(a,d,b){function c(a){return-1!==a.indexOf(".c")?"c":-1!==a.indexOf(".cpp")?"cpp":-1!==a.indexOf(".css")?"css":-1!==a.indexOf(".cu")?"cuda":-1!==a.indexOf(".e")?"specman":-1!==a.indexOf(".glsl")?"glsl":-1!==a.indexOf(".html")?"html":-1!==a.indexOf(".java")?"java":-1!==a.indexOf(".js")?"javascript":-1!==a.indexOf(".json")?"javascript":-1!==a.indexOf(".m")?"octave":-1!==a.indexOf(".py")?"python":-1!==a.indexOf(".r")?
"r":-1!==a.indexOf(".ocl")?"ocl":-1!==a.indexOf(".xml")?"xml":"plaintext"}function e(a){a&&(g=a,d.setActiveLanguage(c(a.name)),d.setContents(a.text),"javascript"===c(a.name)?b.loadLibraries(["codemirror","jshint"]).then(function(){d.setOptions({gutters:["CodeMirror-lint-markers"],lintWith:CodeMirror.javascriptValidator})}):d.setOptions({gutters:[],lintWith:null}),h.emitEvent("activeFileChanged",{newActiveFile:a}))}var f=null,g=null,h={loadFiles:function(a){var c=!0;_.each(a,function(a){if(!_.isObject(a)||
!a.name||!a.hasOwnProperty("text"))c=!1,console.error("Failed to load files. Invalid file: ",a)});if(c)return b.loadLibraries(["codemirror"]).then(function(){f=_.map(a,function(a){return{name:a.name,text:a.text}});e(f[0]);h.emitEvent("filesLoaded",{files:f})})},getAllFiles:function(){g.text=d.getContents();return f},switchToFile:function(a){g.text=d.getContents();e(_.find(f,function(b){return b.name===a}))}};return a.eventEmission(h,["filesLoaded","activeFileChanged"])}]);angular.module("viewer").service("codeMirror",["mixin","libraryLoader",function(a,d){var b=null,c=null,e={python:{name:"python",version:2,singleLineStringErrors:!1},c:"text/x-csrc",cuda:"text/x-cudasrc",cpp:"text/x-c++src",css:"text/css",java:"text/x-java",javascript:"text/javascript",glsl:"text/x-glsl",html:{name:"xml",htmlMode:!0},ocl:"text/x-ocl",octave:"text/x-octave",specman:"text/x-specmansrc",r:"text/x-rsrc",xml:{name:"xml",htmlMode:!1}},f=function(a){for(var b={},a=a.split(" "),c=0;c<a.length;++c)b[a[c]]=
!0;return b},g=function(a,b){return b.startOfLine?(a.skipToEnd(),"meta"):!1};d.loadLibraries(["codemirror"]).then(function(){CodeMirror.defineMIME("text/x-cudasrc",{name:"clike",keywords:f("auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile inline wchar_t"),builtin:f("__global__ __constant__ __shared__ threadIdx blockIdx gridDim blockDim __device__ __host__ __syncthreads"),
blockKeywords:f("do else for if struct switch while"),atoms:f("true false null"),hooks:{"#":g}});CodeMirror.defineMIME("text/x-specmansrc",{name:"clike",keywords:f("all also as_a assert assume an and attribute bit bits bool break byte case check change compute computed cover continue cross cycle default define delay detach do down each edges else emit empty event exec expect export extend fail fall file first for force from gen global if ifdef ifndef in index int inline is instance item keep keeping key like line list machine matching me nand new nor not now of on only or out pass prev print range ranges release repeat return reverse rise routine select soft start state step string struct sync sys that then time to transition true try type undefined uint unit until using var when while with")})});
var h={attach:function(a,f){d.loadLibraries(["codemirror"]).then(function(){if(!_.isElement(a))throw"Must attach code mirror to a DOM element!";b&&(b=null);var d=angular.bind(this,function(){h.emitEvent("contentChanged")}),g=window.CodeMirror;b=g(a,{mode:e[f.language],theme:f.theme||"default",autofocus:f.autofocus,onChange:d,lineNumbers:!0,matchBrackets:!0,indentUnit:4,extraKeys:{Tab:"indentMore"}});c=f.language;h.emitEvent("attached")})},detach:function(){b=null},getAvailableLanguages:function(){return _.keys(e)},
setActiveLanguage:function(a){c=a;b.setOption("mode",e[a]);h.emitEvent("languageChanged",{to:a})},getActiveLanguage:function(){return c},setOptions:function(a){_.each(a,function(a,c){b.setOption(c,a)})},getContents:function(){return b?b.getValue():null},setContents:function(a){b.setValue(a)}};return a.eventEmission(h,["attached","languageChanged","contentChanged"])}]);angular.module("viewer").service("executor",["mixin","api","dateTime","lessonContentContext","lesson","iframeEvaluator","$location",function(a,d,b,c,e,f,g){var h={submitFiles:function(a,k,l){var j=l.operation||"TEST",m=c.getCurrent(),p=b.getCurrentAsUTC(),n={model:"Submission",operation:j,parts:_.map(a,function(a){return{model:"SubmissionPart",marker:a.name,content:a.content}})},r={submission:n,client_route:"!"+g.path()},q=function(a){h.emitEvent("evaluation",{evaluation:a.data.evaluation,submission:n,
context:m,timestamp:p});return a};h.emitEvent("submit");e.updateLastSubmissionForMorsel(k,n);return l.useIframe?f.evaluate(n,k,l.iframeUrl).then(function(a){r.submission.client_execution=a.execution;r.submission.client_execution.raw_result=JSON.stringify(a.execution.raw_result);return d.post("/nodes/"+k+"/evaluation?_method=GET",r,{timeout:3E4}).then(q)},function(){r.execution={model:"SubmissionExecution",raw_result:"",status:"te"};return d.post("/nodes/"+k+"/evaluation?_method=GET",r,{timeout:3E4}).then(q)}):
d.post("/nodes/"+k+"/evaluation?_method=GET",r,{timeout:3E4}).then(q)}};return a.eventEmission(h,["update","submit","evaluation"])}]);angular.module("viewer").factory("forumService",["$http","$q","optimizely",function(a,d,b){return{getPosts:function(c,e,f,g){var h=d.defer();window.FORUM_JSONP_CALLBACK=function(a){h.resolve(_.first(_.map(a,function(a){return{title:a.title,href:a.href+"#"+g.key,date:a.date,score:a.score,answer_count:a.answer_count,views:a.views,important:a.important}}),f))};a.jsonp("https://forums.udacity.com/tags/"+c+"/interesting/?callback=FORUM_JSONP_CALLBACK").success(function(a){return a}).error(function(){})["finally"](function(){window.setTimeout(b.activate,
0)});return h.promise}}}]);angular.module("viewer").factory("iframeEvaluator",["mixin","$q","$timeout","isTrustedDomain",function(a,d,b,c){var e=null,f=null,g=null,h={evaluate:function(a,c,l){var j=d.defer();e=j;f=a;g=l;h.emitEvent("newEvaluation",{nodeId:c,iframeUrl:l});b(function(){j.reject("timeout")},6E4);return j.promise}};window.addEventListener("message",function(a){if(c(a.origin)){var d;a=a.data;try{d=JSON.parse(a)}catch(l){d=a}"ready"===d.messageType?h.emitEvent("postMessageRequest",{submission:f,iframeUrl:g}):"execution"===
d.messageType&&b(function(){e.resolve(d.result)})}},!1);return a.eventEmission(h,["newEvaluation","postMessageRequest"])}]);angular.module("viewer").factory("imageQuiz",["mixin","api","dateTime","lesson","lessonContentContext","$timeout",function(a,d,b,c,e,f){function g(a,b){a&&_.each(b.widgets,function(b){var c=_.find(a.parts,function(a){return a.marker===b.marker});c&&("RadioButtonWidget"===b.model?c.content&&(j.radioGroupAnswers[b.group]=c.marker):j.answers[b.marker]=c.content)})}var h=null,i=null,k=null,l;c.addEventListener("morselChange",function(a){l=a},{replayLast:!0});var j={answers:null,radioGroupAnswers:null,
setQuiz:function(a){h=a;var b=Math.round((new Date).getTime());i=b;j.answers={};_.each(h.widgets,function(a){j.answers[a.marker]=a.initial_value});j.radioGroupAnswers={};h.hasOwnProperty("lastSubmission")?(g(h.lastSubmission,h),j.emitEvent("ready")):d.get("/nodes/"+a.key+"/state").success(function(a){if(l.key===h.key&&b===i){var d=a.nodestates[0]?a.nodestates[0].last_submission_data:null,a=a.nodestates[0]?a.nodestates[0].bin_codes:null;g(d,h);c.updateLastSubmissionForMorsel(h.key,d);c.mergeBinCodesForMorsel(h.key,
a);j.emitEvent("ready")}}).error(function(a){console.error("Error fetching quiz progress data");console.error(a)})},getQuiz:function(){return h},submit:function(){_.each(h.widgets,function(a){"RadioButtonWidget"===a.model&&(j.answers[a.marker]=j.radioGroupAnswers[a.group]===a.marker)});j.emitEvent("submitting",j.answers);if(h.evaluator){var a=Math.round((new Date).getTime()),g=h.key;k=a;var i=e.getCurrent(),r=b.getCurrentAsUTC(),q={model:"Submission",operation:"GRADE",parts:_.map(j.answers,function(a,
b){return{model:"SubmissionPart",marker:b,content:a}})},t={submission:q};c.updateLastSubmissionForMorsel(h.key,q);d.post("/nodes/"+h.key+"/evaluation?_method=GET",t).success(function(b){j.emitEvent("evaluation",{evaluation:b.evaluation,submission:q,context:i,timestamp:r});if(g===l.key&&a===k)if(b.evaluation){c.mergeBinCodesForMorsel(h.key,b.evaluation.bin_codes);if(b.evaluation.passed||0<b.evaluation.score.points_earned)c.markMorselAsCompleted(g),h.containingExercise&&c.markMorselAsCompleted(h.containingExercise.key);
!0===b.evaluation.passed?j.emitEvent("correct",{quiz:h,comment:b.evaluation.comment,binCodes:b.evaluation.bin_codes}):!1===b.evaluation.passed?j.emitEvent("incorrect",{quiz:h,comment:b.evaluation.comment,binCodes:b.evaluation.bin_codes}):null===b.evaluation.passed?j.emitEvent("recorded",{quiz:h,comment:b.evaluation.comment,binCodes:b.evaluation.bin_codes}):console.error("invalid evaluation.passed value:"+b.evaluation.passed)}else j.emitEvent("error",{morselId:h.key,comment:"We encountered an error. Please try submitting again."})}).error(function(){j.emitEvent("error",
{morselId:h.key,comment:"We encountered an error. Please try submitting again."})})}else f(function(){_.reduce(h.widgets,function(a,b){return a&&j.answers[b.marker]===b.correct_value},!0)?j.emitEvent("correct",{morselId:h.key}):j.emitEvent("incorrect",{morselId:h.key})},10)}};return a.eventEmission(j,"ready submitting incorrect correct recorded error evaluation".split(" "))}]);angular.module("viewer").factory("isTrustedDomain",[function(){return function(a){return"https://www.udacity.com"===a||"http://localhost:8080"===a||"http://localhost:8087"===a||"https://assignments-dot-udacity-extras.appspot.com"===a}}]);angular.module("viewer").factory("lesson",["api","$q","mixin","lessonContentContext","typeForTag","freshContent",function(a,d,b,c,e,f){function g(a,b){var c=_.find(a,function(a){for(var c=b.length-1;0<=c;c--){var d=a.content_context[c];if(!d||d.node_ref.key!==b[c].node_key||d.tag!==b[c].tag)return!1}return!0});c&&(c=_.object(_.map(c.content_context,function(a){return[e[a.tag]+"Key",a.node_ref.key]})));return c}var h=null,i=null,k=null,l=null,j=null,m=null,p=null,n={announcePendingCourseChange:function(){n.emitEvent("pendingCourseChange",
{course:h})},changeCourse:function(b){var e=Math.round((new Date).getTime());p=e;d.all([a.get("/nodes/"+b+"?depth=1&fresh="+(!0===f)+"&required_behavior=view&projection=navigation"),a.get("/nodes/"+b+"/state?fresh=true")]).then(function(a){var d=a[0].data,f=a[1].data,j=a=null;if(e===p){h=d.references.Node[b];i=d.references.Node;h.steps_refs=_.reject(h.steps_refs,function(a){return!i[a.key]});if(d=_.find(f.nodestates,function(a){return a.node_ref.key===b}))(j=g(d.last_interactions,c.getCurrent()))&&
j.lessonKey&&(a=i[j.lessonKey]);n.emitEvent("courseChange",{course:h,lessons:_.map(h.steps_refs,function(a,b){var c=i[a.key];c.indexInCourse=b;return c}),lastLessonVisited:a})}},function(a){e===p&&a.status&&(403===a.status||404===a.status)&&n.emitEvent("coursePermissionDenied",b)})},announcePendingLessonChange:function(){n.emitEvent("pendingLessonChange",{lesson:k})},changeLesson:function(b){var e=Math.round((new Date).getTime());m=e;d.all([a.get("/nodes/"+b+"?depth=2&fresh="+(!0===f)+"&required_behavior=view&projection=classroom"),
a.get("/nodes/"+b+"/state?fresh=true")]).then(function(a){if(e===m){var d=a[0].data,f=a[1].data,a=null;k=d.references.Node[b];l=d.references.Node;k.steps_refs=_.reject(k.steps_refs,function(a){return!l[a.key]});_.each(k.steps_refs,function(a,b){var c=l[a.key];if(!c)throw Error("Expected a morsel but got "+JSON.stringify(c,2));"Exercise"===c.model&&(_.each(["lecture_ref","quiz_ref","answer_ref"],function(a){c[a]&&(c[a]=l[c[a].key],c[a]&&(c[a].containingExercise=c))}),_.each(c.tidbits,function(a){a.tidbit_ref=
l[a.tidbit_ref.key];a.tidbit_ref&&(a.tidbit_ref.containingExercise=c)}));l[a.key].indexInLesson=b});_.each(l,function(a){if("ImageFormQuiz"===a.model||"ProgrammingQuiz"===a.model)a.binCodes=[]});if(d=_.find(f.nodestates,function(a){return a.node_ref.key===b}))_.each(d.completed_descendant_node_refs,function(a){n.markMorselAsCompleted(a.key)}),(d=g(d.last_interactions,c.getCurrent()))&&d.morselKey&&(a=l[d.morselKey]);n.emitEvent("lessonChange",{lesson:k,morsels:_.map(k.steps_refs,function(a){return l[a.key]}),
lastMorselVisited:a})}},function(a){e===m&&a&&(a.status&&(403===a.status||404===a.status))&&n.emitEvent("lessonPermissionDenied",b)})},announcePendingMorselChange:function(a){n.emitEvent("pendingMorselChange",{from:j,to:a})},changeMorsel:function(a){j=l[a];n.emitEvent("morselChange",j)},changeTidbit:function(a){n.emitEvent("tidbitChange",{tidbit:a?l[a]:null})},markMorselAsCompleted:function(a){l[a]?l[a].completed=!0:console.error("Can't find morsel #"+a+" to mark it as completed")},updateProgressForMorsel:function(a,
b){l[a]&&l[b]?l[a].progressNodeId=b:console.error("Can't find container morsel #"+a+" or perhaps progress morsel #"+b+" to update progress")},updateLastSubmissionForMorsel:function(a,b){l[a]?l[a].lastSubmission=b:console.error("Can't find morsel #"+a+"to update activity")},mergeBinCodesForMorsel:function(a,b){l[a]&&(l[a].binCodes=_.union(l[a].binCodes,b))}};return b.eventEmission(n,"pendingCourseChange courseChange pendingLessonChange lessonChange pendingMorselChange morselChange tidbitChange lessonPermissionDenied coursePermissionDenied".split(" "))}]);angular.module("viewer").factory("lessonPrefetcher",["$http","$timeout","lesson",function(a,d,b){var c=null;b.addEventListener("courseChange",function(a){c=a.lessons},{replayLast:!0});b.addEventListener("courseChange",function(){b.addEventListener("lessonChange",function(b){var f=_.find(c,function(a){return a.key===b.lesson.key}).indexInCourse;if(0<f){var g=c[f-1].key;d(function(){a.get("/api/nodes/"+g+"?depth=2&fresh=false&required_behavior=view&projection=classroom")},1E4,!1)}if(0<=f&&f<c.length-
1){var h=c[f+1].key;d(function(){a.get("/api/nodes/"+h+"?depth=2&fresh=false&required_behavior=view&projection=classroom")},7E3,!1)}},{replayLast:!0})},{removeAfterFired:!0,replayLast:!0});b.addEventListener("morselChange",function(c){if(("Video"===c.model||"SketchVideo"===c.model)&&c.containingExercise&&c.containingExercise.lecture_ref&&c.containingExercise.lecture_ref.key===c.key&&c.containingExercise.quiz_ref&&!c.containingExercise.quiz_ref.lastSubmission){var d=c.containingExercise.quiz_ref;a.get("/api/nodes/"+
d.key+"/state").success(function(a){d.lastSubmission||b.updateLastSubmissionForMorsel(d.key,a.nodestates[0]?a.nodestates[0].last_submission_data:null)}).error(function(){console.error("Failed to prefetch last submission for quiz with id "+d.key)})}});return{}}]);angular.module("viewer").factory("lessonActivityTracker",["$http","lesson","lessonContentContext","youtubeVideoPlayer","dateTime","imageQuiz","executor","mixin","$routeParams",function(a,d,b,c,e,f,g,h,i){function k(a){function c(a){_.find(a.context,function(a){return"m-"===a.tag})||alert("A severe bug has occurred that we are trying to track down!  If you can please contact nicolas@udacity.com immediately, that would be very helpful. If not, please know that your last submission was lost and please resubmit again. Refreshing the page may help, but will lose your latest submission, so please copy it down before refreshing. We are very sorry about this! \n\nDebug Information, please include this in your email if you send one:\n"+
JSON.stringify(i,2)+"\n___\n"+JSON.stringify(b.getCurrent(),2)+"\n___\n"+window.location.href+"\n____\n"+JSON.stringify(a.evaluation,2)+"\n____\n"+new Date);return m(_.map(_.without([a.submission,a.evaluation],null,void 0),function(b){return{context:a.context,data:b}}),{chain:!0,timestamp:a.timestamp})}function d(){e+=1;3>e?c(a).then(function(){},d):p.emitEvent("quizActivityLogFailure",{context:a.context})}var e=0;a.evaluation&&(a.evaluation.model="SubmissionEvaluation");c(a).then(function(){},d)}
var l=null,j=null,m=function(b,c){var c=c||{},d={items:_.map(b,function(a){return{occurrence_time:c.timestamp||e.getCurrentAsUTC(),content_context:_.without(a.context,null,void 0,"none"),data:a.data}}),current_time:e.getCurrentAsUTC()},f="/api/activity";c.chain&&(f+="?related_chain=true");return a.post(f,d).then(function(a){200!==a.status&&(console.error("Error when trying to post activity. Response:"),console.error(a))})};c.addEventListener("videoPlay",function(a){l=a},{replayLast:!0});c.addEventListener("videoPause",
function(a){null!==l&&(null!==a&&void 0!==a)&&(j=a,m([{context:b.getCurrent(),data:{model:"PlayableView",start:l,stop:j}}]));l=j=null},{replayLast:!0});f.addEventListener("evaluation",k,{replayLast:!0});g.addEventListener("evaluation",k,{replayLast:!0});d.addEventListener("morselChange",function(a){if(!a.completed&&("Reading"===a.model||"EmbeddedFrame"===a.model))d.markMorselAsCompleted(a.key),m([{context:b.getCurrent(),data:{model:"CompletedExperience",completion_context:"Student viewed the node"}}])});
var p={logNodeVisit:function(a){m([{context:b.getCurrent(a),data:{model:"NodeVisit"}}])}};return h.eventEmission(p,["quizActivityLogFailure"])}]);angular.module("viewer").factory("lessonContentContext",["$routeParams","tags",function(a,d){return{getCurrent:function(b){var c=["course","lesson","exercise","morsel","tidbit"];b&&(b=_.indexOf(c,b),0<=b&&(c=c.slice(0,b+1)));return _.without(_.map(c,function(b){if(a[b+"Key"]&&"none"!==a[b+"Key"])return{tag:d[b],node_key:a[b+"Key"]}}),void 0,null)}}}]);angular.module("viewer").factory("programmingQuiz",["api","mixin","codeEditor","executor","lesson",function(a,d,b,c,e){function f(a){return _.map(a,function(a){return{name:a.name,content:a.text}})}function g(a){return _.map(a,function(a){var b={name:a.name};a._content&&"text/plain"===a._content._content_type?(b.text=a._content._plaintext,b.kind="plaintext"):a._content&&-1!==a._content._content_type.indexOf("image")&&(b.servingUrl=a._content._serving_url,b.kind="image");return b})}function h(a,b){a&&
_.each(b,function(b){var c=_.find(a.parts,function(a){return a.marker===b.name});c&&(b.text=c.content)})}var i=null,k=null,l=null,j;e.addEventListener("morselChange",function(a){j=a},{replayLast:!0});var m=null,p=null,n=null,r=null,q={init:function(c){var d=Math.round((new Date).getTime()),f=c.key;i=d;p=g(c.initial_code_files);m=g(c.initial_code_files);n=c.key;r=c;c.hasOwnProperty("lastSubmission")?(h(c.lastSubmission,m),b.loadFiles(m).then(function(){q.emitEvent("ready")})):a.get("/nodes/"+c.key+
"/state").success(function(a){if(f===j.key&&d===i){var c=a.nodestates[0],a=c?c.last_submission_data:null,c=c?c.bin_codes:[];h(a,m);e.updateLastSubmissionForMorsel(n,a);e.mergeBinCodesForMorsel(n,c);b.loadFiles(m);q.emitEvent("ready")}}).error(function(a){console.error("Error fetching programming quiz progress data");console.error(a)})},submit:function(){var a=Math.round((new Date).getTime()),d=j.key;k=a;var g={operation:"GRADE",useIframe:j.evaluator&&"IFrameEvaluator"===j.evaluator.model,iframeUrl:j.evaluator&&
j.evaluator.external_uri};q.emitEvent("submitting",{morselId:n,submissionOptions:g});c.submitFiles(f(b.getAllFiles()),n,g).then(function(b){b=b.data;if(a===k&&d===j.key){e.mergeBinCodesForMorsel(d,b.evaluation.bin_codes);if(b.evaluation.passed||0<b.evaluation.score.points_earned)e.markMorselAsCompleted(d),r.containingExercise&&e.markMorselAsCompleted(r.containingExercise.key);b.evaluation.comment&&b.evaluation.comment.indexOf("est case input")&&(q.emitEvent("run",{morselId:d,result:{stdout:b.evaluation.comment,
stderr:null,images:null}}),b.evaluation.comment=b.evaluation.feedback?b.evaluation.feedback:"Please see detailed feedback in the output area below.");q.emitEvent("evaluated",{quiz:j,result:b.evaluation})}},function(a){q.emitEvent("evaluationError",a.data)})},run:function(){var a=Math.round((new Date).getTime()),d=j.key;l=a;c.submitFiles(f(b.getAllFiles()),n,{operation:"TEST",useIframe:j.evaluator&&"IFrameEvaluator"===j.evaluator.model,iframeUrl:j.evaluator&&j.evaluator.external_uri}).then(function(b){b=
b.data;if(a===l&&d===j.key){var c={};b.execution&&b.execution._output_attachments&&(c=b.execution._output_attachments,b=g(b.execution._ordered_file_attachments),c={stdout:c.stdout?c.stdout._content._plaintext:null,stderr:c.stderr?c.stderr._content._plaintext:null,images:_.filter(b,function(a){return"image"===a.kind})});q.emitEvent("run",{morselId:d,result:c})}},function(a){q.emitEvent("runError",a.data)})},reset:function(){b.loadFiles(p)}};return d.eventEmission(q,"submitting evaluated evaluationError run runError ready".split(" "))}]);angular.module("viewer").factory("tidbits",[function(){return{isTidbitRelevant:function(a,d,b){return _.some(a.bin_code_groups,function(a){return(!b||a.bin_codes.length)&&_.every(a.bin_codes,function(a){return _.contains(d,a)})})},getTidbitViewerMode:function(a){return a?"tidbit-only":"quiz-only"}}}]);angular.module("viewer").constant("viewerPartialMap",{Video:{prefix:"video"},SketchVideo:{prefix:"video"},ProgrammingQuiz:{prefix:"programming_quiz",extension:!0},ImageFormQuiz:{prefix:"image_quiz"},Sketch:{prefix:"sketch"},EmbeddedFrame:{prefix:"iframe"},Reading:{prefix:"reading"}});angular.module("viewer").factory("viewerSettings",["mixin",function(a){var d={autoPlay:!0},b={set:function(a,e){if(d.hasOwnProperty(a)){var f=d[a];d[a]=e;b.emitEvent("change",{name:a,oldValue:f,newValue:e})}else console.error("can't set invalid setting: "+a)},get:function(a){if(d.hasOwnProperty(a))return d[a];console.error("Can't get invalid setting: "+a)}};return a.eventEmission(b,["change"])}]);angular.module("widgets").factory("github",["$q","libraryLoader","$rootScope","cookieJar",function(a,d,b,c){var e=d.loadLibraries(["base64"]),f={Accept:"application/vnd.github.raw","Content-Type":"application/json"},g={scopes:["repo"],note:"Udacity Issue Tracker",client_id:"bb427a8f7beb27b582e0",client_secret:"a014d61f827e1a761898d216ce44e23431237973"},h=null;(d=c.get("githubIssueTrackerToken"))&&(h=d);var i={setToken:function(a){null===a&&c.remove("githubIssueTrackerToken");h=a},hasToken:function(){return null!==
h},getAuth:function(d,g,j){var m=a.defer();e.then(function(){var a=angular.copy(f);a.Authorization="Basic "+Base64.encode(d+":"+g);j&&(a["X-GitHub-OTP"]=j);$.ajax("https://api.github.com/authorizations",{headers:a}).done(function(a){_.each(a,function(a){"bb427a8f7beb27b582e0"===a.app.client_id&&(i.setToken(a.token),c.set("githubIssueTrackerToken",a.token))});null!==h?m.resolve(a):i._postAuth(d,g,j).then(function(a){m.resolve(a)},function(a){m.reject(a)})}).fail(function(a){m.reject(a)}).always(function(){b.$apply()})});
return m.promise},_postAuth:function(c,d,h){var m=a.defer();e.then(function(){var a=angular.copy(f);a.Authorization="Basic "+Base64.encode(c+":"+d);h&&(a["X-GitHub-OTP"]=h);$.ajax("https://api.github.com/authorizations",{type:"POST",data:JSON.stringify(g),headers:a}).done(function(a){i.setToken(a.token);m.resolve(a)}).fail(function(a){m.reject(a)}).always(function(){b.$apply()})});return m.promise},getIssues:function(c,d){var e={};d&&(d.labels&&d.labels.join)&&(e.labels=d.labels.join(","));var g=
a.defer(),i=angular.copy(f);i.Authorization="token "+h;$.ajax("https://api.github.com/repos/udacity/"+c+"/issues",{headers:i,data:e,cache:!1}).done(function(a){g.resolve(a)}).fail(function(a){g.reject(a)}).always(function(){b.$apply()});return g.promise},postIssue:function(c,d){var e=a.defer(),g=angular.copy(f);g.Authorization="token "+h;$.ajax("https://api.github.com/repos/udacity/"+c+"/issues",{type:"POST",data:JSON.stringify(d),headers:g}).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}).always(function(){b.$apply()});
return e.promise},updateIssue:function(c,d){var e=a.defer(),g=angular.copy(f);g.Authorization="token "+h;$.ajax("https://api.github.com/repos/udacity/"+c+"/issues/"+d.number,{type:"POST",data:JSON.stringify(d),headers:g}).done(function(a){e.resolve(a)}).fail(function(a){e.reject(a)}).always(function(){b.$apply()});return e.promise},getAssigneeOptions:function(c){var d=a.defer(),e=[],g=function(a){var i=angular.copy(f);i.Authorization="token "+h;$.ajax("https://api.github.com/repos/udacity/"+c+"/assignees?page="+
a+"&per_page=100",{type:"GET",headers:i}).done(function(b){e=e.concat(b);100>b.length?d.resolve(e):g(a+1)}).fail(function(a){d.reject(a)}).always(function(){b.$apply()})};g(1);return d.promise}};return i}]);angular.module("widgets").directive("staffIssues",["cacheVersion","github","lesson","lessonContentContext","$timeout","$window",function(a,d,b,c,e,f){var g=RegExp("(#### Github Issue Tracker Data Blob - DO NOT TOUCH ####)([\\s\\S]*?)(#### End of Github Issue Tracker Data Blob ####)","g");return{restrict:"A",templateUrl:"/templates/angular/staff_tools/staff_issues.html?"+a,link:function(a){a.issuePriorityOptions={p1:"OMG",p2:"HIGH",p3:"LOW"};a.labels=null;a.courseKey=null;a.showAddIssue=!1;a.currentMorselTitle=
null;var i=function(){d.getAssigneeOptions("course-issues").then(function(b){a.assigneeOptions=_.pluck(b,"login");a.assigneeOptions.unshift("")})};i();var k=function(){a.newIssue={title:"",body:"",priority:"p3"}};k();b.addEventListener("morselChange",function(b){a.labels=_.without(_.map(c.getCurrent(),function(a){return a.tag+a.node_key}),void 0,null);a.courseLabel=a.labels[0];a.lessonLabel=a.labels[1];a.morselLabel=_.last(a.labels);a.githubURLbase="https://github.com/udacity/course-issues/issues?labels=";
a.githubURL=a.githubURLbase+a.labels.join("%2C");a.currentMorselTitle=b.title;a.hasToken()&&(a.currentIssues=null,a.refreshIssues())},{replayLast:!0,removeOnDestructionOf:a});var l=function(b){b.body=b.body.replace(g,"");b.priority="p3";for(var c=[],d=0;d<b.labels.length;d++){var e=b.labels[d].name;e in a.issuePriorityOptions&&(b.priority=e);c.push(e)}b.labels=c;b.assignee=b.assignee?b.assignee.login:"";return b};a.refreshIssues=function(){d.getIssues("course-issues",{labels:[_.last(a.labels)]}).then(function(b){a.currentIssues=
_.map(b,l);a.showAddIssue=0===a.currentIssues.length?!0:!1})};a.closeIssue=function(b){confirm("Are you sure you want to close this issue?")&&(b.state="closed",a.postIssue(b))};a.addNewIssue=function(){var b={posted_from:{url:f.location.href,markdown:"["+a.currentMorselTitle+"]("+f.location.href+")"}},c=angular.copy(a.labels);c.push(a.newIssue.priority);a.newIssue.body+="\n#### Github Issue Tracker Data Blob - DO NOT TOUCH ####\n"+JSON.stringify(b,null,"\t")+"\n#### End of Github Issue Tracker Data Blob ####";
a.newIssue.labels=c;a.postIssue(a.newIssue)};a.postIssue=function(b){for(var c=0;c<b.labels.length;c++)b.labels[c]in a.issuePriorityOptions&&(b.labels[c]=b.priority);b.number?(console.log("updating issue"),console.log(b),b=angular.copy(b),b.body+="\n#### Github Issue Tracker Data Blob - DO NOT TOUCH ####\n"+JSON.stringify({posted_from:{url:f.location.href,markdown:"["+a.currentMorselTitle+"]("+f.location.href+")"}},null,"\t")+"\n#### End of Github Issue Tracker Data Blob ####",d.updateIssue("course-issues",
b).then(function(){})):(console.log("creating issue"),console.log(b),d.postIssue("course-issues",b).then(function(b){b.body=b.body.replace(g,"");a.currentIssues.push(l(b));k();a.showAddIssue=!1}))};a.hasToken=function(){return d.hasToken()};a.getToken=function(){d.getAuth(a.name,a.pass,a.oneTimePassword).then(function(){a.name="";a.pass="";a.oneTimePassword="";i();a.refreshIssues()},function(){$("#staff-issues-container > span").addClass("animate-shake");e(function(){$("#staff-issues-container > span").removeClass("animate-shake")},
1E3,!1)})};a.endSession=function(){d.setToken(null);a.newIssueTitle=null;a.newIssueBody=null;a.currentIssues=null}}}}]);angular.module("widgets").directive("codeEditor",["libraryLoader","codeEditorHelper","$timeout",function(a,d,b){return{restrict:"A",require:"ngModel",link:function(c,e,f,g){var h=null,i=_.throttle(function(){b(function(){c.$apply()},0,!1)},100);c.getLanguageForFileName=d.getLanguageForFileName;a.loadLibraries(["codemirror"]).then(function(){var a=window.CodeMirror;h=a(e.get(0),{mode:d.getCodeMirrorSpecifierForLanguage(f.language),theme:f.theme||"default",autofocus:f.autofocus||!1,lineNumbers:!0,matchBrackets:!0,
indentUnit:4,extraKeys:{Tab:"indentMore"}});h.on("change",function(){var a=h.getValue();a!==g.$viewValue&&(a?g.$setViewValue(a):g.$setViewValue(null),i())});c.$watch(f.language,function(a){a&&h.setOption("mode",d.getCodeMirrorSpecifierForLanguage(a))});g.$render=function(){g.$viewValue?h.setValue(g.$viewValue):null===g.$viewValue&&h.setValue("")};g.$render()})}}}]);angular.module("widgets").factory("codeEditorHelper",["libraryLoader",function(a){var d={},b=[["py","python",{name:"python",version:2,singleLineStringErrors:!1}],["c","c","text/x-csrc"],["cu","cuda","text/x-cudasrc"],["cpp","c++","text/x-c++src"],["css","css","text/css"],["e","specman","text/x-specmansrc"],["glsl","glsl","text/x-glsl"],["html","html",{name:"xml",htmlMode:!0}],["java","java","text/x-java"],["js","javascript","text/javascript"],["json","javascript","text/javascript"],["m","octave",
"text/x-ocl"],["ocl","ocl","text/x-ocl"],["r","r","text/x-rsrc"],["xml","xml",{name:"xml",htmlMode:!1}]],c=_.object(_.map(b,function(a){return[a[0],a[1]]})),e=_.object(_.map(b,function(a){return[a[1],a[2]]})),f=_.object(_.map(b,function(a){return[a[0],a[2]]}));d.getCodeMirrorSpecifierForLanguage=function(a){return e[a]};d.getCodeMirrorSpecifierForFileName=function(a){if(a)return a=_.last(a.split(".")),f[a]};d.getLanguageForFileName=function(a){if(a)return a=_.last(a.split(".")),c[a]};var g=function(a){for(var b=
{},a=a.split(" "),c=0;c<a.length;++c)b[a[c]]=!0;return b},h=function(a,b){return b.startOfLine?(a.skipToEnd(),"meta"):!1};a.loadLibraries(["codemirror"]).then(function(){CodeMirror.defineMIME("text/x-cudasrc",{name:"clike",keywords:g("auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile inline wchar_t"),builtin:g("__global__ __constant__ __shared__ threadIdx blockIdx gridDim blockDim __device__ __host__ __syncthreads"),
blockKeywords:g("do else for if struct switch while"),atoms:g("true false null"),hooks:{"#":h}});CodeMirror.defineMIME("text/x-specmansrc",{name:"clike",keywords:g("all also as_a assert assume an and attribute bit bits bool break byte case check change compute computed cover continue cross cycle default define delay detach do down each edges else emit empty event exec expect export extend fail fall file first for force from gen global if ifdef ifndef in index int inline is instance item keep keeping key like line list machine matching me nand new nor not now of on only or out pass prev print range ranges release repeat return reverse rise routine select soft start state step string struct sync sys that then time to transition true try type undefined uint unit until using var when while with")})});
return d}]);angular.module("widgets").directive("courseCardFetcher",["cacheVersion",function(a){return{restrict:"A",scope:{cardCourses:"=",lengthOfRow:"=?",showPartners:"=?",maxImageSize:"=?",cardsPerRowOnMobile:"=?"},templateUrl:"/templates/course_card.html?"+a,controller:"courseCardFetcherHelper",link:function(a){a.setUpCards(a.cardCourses,a.lengthOfRow,a.showPartners,a.imageSize,a.cardsPerRowOnMobile)}}}]);angular.module("widgets").controller("courseCardFetcherHelper",["$scope","nodes","affiliates",function(a,d,b){a.partners={};var c=function(){a.finished=!0};a._calculateColumnWidth=function(a){if(!a||6<a)a=6;return Math.floor(12/a)};a._generateRows=function(b,c){var d=0;a.rows=[];var h=[];b.length<=c?a.rows=[b]:(_.each(b,function(b){d<c?(d+=1,h.push(b)):(d=1,a.rows.push(h),h=[b])}),a.rows.push(h));return a.rows};a._fetchAffiliate=function(c,d){a.partners[d]=a.partners[d]||[];_.each(c,function(c){b.get(c.key,
{projection:"image"}).then(function(b){b&&b._image_url&&a.partners[d].push({imageUrl:b._image_url,name:b.name})})})};a.fetchCards=function(b,c){return d.batchGet(b).then(function(d){return _.without(_.map(b,function(b){var e=!1,k=d[b];if(d[b]){var l=null,j=k.catalog_entry;j&&j._image&&(l=j._image.serving_url);c&&(k.affiliate_program_refs&&0<k.affiliate_program_refs.length)&&"udacity"!==k.affiliate_program_refs[0].key&&(e=!0,a._fetchAffiliate(k.affiliate_program_refs,b));return{key:b,_slug:k._slug,
servingUrl:l,title:k.title,isNanodegree:"Degree"===k._semantic_type,showPartner:e&&c}}return null}),null)})};a._setLengthOfRow=function(a,b){return!b||6<b?6>=a?a:0===a%6?6:0===a%5?5:0===a%4?4:0===a%3?3:6:b};a.setUpCards=function(b,d,g,h,i){b?(a.lengthOfRow=a._setLengthOfRow(b.length,d),a.columnWidthClass="col-xs-"+a._calculateColumnWidth(a.lengthOfRow),a.cardImageSize=[1200/a.lengthOfRow,0],angular.isArray(h)&&2===h.length?a.cardImageSize=h:angular.isNumber(h)&&(a.cardImageSize=[h,0]),i?1===i?a.columnWidthClass=
"col-xs-12 col-sm-"+a._calculateColumnWidth(a.lengthOfRow):(a.cardsPerRowOnMobile=2,a.columnWidthClass="col-xs-6 col-sm-"+a._calculateColumnWidth(a.lengthOfRow)):a.columnWidthClass="col-xs-"+a._calculateColumnWidth(a.lengthOfRow),a.fetchCards(b,g).then(function(b){return a._generateRows(b,a.lengthOfRow)})["finally"](c)):(a.rows=null,a.columnWidthClass="",c())};a.finished=!1}]);angular.module("widgets").controller("courseFeatures",["$scope","modal",function(a,d){a.chooseFeature=function(b){a.chosenFeature=b};a.launchModal=function(b,c){a.projectTitle=c;a.chooseFeature(b);d.activate("features")}}]);angular.module("widgets").directive("developmentEnvironment",["$log","$routeParams","$window","cacheVersion","currentUser","developmentEnvironments",function(a,d,b,c,e,f){return{templateUrl:"/templates/widgets/development_environment_for_account.html?"+c,scope:{accountKey:"@"},link:function(c){c.developmentEnvironment=null;c.responseMessage=null;c.currentUserKey=e.get("key");c.showCreateButton=!1;var d=function(a){a=new Blob([a],{type:"text/plain"});return(b.URL||b.webkitURL).createObjectURL(a)};
c.deleteDevelopmentEnvironment=function(){c.showWaitingImage=!0;f.deleteDevelopmentEnvironment(c.accountKey).then(function(){c.developmentEnvironment=null;c.responseMessage="Delete successful";c.showWaitingImage=!1;c.showCreateButton=!0},function(){c.responseMessage="Delete failed. Please try again later";c.showWaitingImage=!1})};f.getDevelopmentEnvironment(c.accountKey).then(function(a){c.developmentEnvironment=a;c.developmentEnvironment.url=d(a._private_key)},function(){c.showCreateButton=!0});
c.createDevelopmentEnvironment=function(){c.showWaitingImage=!0;f.createDevelopmentEnvironment(c.accountKey).then(function(a){c.developmentEnvironment=a;c.developmentEnvironment.url=d(a._private_key);c.showCreateButton=!1;c.showWaitingImage=!1;c.responseMessage=null},function(b){a.error(b);c.responseMessage="Could not create the development environment. Please try again later.";c.showWaitingImage=!1})}}}}]);angular.module("widgets").factory("guidedTour",["$q",function(a){var d=null,b=null,c=null;return{start:function(e){c&&c.reject();d=e;b=0;c=a.defer();return c.promise},goToExhibit:function(a){a=_.indexOf(d,_.findWhere(d,{id:a}));-1!==a&&(b=a)},next:function(){b<d.length-1?b+=1:(d=null,$().spotlight.clear(),c.resolve(),c=null)},previous:function(){0<b&&(b-=1)},getCurrentExhibitId:function(){return d&&d[b].id}}}]);angular.module("widgets").directive("guidedTourExhibit",["guidedTour",function(a){return{link:function(d,b,c){if(!c.guidedTourExhibit)throw Error("A guided tour placard must have a unique identifier!");b.addClass("guided-tour-exhibit-"+c.guidedTourExhibit);d.$watch(a.getCurrentExhibitId,function(a){a===c.guidedTourExhibit&&(b.spotlight({zIndex:1E4}),b.offset().top<$(window).scrollTop()?$("html, body").animate({scrollTop:b.offset().top-0.5*$(window).height()-0.5*b.outerHeight()},500):b.offset().top+
b.outerHeight()>$(window).scrollTop()+$(window).height()&&$("html, body").animate({scrollTop:b.offset().top+0.5*b.outerHeight()-0.5*$(window).height()},500))})}}}]);angular.module("widgets").directive("guidedTourPlacard",["guidedTour",function(a){return{template:'<div class="guided-tour-placard-container" data-ng-class="{\'guided-tour-placard-container-current\': show}"><div class="guided-tour-placard"></div></div>',scope:!0,transclude:!0,link:function(d,b,c,e,f){f(function(c,d){d.next=a.next;d.previous=a.previous;d.goToExhibit=a.goToExhibit;b.find(".guided-tour-placard").append(c)});b.css({"z-index":10001,position:"relative"});if(!c.guidedTourPlacard)throw Error("A guided tour placard must have a unique identifier!");
d.$watch(a.getCurrentExhibitId,function(a){if(a===c.guidedTourPlacard){var a=b.find(".guided-tour-placard-container"),e=$(".guided-tour-exhibit-"+c.guidedTourPlacard),f=a.outerWidth(),k=a.outerHeight(),l=e.offset().top,j=e.offset().left,m=e.outerWidth(),e=e.outerHeight(),p=$("html, body").outerWidth(),n=$("html, body").outerHeight(),f=_.min([{distanceToPageEdge:l,placardPosition:{exhibitSide:"top",top:e+25,left:0.5*m-0.5*f}},{distanceToPageEdge:p-(j+m),placardPosition:{exhibitSide:"right",top:0.5*
e-0.5*k,left:-1*(f+25)}},{distanceToPageEdge:n-(l+e),placardPosition:{exhibitSide:"bottom",top:-1*(k+25),left:0.5*m-0.5*f}},{distanceToPageEdge:j,placardPosition:{exhibitSide:"left",top:0.5*e-0.5*k,left:m+25}}],function(a){return a.distanceToPageEdge}).placardPosition;a.css({position:"absolute",top:f.top,left:f.left}).addClass("placard-arrow-"+f.exhibitSide);d.show=!0}else d.show=!1})}}}]);angular.module("widgets").directive("leftHandNav",["currentUser","siteExperience","fetchDiscourseLink","nodes",function(a,d,b,c){return{replace:!0,templateUrl:"left_hand_nav.html",scope:{location:"@",courseKey:"="},link:function(e){e.$watch("courseKey",function(a){a&&(angular.isString(a)&&"nd"===a.slice(a.length-2)?(e.showDiscussion=!0,e.semanticType="Course",h(a).then(function(a){e.forumUrl=a})):(f||(f=c.get(a)),f.then(function(b){e.semanticType=b._semantic_type||"unknown";"Degree"===e.semanticType?
(e.showDiscussion=!0,h(a).then(function(a){e.forumUrl=a})):"Course"===e.semanticType?(e.showDiscussion=!0,e.forumUrl="http://discussions.udacity.com/c/standalone-courses/"+(b.forum_slug||"")):e.forumUrl=""})))});var f=e.semanticType=null;e.uriEncode=function(a){return window.encodeURIComponent(a)};e.userIsLoggedIn=a.userIsLoggedIn();e.limitedAccess=d.limitedAccess;e.externalProgressSystem=d.externalProgressSystem;var g=null,h=function(a){g||(g=b(a));return g}}}}]);angular.module("widgets").directive("markdown",["$sce","markdownConverter",function(a,d){return{restrict:"A",scope:!0,template:'<div class="markdown-container" data-ng-bind-html="compiledOutput"></div>',link:function(b,c,e){b.$watch(e.markdown,function(c){b.compiledOutput=c?a.trustAsHtml(d.makeHtml(c)):!c&&e.placeholder?a.trustAsHtml('<span class="text-muted">'+e.placeholder+"</span>")||"":""})}}}]);angular.module("widgets").factory("markdownConverter",[function(){return new window.Markdown.getSanitizingConverter}]);angular.module("widgets").directive("mathquill",["libraryLoader","$timeout",function(a,d){return{restrict:"A",link:function(b,c,e){if(e.target)b.$watch(e.watch,function(b){b&&a.loadLibraries(["mathquill"]).then(function(){d(function(){c.find(e.target).mathquill()},0,!1)})});else throw Error("Must provide a target selector to render with mathquill");}}}]);angular.module("widgets").factory("modal",["$q",function(a){var d=null,b=null,c=null,e={isModalActive:function(a){return a===d},getActiveModalData:function(){return c},activate:function(f,g){d&&e.cancel();d=f;c=g;b=a.defer();return b.promise},isActive:function(){return!!d},confirm:function(a){var c=b;b=d=null;c.resolve(a)},cancel:function(a){var c=b;b=d=null;c.reject(a)}};return e}]);angular.module("widgets").directive("modalAntiScrollHelper",["modal",function(a){return{restrict:"A",link:function(d){d.isModalActive=a.isActive}}}]);angular.module("widgets").directive("modalDialog",["modal",function(a){return{restrict:"A",transclude:!0,scope:!0,template:'<div ng-show="isModalActive(name)" class="modal"><div class="modal-backdrop"></div><div class="modal-dialog" data-ng-class="additionalClasses"><span data-ng-if="!disableClose"><button type="button" aria-label="close" class="close hanging-close" data-ng-click="cornerClose({message:\'cornerClose\'})"></button></span><div class="modal-content col-xs-12"></div></div></div>',link:function(d,
b,c,e,f){f(function(c,d){d.getData=a.getActiveModalData;d.cancel=a.cancel;d.confirm=a.confirm;b.find(".modal-content").append(c)});var g=c.closeHandler?d.$eval(c.closeHandler):void 0;d.cornerClose=function(b){return g?g(b):a.cancel(b)};d.name=c.modalDialog;d.disableClose=void 0!==c.disableClose;d.additionalClasses=c.additionalClasses||"";d.isModalActive=function(b){return a.isModalActive(b)}}}}]);angular.module("widgets").directive("pageScroller",[function(){return{link:function(a,d,b){d.on("click",function(){$("html, body").animate({scrollTop:$(b.pageScroller).offset().top},1200)});d.css("cursor","pointer")}}}]);angular.module("widgets").directive("supplementalMaterialItem",["cacheVersion","modal","canManageSite",function(a,d,b){return{templateUrl:function(b,d){return(d.menuDisplay?"/templates/viewer/partials/supplemental_material_item_menu_display.html?":"/templates/viewer/partials/supplemental_material_item.html?")+a},scope:{material:"=supplementalMaterialItem",premiumAccess:"=premiumAccess",nameOverride:"=?"},controller:["$scope","$window",function(a,e){a.openDownloadUrlOrDisplayUpsellModal=function(){a.isAccessAllowed()||
b?e.open(a.material._uri):d.activate("supplementalMaterialsUpsell")};a.getBaseName=function(b){if(a.nameOverride)return a.nameOverride;if(!b||-1===b.indexOf("."))return b;b=b.split(".");b.pop();return b.join(".")};a.isAccessAllowed=function(){return a.material&&(!a.material.paid_class_only||a.premiumAccess)};a.isReady=function(){return a.material&&a.material._uri}}]}}]);angular.module("widgets").directive("supplementalMaterialsUpsellModal",["cacheVersion","products","$timeout","$window","$location","couponCode","coupons","$q",function(a,d,b,c,e,f,g,h){return{templateUrl:"/templates/widgets/supplemental_materials_upsell_modal.html?"+a,scope:{productId:"=",courseKey:"="},controller:["$scope",function(a){var k=a.$watch("productId",function(l){l&&(b(function(){d.get(l).then(function(b){var c=h.when({});f&&(c=g.computeDiscount(f,a.productId));c.then(function(c){a.productPrice=
c.result||b.amount;a.productId=l})})},5E3),a.getLearnMoreUrl=function(){return"/what-we-offer#!/?courseKey="+c.encodeURIComponent(a.courseKey)+"&start="+c.encodeURIComponent(e.absUrl())},k())})}]}}]);angular.module("widgets").controller("tracksLoader",["$scope","nodes","slugifyFilter",function(a,d,b){a.loadTracks=function(c){return d.batchGet(c).then(function(d){a.tracks=_.without(_.map(c,function(a){return!d||!d[a]?null:"Other"===d[a].title||"All"===d[a].title?null:{title:d[a].title,icon:d[a]._icon?d[a]._icon.serving_url:"http://placekitten.com/45/45",catalogLink:"/courses/"+b(d[a].title)}}),null);return a._generateRows(a.tracks)})};a._generateRows=function(b){var d=0;a.rows=[];var f=[];_.each(b,
function(b){3>d?(d+=1,b.position=d,f.push(b)):(d=1,a.rows.push(f),b.position=d,f=[b])});a.rows.push(f);return a.rows};a.fetchTracks=function(){return d.get("course_catalog").then(function(b){a._trackKeys=[];if(b&&b.steps_refs)return a._trackKeys=_.map(b.steps_refs,function(a){return a.key}),a.loadTracks(a._trackKeys)})};a.fetchTracks()}]);angular.module("widgets").directive("uploadInput",["fileQueue",function(a){return{replace:!0,scope:{uploadPath:"=",servingProperty:"=?",name:"=?",onSuccess:"=?",onError:"=?"},template:'<form><input type="file" name="file"><span data-ng-if="task"><button class="btn btn-mini btn-danger" data-ng-click="cancel()"><span class="glyphicon glyphicon-remove"></span></button><progress value="{{loaded}}" max="{{total}}"> Progressing</progress></span></form>',link:function(d,b){d.name||(d.name="Upload to "+d.uploadPath);
var c=function(){d.task=null;d.loaded=0;d.total=1;b.prepend('<input type="file" name="file">');b.find("input").bind("change",e)},e=function(e){d.task=a.fileUploadTask(d.uploadPath,e.target.files[0],d.name);d.task.notify(function(a){d.loaded=a.loaded;d.total=a.total});d.task.then(function(a){d.servingProperty=a.media;return a}).then(d.onSuccess||angular.noop,d.onError||angular.noop);d.task["finally"](c);b.find("input").remove();d.$apply()};d.cancel=function(){d.task&&d.task.cancel()};b.find("input").bind("change",
e);d.task=a.uploadQueue.getUniqueTask(d.uploadPath);d.task&&(d.task.notify(function(a){d.loaded=a.loaded;d.total=a.total}),b.find("input").remove(),d.task["finally"](c))}}}]);angular.module("widgets").directive("upsellBanner",["currentUser","cookieJar","nodeUtility","cacheVersion","$location","$window","safelyRedirect",function(a,d,b,c,e,f,g){return{restrict:"A",templateUrl:function(a,b){if("banner"!==b.bannerStyle){if("check"===b.bannerStyle)return"/templates/viewer/upsell_check.html?"+c;if("pad"===b.bannerStyle)return"/templates/viewer/upsell_pad.html?"+c}return"/templates/viewer/upsell_banner.html?"+c},link:function(c,i,k){c.$watch("course",function(g){if(g){var i=
_.find(a.get("_enrollments"),function(a){return a.node_key===g.key}),i=i&&b.isCurrentEnrolled(i,g),m;m="pad"===k.bannerStyle?d.exists("upsell-cancel-banner-progress"):d.exists("upsell-cancel-banner-viewer");c.showBanner=!m&&c.course.catalog_entry.paid_class&&c.course.catalog_entry.paid_class.open_for_enrollment&&!i;c.learnMore="/success#!/?courseKey="+f.encodeURIComponent(g.key)+"&start="+f.encodeURIComponent(e.absUrl())}else c.showBanner=!1});c.goToPurchase=function(a){f.location.href="/checkout#!/0?products="+
f.encodeURIComponent(_.first(a.catalog_entry.paid_class.class_product_refs).key)};c.cancelBanner=function(){d.set("upsell-cancel-banner-"+("pad"===k.bannerStyle?"progress":"viewer"),!0);c.showBanner=!1};c.goEnroll=function(){c.course&&g("/course/"+encodeURIComponent(c.course.key))}}}}]).directive("upsellHeader",["currentUser","cookieJar","nodeUtility","$location","cacheVersion","nodes","products","$window",function(a,d,b,c,e,f,g,h){return{restrict:"A",templateUrl:"/templates/upsell_header.html?"+
e,link:function(a){a.courseKey=c.search().courseKey;a.start=c.search().start;f.get(a.courseKey).then(function(b){b&&(b.catalog_entry&&b.catalog_entry.paid_class)&&g.get(_.first(b.catalog_entry.paid_class.class_product_refs).key).then(function(c){a.course=b;a.product=c})});a.goClass=function(){a.course&&(h.location.href=a.start)};a.goEnroll=function(){a._purchaseCourse()};a._purchaseCourse=function(){h.location.href="/checkout#!/0?products="+h.encodeURIComponent(a.product.key)}}}}]);angular.module("widgets").directive("videoPlayer",["youtubeVideoPlayer",function(a){return{restrict:"A",link:function(d,b,c){a.addEventListener("apiReady",function(){a.attach(b.get(0),c.videoId,{autoPlay:c.autoPlay||0,controls:c.controls})},{replayLast:!0,removeOnDestructionOf:d})}}}]);angular.module("widgets").run(function(){var a=document.createElement("script");a.src="//www.youtube.com/iframe_api";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(a,d)}).service("youtubeVideoPlayer",["mixin","currentUser","techDetect",function(a,d,b){var c={},e=null,f=(d=d.get("site_preferences"))?d.playback_rate:1,g=d?d.video_quality:"auto",h=d?d.use_html5_player:!0;"default"===g&&(g="auto");"Explorer"===b.browserStats().browser&&(h=!1);var i={small:0,medium:1,large:2,
hd720:3,hd1080:4,highres:5};window.onYouTubeIframeAPIReady=function(){c.attach=function(a,b,d){if(!_.isElement(a))throw"Must attach youtube player to a DOM element!";e&&(e=null);b={height:"523",width:"930",videoId:b,playerVars:{autoplay:d.autoPlay||0,color:"red",controls:angular.isDefined(d.controls)?d.controls:1,rel:0,showinfo:0,fs:1,theme:"light",wmode:"opaque"},events:{onReady:function(){c.emitEvent("ready");c.setPlaybackRate(f);c.setPlaybackQuality(g)},onPlaybackRateChange:function(a){f=a.data;
c.emitEvent("playbackRateChange",a.data)},onPlaybackQualityChange:function(a){var b=e.getAvailableQualityLevels();i[a.data]>i[g]?g=a.data:i[a.data]<i[b[0]]&&(g=a.data);c.emitEvent("playbackQualityChange",a.data)},onStateChange:function(a){a.data===YT.PlayerState.ENDED?c.emitEvent("videoEnd"):a.data===YT.PlayerState.PAUSED?c.emitEvent("videoPause",Math.floor(e.getCurrentTime())):a.data===YT.PlayerState.PLAYING&&c.emitEvent("videoPlay",Math.floor(e.getCurrentTime()))}}};h&&(b.playerVars.html5=1);if(-1!==
window.location.href.indexOf("c-ud304")||-1!==window.location.href.indexOf("c-ud436"))b.playerVars.iv_load_policy=3;e=new YT.Player(a,b)};c.emitEvent("apiReady")};c.getAvailablePlaybackRates=function(){return e.getAvailablePlaybackRates()};c.getCurrentPlaybackRate=function(){return e&&e.getPlaybackRate?e.getPlaybackRate():f};c.setPlaybackRate=function(a){f=a;window.setTimeout(function(){e.setPlaybackRate(a)},500)};c.setPlaybackQuality=function(a){f=a;e.setPlaybackQuality(a)};c.playVideo=function(){e&&
e.playVideo?e.playVideo():console.error("The video player isn't ready or there is no video player on this page!")};c.pauseVideo=function(){if(e&&e.pauseVideo&&e.getCurrentTime){try{e.pauseVideo()}catch(a){console.error("YouTube threw an error while trying to call its own pause function!",a)}c.emitEvent("videoPause",Math.floor(e.getCurrentTime()))}};c.stopVideo=function(){e.stopVideo()};c.destroyVideo=function(){e.stopVideo();e.destroy()};c.loadVideo=function(a,b,d){e.loadVideoById?(e.loadVideoById(a,
b||0,d||g),c.setPlaybackRate(f),c.setPlaybackQuality(g)):c.addEventListener("ready",function(){e.loadVideoById(a,b||0,d||g)},{removeAfterFired:!0})};c.getCurrentTime=function(){return e&&e.getCurrentTime?Math.floor(e.getCurrentTime()):null};return a.eventEmission(c,"apiReady ready videoEnd videoPlay videoPause playbackRateChange playbackQualityChange".split(" "))}]);
